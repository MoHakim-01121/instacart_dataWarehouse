warning: dbt1005: Unused keys in profiles.yml target 'dev': 'pass'
warning: (will error post beta) dbt1060: Ignored unexpected key `"materialized"`. YAML path: `instacart_dbt.marts.dim.materialized`.
  --> dbt_project.yml:23:23
warning: (will error post beta) dbt1060: Ignored unexpected key `"materialized"`. YAML path: `instacart_dbt.marts.fact.materialized`.
  --> dbt_project.yml:25:23
warning: (will error post beta) dbt1060: Ignored unexpected key `"materialized"`. YAML path: `instacart_dbt.staging.materialized`.
  --> dbt_project.yml:20:21
warning: dbt1050: No metadata adapter found for adapter type postgres
error: dbt1053: Node 'source.instacart_dbt.instacart.aisles' not available; build it first (cache at: db/schemas/instacart_db/public/aisles)
error: dbt1053: Node 'source.instacart_dbt.instacart.order_products' not available; build it first (cache at: db/schemas/instacart_db/public/order_products)
error: dbt1053: Node 'source.instacart_dbt.instacart.orders' not available; build it first (cache at: db/schemas/instacart_db/public/orders)
error: dbt1053: Node 'source.instacart_dbt.instacart.products' not available; build it first (cache at: db/schemas/instacart_db/public/products)
warning: dbt1000: Warnings marked (will error post beta) will turn into errors before leaving beta. Please fix them.
suggestion: Try the autofix script: https://github.com/dbt-labs/dbt-autofix
  Finished 'show' target 'dev' with 4 errors and 5 warnings in 11s 363ms 102us 800ns
[0m17:00:50.440229 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:00:50.672925 | 129accce-8876-4036-812a-01abce98e538 ==============================
[0m17:00:50.672925 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:00:50.674953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --select aisles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:00:51.749230 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:00:52.278899 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:00:52.757288 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:00:56.906329 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_aisles' in the 'models' section of file 'models\staging\schema.yml'
[0m17:00:56.909992 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_departments' in the 'models' section of file 'models\staging\schema.yml'
[0m17:00:56.913749 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_products' in the 'models' section of file 'models\staging\schema.yml'
[0m17:00:56.919860 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_orders' in the 'models' section of file 'models\staging\schema.yml'
[0m17:00:56.935408 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_order_products' in the 'models' section of file 'models\staging\schema.yml'
[0m17:00:57.172522 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instacart_dbt.dim_aisle' (models\marts\dim\dim_aisle.sql) depends on a node named 'stg_aisles' which was not found
[0m17:00:57.174183 [debug] [MainThread]: Command `dbt build` failed at 17:00:57.174029 after 6.84 seconds
[0m17:00:57.174615 [debug] [MainThread]: Flushing usage events
[0m17:02:10.576440 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:02:10.660120 | 1dc17d60-f18c-47d2-a275-29021f4e0399 ==============================
[0m17:02:10.660120 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:02:10.661169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select aisles', 'send_anonymous_usage_stats': 'True'}
[0m17:02:11.047515 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:02:11.289209 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:02:11.491352 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:02:13.376623 [warn ] [MainThread]: [[33mWARNING[0m]: 'aisles' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `aisles` specification
under the seeds key instead.
[0m17:02:13.378786 [warn ] [MainThread]: [[33mWARNING[0m]: 'departments' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `departments`
specification under the seeds key instead.
[0m17:02:13.381073 [warn ] [MainThread]: [[33mWARNING[0m]: 'products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `products` specification
under the seeds key instead.
[0m17:02:13.394417 [warn ] [MainThread]: [[33mWARNING[0m]: 'orders' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `orders` specification
under the seeds key instead.
[0m17:02:13.399445 [warn ] [MainThread]: [[33mWARNING[0m]: 'order_products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `order_products`
specification under the seeds key instead.
[0m17:02:13.630479 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instacart_dbt.dim_aisle' (models\marts\dim\dim_aisle.sql) depends on a node named 'stg_aisles' which was not found
[0m17:02:13.631752 [debug] [MainThread]: Command `dbt build` failed at 17:02:13.631586 after 3.12 seconds
[0m17:02:13.632129 [debug] [MainThread]: Flushing usage events
[0m17:09:08.345135 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:09:08.437616 | 206e158a-0089-40aa-8f2a-e43f43699b18 ==============================
[0m17:09:08.437616 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:09:08.439124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --select aisles', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:08.814485 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:09:09.035557 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:09:09.246852 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:09:11.455829 [warn ] [MainThread]: [[33mWARNING[0m]: 'aisles' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `aisles` specification
under the seeds key instead.
[0m17:09:11.458550 [warn ] [MainThread]: [[33mWARNING[0m]: 'departments' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `departments`
specification under the seeds key instead.
[0m17:09:11.460661 [warn ] [MainThread]: [[33mWARNING[0m]: 'products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `products` specification
under the seeds key instead.
[0m17:09:11.462539 [warn ] [MainThread]: [[33mWARNING[0m]: 'orders' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `orders` specification
under the seeds key instead.
[0m17:09:11.465199 [warn ] [MainThread]: [[33mWARNING[0m]: 'order_products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `order_products`
specification under the seeds key instead.
[0m17:09:11.781309 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instacart_dbt.dim_aisle' (models\marts\dim\dim_aisle.sql) depends on a node named 'stg_aisles' which was not found
[0m17:09:11.782648 [debug] [MainThread]: Command `dbt build` failed at 17:09:11.782473 after 3.51 seconds
[0m17:09:11.783055 [debug] [MainThread]: Flushing usage events
[0m17:09:42.746393 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:09:42.818826 | 429f54e8-fb1e-422e-a395-05281484bab7 ==============================
[0m17:09:42.818826 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:09:42.820095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select aisles', 'send_anonymous_usage_stats': 'True'}
[0m17:09:43.207919 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:09:43.439413 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:09:43.631825 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:09:46.077018 [warn ] [MainThread]: [[33mWARNING[0m]: 'aisles' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `aisles` specification
under the seeds key instead.
[0m17:09:46.079707 [warn ] [MainThread]: [[33mWARNING[0m]: 'departments' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `departments`
specification under the seeds key instead.
[0m17:09:46.082703 [warn ] [MainThread]: [[33mWARNING[0m]: 'products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `products` specification
under the seeds key instead.
[0m17:09:46.087504 [warn ] [MainThread]: [[33mWARNING[0m]: 'orders' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `orders` specification
under the seeds key instead.
[0m17:09:46.097079 [warn ] [MainThread]: [[33mWARNING[0m]: 'order_products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `order_products`
specification under the seeds key instead.
[0m17:09:46.356271 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instacart_dbt.dim_aisle' (models\marts\dim\dim_aisle.sql) depends on a node named 'stg_aisles' which was not found
[0m17:09:46.357558 [debug] [MainThread]: Command `dbt build` failed at 17:09:46.357359 after 3.68 seconds
[0m17:09:46.357977 [debug] [MainThread]: Flushing usage events
[0m17:17:16.090035 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:17:16.280582 | 271f1806-de1c-4846-a054-25bbf8e081fc ==============================
[0m17:17:16.280582 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:17:16.281651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select aisles', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:17:16.887146 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:17:17.245571 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:17:17.464050 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:17:19.404772 [warn ] [MainThread]: [[33mWARNING[0m]: 'aisles' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `aisles` specification
under the seeds key instead.
[0m17:17:19.407004 [warn ] [MainThread]: [[33mWARNING[0m]: 'departments' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `departments`
specification under the seeds key instead.
[0m17:17:19.408991 [warn ] [MainThread]: [[33mWARNING[0m]: 'products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `products` specification
under the seeds key instead.
[0m17:17:19.410780 [warn ] [MainThread]: [[33mWARNING[0m]: 'orders' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `orders` specification
under the seeds key instead.
[0m17:17:19.412803 [warn ] [MainThread]: [[33mWARNING[0m]: 'order_products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `order_products`
specification under the seeds key instead.
[0m17:17:19.511630 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instacart_dbt.aisles' (models\staging\aisles.sql) depends on a source named 'instacart.aisles' which was not found
[0m17:17:19.512934 [debug] [MainThread]: Command `dbt build` failed at 17:17:19.512770 after 3.50 seconds
[0m17:17:19.513419 [debug] [MainThread]: Flushing usage events
[0m17:24:01.898620 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:24:02.022736 | de89fd33-cd87-4257-973d-e4743fc9ba3e ==============================
[0m17:24:02.022736 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:24:02.023749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select aisles', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:02.439037 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:24:02.676072 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:24:02.901082 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:24:04.776085 [warn ] [MainThread]: [[33mWARNING[0m]: 'aisles' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `aisles` specification
under the seeds key instead.
[0m17:24:04.778835 [warn ] [MainThread]: [[33mWARNING[0m]: 'departments' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `departments`
specification under the seeds key instead.
[0m17:24:04.781624 [warn ] [MainThread]: [[33mWARNING[0m]: 'products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `products` specification
under the seeds key instead.
[0m17:24:04.785177 [warn ] [MainThread]: [[33mWARNING[0m]: 'orders' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `orders` specification
under the seeds key instead.
[0m17:24:04.787750 [warn ] [MainThread]: [[33mWARNING[0m]: 'order_products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `order_products`
specification under the seeds key instead.
[0m17:24:04.908052 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instacart_dbt.aisles' (models\staging\aisles.sql) depends on a source named 'instacart.aisles' which was not found
[0m17:24:04.909401 [debug] [MainThread]: Command `dbt build` failed at 17:24:04.909224 after 3.09 seconds
[0m17:24:04.909827 [debug] [MainThread]: Flushing usage events
[0m17:26:59.130565 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:26:59.251413 | 7a24959b-ec44-4802-b140-2ff1a4c0b3ae ==============================
[0m17:26:59.251413 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:26:59.252389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:26:59.792146 [debug] [MainThread]: Command `dbt clean` succeeded at 17:26:59.791993 after 0.73 seconds
[0m17:26:59.792559 [debug] [MainThread]: Flushing usage events
[0m17:27:10.300920 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:27:10.370929 | c55b6994-d90e-4ad8-8b11-157325b5d156 ==============================
[0m17:27:10.370929 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:27:10.371967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select aisles', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:27:10.734793 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:27:10.927356 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m17:27:10.928595 [debug] [MainThread]: Command `dbt build` failed at 17:27:10.928436 after 0.70 seconds
[0m17:27:10.928985 [debug] [MainThread]: Flushing usage events
[0m17:28:10.376203 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:28:10.470000 | 94ea0bc5-1093-4c2d-a0bc-92f87367e928 ==============================
[0m17:28:10.470000 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:28:10.470991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:28:10.745898 [debug] [MainThread]: Set downloads directory='C:\Users\ACER\AppData\Local\Temp\dbt-downloads-4ice0pwv'
[0m17:28:10.746574 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:28:11.511568 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:28:11.513566 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:28:12.059762 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:28:12.065745 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:28:12.738715 [info ] [MainThread]: Installed from version 1.1.1
[0m17:28:12.739684 [info ] [MainThread]: Updated version available: 1.3.0
[0m17:28:12.740366 [info ] [MainThread]: 
[0m17:28:12.741276 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:28:12.743585 [debug] [MainThread]: Command `dbt deps` succeeded at 17:28:12.743326 after 2.44 seconds
[0m17:28:12.744229 [debug] [MainThread]: Flushing usage events
[0m17:28:23.026225 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:28:23.102400 | 427df2f2-7791-4632-bc48-0f67e0c1eba1 ==============================
[0m17:28:23.102400 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:28:23.103422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select aisles', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:28:23.527740 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:28:23.764362 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:28:23.766031 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:28:26.095650 [warn ] [MainThread]: [[33mWARNING[0m]: 'aisles' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `aisles` specification
under the seeds key instead.
[0m17:28:26.097528 [warn ] [MainThread]: [[33mWARNING[0m]: 'departments' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `departments`
specification under the seeds key instead.
[0m17:28:26.099574 [warn ] [MainThread]: [[33mWARNING[0m]: 'products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `products` specification
under the seeds key instead.
[0m17:28:26.102597 [warn ] [MainThread]: [[33mWARNING[0m]: 'orders' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `orders` specification
under the seeds key instead.
[0m17:28:26.105567 [warn ] [MainThread]: [[33mWARNING[0m]: 'order_products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `order_products`
specification under the seeds key instead.
[0m17:28:26.372937 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instacart_dbt.dim_aisle' (models\marts\dim\dim_aisle.sql) depends on a node named 'stg_aisles' which was not found
[0m17:28:26.374519 [debug] [MainThread]: Command `dbt build` failed at 17:28:26.374333 after 3.42 seconds
[0m17:28:26.374952 [debug] [MainThread]: Flushing usage events
[0m17:34:15.421548 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:34:15.499680 | 39031d14-fac6-4adc-a6ea-70c2ecf0e9ec ==============================
[0m17:34:15.499680 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:34:15.500634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select aisles', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:15.855742 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:34:16.054000 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:34:16.056069 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:34:17.819125 [warn ] [MainThread]: [[33mWARNING[0m]: 'aisles' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `aisles` specification
under the seeds key instead.
[0m17:34:17.820899 [warn ] [MainThread]: [[33mWARNING[0m]: 'departments' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `departments`
specification under the seeds key instead.
[0m17:34:17.822588 [warn ] [MainThread]: [[33mWARNING[0m]: 'products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `products` specification
under the seeds key instead.
[0m17:34:17.824328 [warn ] [MainThread]: [[33mWARNING[0m]: 'orders' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `orders` specification
under the seeds key instead.
[0m17:34:17.826314 [warn ] [MainThread]: [[33mWARNING[0m]: 'order_products' is a seed node, but it is specified in the models section of
models\staging\schema.yml. To fix this error, place the `order_products`
specification under the seeds key instead.
[0m17:34:17.905188 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instacart_dbt.stg_aisles' (models\staging\stg_aisles.sql) depends on a source named 'instacart.aisles' which was not found
[0m17:34:17.906487 [debug] [MainThread]: Command `dbt build` failed at 17:34:17.906334 after 2.55 seconds
[0m17:34:17.907023 [debug] [MainThread]: Flushing usage events
[0m17:40:11.533337 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:40:11.679331 | 6529e8a1-8551-4fea-896b-5935ce4ae483 ==============================
[0m17:40:11.679331 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:40:11.680417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select aisles', 'send_anonymous_usage_stats': 'True'}
[0m17:40:12.165302 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:40:12.445933 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:40:12.447922 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:40:15.336374 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m17:40:15.342229 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m17:40:15.412725 [info ] [MainThread]: Found 12 models, 5 seeds, 70 data tests, 5 sources, 547 macros
[0m17:40:15.418031 [info ] [MainThread]: 
[0m17:40:15.419063 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:40:15.419934 [info ] [MainThread]: 
[0m17:40:15.420939 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:40:15.422264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m17:40:15.762809 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m17:40:15.763335 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m17:40:15.763709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:15.972144 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.208 seconds
[0m17:40:15.974775 [debug] [ThreadPool]: On list_instacart_db: Close
[0m17:40:16.000504 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m17:40:16.010502 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m17:40:16.011209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m17:40:16.011661 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m17:40:16.016280 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m17:40:16.016836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:16.017269 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m17:40:16.018131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:16.088853 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m17:40:16.089593 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m17:40:16.090226 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:40:16.095939 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m17:40:16.096721 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m17:40:16.097283 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:40:16.104028 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m17:40:16.105459 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m17:40:16.105868 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.015 seconds
[0m17:40:16.107352 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m17:40:16.107711 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m17:40:16.108033 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m17:40:16.119954 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:16.120497 [debug] [MainThread]: On master: BEGIN
[0m17:40:16.120854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:16.174207 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m17:40:16.174917 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:16.175562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:40:16.189267 [debug] [MainThread]: SQL status: SELECT 5 in 0.013 seconds
[0m17:40:16.192393 [debug] [MainThread]: On master: ROLLBACK
[0m17:40:16.193120 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:16.193721 [debug] [MainThread]: On master: BEGIN
[0m17:40:16.194528 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:40:16.195108 [debug] [MainThread]: On master: COMMIT
[0m17:40:16.195687 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:16.196131 [debug] [MainThread]: On master: COMMIT
[0m17:40:16.196642 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:40:16.197017 [debug] [MainThread]: On master: Close
[0m17:40:16.204045 [debug] [Thread-1 (]: Began running node seed.instacart_dbt.aisles
[0m17:40:16.204761 [info ] [Thread-1 (]: 1 of 1 START seed file public.aisles ........................................... [RUN]
[0m17:40:16.205811 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.instacart_dbt.aisles'
[0m17:40:16.206507 [debug] [Thread-1 (]: Began compiling node seed.instacart_dbt.aisles
[0m17:40:16.206949 [debug] [Thread-1 (]: Began executing node seed.instacart_dbt.aisles
[0m17:40:16.252938 [debug] [Thread-1 (]: Using postgres connection "seed.instacart_dbt.aisles"
[0m17:40:16.253488 [debug] [Thread-1 (]: On seed.instacart_dbt.aisles: BEGIN
[0m17:40:16.253886 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:16.311683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m17:40:16.313227 [debug] [Thread-1 (]: Using postgres connection "seed.instacart_dbt.aisles"
[0m17:40:16.314389 [debug] [Thread-1 (]: On seed.instacart_dbt.aisles: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "seed.instacart_dbt.aisles"} */
truncate table "instacart_db"."public"."aisles"
[0m17:40:16.323086 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m17:40:16.397445 [debug] [Thread-1 (]: Using postgres connection "seed.instacart_dbt.aisles"
[0m17:40:16.398035 [debug] [Thread-1 (]: On seed.instacart_dbt.aisles: 
          insert into "instacart_db"."public"."aisles" ("aisle_id", "aisle") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(...
[0m17:40:16.402594 [debug] [Thread-1 (]: SQL status: INSERT 0 134 in 0.004 seconds
[0m17:40:16.409316 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.instacart_dbt.aisles"
[0m17:40:16.429235 [debug] [Thread-1 (]: On seed.instacart_dbt.aisles: COMMIT
[0m17:40:16.429816 [debug] [Thread-1 (]: Using postgres connection "seed.instacart_dbt.aisles"
[0m17:40:16.430268 [debug] [Thread-1 (]: On seed.instacart_dbt.aisles: COMMIT
[0m17:40:16.434004 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:40:16.436811 [debug] [Thread-1 (]: On seed.instacart_dbt.aisles: Close
[0m17:40:16.440684 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.aisles ....................................... [[32mINSERT 134[0m in 0.23s]
[0m17:40:16.442280 [debug] [Thread-1 (]: Finished running node seed.instacart_dbt.aisles
[0m17:40:16.444131 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:16.444620 [debug] [MainThread]: On master: BEGIN
[0m17:40:16.444983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:16.524221 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m17:40:16.524969 [debug] [MainThread]: On master: COMMIT
[0m17:40:16.525577 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:16.526072 [debug] [MainThread]: On master: COMMIT
[0m17:40:16.526840 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:40:16.527535 [debug] [MainThread]: On master: Close
[0m17:40:16.528394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:16.528928 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m17:40:16.529388 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m17:40:16.529873 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m17:40:16.530395 [debug] [MainThread]: Connection 'seed.instacart_dbt.aisles' was properly closed.
[0m17:40:16.530974 [info ] [MainThread]: 
[0m17:40:16.533546 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m17:40:16.539015 [debug] [MainThread]: Command end result
[0m17:40:16.647859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m17:40:16.654144 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m17:40:16.665886 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m17:40:16.666582 [info ] [MainThread]: 
[0m17:40:16.667828 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:16.668845 [info ] [MainThread]: 
[0m17:40:16.669687 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:40:16.671295 [debug] [MainThread]: Command `dbt build` succeeded at 17:40:16.671054 after 5.22 seconds
[0m17:40:16.671916 [debug] [MainThread]: Flushing usage events
[0m19:00:01.465000 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 19:00:01.674231 | 92b258af-c656-4950-86a0-8cfaaa53811d ==============================
[0m19:00:01.674231 [info ] [MainThread]: Running with dbt=1.10.3
[0m19:00:01.675526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select stg_orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:00:02.064760 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:00:02.274152 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m19:00:02.803445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:02.803891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:03.056427 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m19:00:03.060745 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m19:00:03.137302 [info ] [MainThread]: Found 12 models, 5 seeds, 70 data tests, 5 sources, 547 macros
[0m19:00:03.142403 [info ] [MainThread]: 
[0m19:00:03.143159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:03.144104 [info ] [MainThread]: 
[0m19:00:03.145173 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:03.148028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m19:00:03.537733 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m19:00:03.538392 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:03.538850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:03.622847 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.084 seconds
[0m19:00:03.624136 [debug] [ThreadPool]: On list_instacart_db: Close
[0m19:00:03.631833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m19:00:03.638944 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m19:00:03.639641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m19:00:03.640071 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m19:00:03.642296 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m19:00:03.642697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:03.643115 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m19:00:03.643758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:03.712078 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m19:00:03.712727 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m19:00:03.713273 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:00:03.713775 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m19:00:03.714198 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m19:00:03.714543 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:00:03.722921 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m19:00:03.724400 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m19:00:03.725118 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.011 seconds
[0m19:00:03.725535 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m19:00:03.726966 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m19:00:03.727799 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m19:00:03.737044 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:03.737489 [debug] [MainThread]: On master: BEGIN
[0m19:00:03.737820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:03.781982 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m19:00:03.782450 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:03.782847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:03.792815 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m19:00:03.795270 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:03.795798 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:03.796208 [debug] [MainThread]: On master: BEGIN
[0m19:00:03.796744 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:00:03.797064 [debug] [MainThread]: On master: COMMIT
[0m19:00:03.797370 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:03.797653 [debug] [MainThread]: On master: COMMIT
[0m19:00:03.798033 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:03.798330 [debug] [MainThread]: On master: Close
[0m19:00:03.803259 [debug] [Thread-1 (]: Began running node model.instacart_dbt.stg_orders
[0m19:00:03.804029 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m19:00:03.805244 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.stg_orders'
[0m19:00:03.805721 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.stg_orders
[0m19:00:03.813465 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.stg_orders"
[0m19:00:03.815295 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.stg_orders
[0m19:00:03.865606 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.stg_orders"
[0m19:00:03.867380 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:00:03.867954 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: BEGIN
[0m19:00:03.868341 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:03.914617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m19:00:03.915150 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:00:03.915544 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */

  create view "instacart_db"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql

-- Tujuan staging:
-- 1. Menyelaraskan penamaan kolom agar lebih readable
-- 2. Menjaga NULL pada kolom `days_since_prior_order`
-- 3. Konsistensi struktur dan tipe data untuk model downstream

with source as (

    select *
    from "instacart_db"."public"."orders"

),

renamed as (

    select
        order_id,
        user_id,
        order_number,
        order_day_of_week as order_day,       -- Sudah sesuai, tidak perlu rename
        order_hour_of_day as order_hour,    -- Rename untuk konsistensi
        days_since_prior_order
    from source

)

select * from renamed
  );
[0m19:00:03.931293 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m19:00:03.938486 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:00:03.939113 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
alter table "instacart_db"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m19:00:03.940569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:03.943265 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:00:03.944073 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
alter table "instacart_db"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:00:03.945207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:03.963704 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: COMMIT
[0m19:00:03.964350 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:00:03.964909 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: COMMIT
[0m19:00:03.966728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:00:03.973886 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."stg_orders__dbt_backup"
[0m19:00:03.979420 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:00:03.979959 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
drop view if exists "instacart_db"."public"."stg_orders__dbt_backup" cascade
[0m19:00:03.983087 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:00:03.985633 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: Close
[0m19:00:03.989319 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.18s]
[0m19:00:03.990534 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.stg_orders
[0m19:00:03.991545 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m19:00:03.992090 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add
[0m19:00:03.992630 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m19:00:03.993560 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m19:00:03.993185 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_orders_order_id ................................. [RUN]
[0m19:00:03.994354 [info ] [Thread-2 (]: 2 of 8 START test not_null_stg_orders_order_day_of_week ........................ [RUN]
[0m19:00:03.994808 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_orders_order_hour ............................... [RUN]
[0m19:00:03.996585 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64'
[0m19:00:03.995604 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_orders_order_number ............................. [RUN]
[0m19:00:03.997517 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add'
[0m19:00:03.998561 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a'
[0m19:00:03.999640 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m19:00:04.000652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.stg_orders, now test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0)
[0m19:00:04.001138 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add
[0m19:00:04.001767 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m19:00:04.008987 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m19:00:04.025047 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:00:04.031003 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add"
[0m19:00:04.034950 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m19:00:04.039159 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m19:00:04.043631 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m19:00:04.044168 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add
[0m19:00:04.076390 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:00:04.078627 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add"
[0m19:00:04.079239 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m19:00:04.080079 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m19:00:04.083196 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m19:00:04.085814 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m19:00:04.086644 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:00:04.087436 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m19:00:04.088157 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:00:04.089491 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add"
[0m19:00:04.090128 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add: BEGIN
[0m19:00:04.090658 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:00:04.091609 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m19:00:04.092448 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m19:00:04.093101 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: BEGIN
[0m19:00:04.093765 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: BEGIN
[0m19:00:04.094393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:04.095037 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:00:04.161325 [debug] [Thread-4 (]: SQL status: BEGIN in 0.073 seconds
[0m19:00:04.162229 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:00:04.162985 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "instacart_db"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m19:00:04.214876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.120 seconds
[0m19:00:04.215681 [debug] [Thread-3 (]: SQL status: BEGIN in 0.121 seconds
[0m19:00:04.216348 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m19:00:04.216986 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m19:00:04.217714 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_number
from "instacart_db"."public"."stg_orders"
where order_number is null



  
  
      
    ) dbt_internal_test
[0m19:00:04.218778 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_hour
from "instacart_db"."public"."stg_orders"
where order_hour is null



  
  
      
    ) dbt_internal_test
[0m19:00:04.224812 [debug] [Thread-2 (]: SQL status: BEGIN in 0.134 seconds
[0m19:00:04.226248 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add"
[0m19:00:04.226925 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_day_of_week
from "instacart_db"."public"."stg_orders"
where order_day_of_week is null



  
  
      
    ) dbt_internal_test
[0m19:00:04.229697 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "order_day_of_week" does not exist
LINE 16: select order_day_of_week
                ^

[0m19:00:04.230463 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add: ROLLBACK
[0m19:00:04.231336 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add: Close
[0m19:00:04.248576 [debug] [Thread-2 (]: Database Error in test not_null_stg_orders_order_day_of_week (models\staging\schema.yml)
  column "order_day_of_week" does not exist
  LINE 16: select order_day_of_week
                  ^
  compiled code at target\run\instacart_dbt\models\staging\schema.yml\not_null_stg_orders_order_day_of_week.sql
[0m19:00:04.249643 [error] [Thread-2 (]: 2 of 8 ERROR not_null_stg_orders_order_day_of_week ............................. [[31mERROR[0m in 0.25s]
[0m19:00:04.264709 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add
[0m19:00:04.265451 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m19:00:04.266261 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_orders_order_day_of_week (models\staging\schema.yml)
  column "order_day_of_week" does not exist
  LINE 16: select order_day_of_week
                  ^
  compiled code at target\run\instacart_dbt\models\staging\schema.yml\not_null_stg_orders_order_day_of_week.sql.
[0m19:00:04.267365 [info ] [Thread-2 (]: 6 of 8 START test not_null_stg_orders_user_id .................................. [RUN]
[0m19:00:04.278402 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_day_of_week.09e7154add, now test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209)
[0m19:00:04.279157 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m19:00:04.286037 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m19:00:04.288985 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m19:00:04.293574 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m19:00:04.295394 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m19:00:04.296069 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: BEGIN
[0m19:00:04.296653 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:04.481040 [debug] [Thread-2 (]: SQL status: BEGIN in 0.184 seconds
[0m19:00:04.481912 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m19:00:04.482569 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "instacart_db"."public"."stg_orders"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m19:00:04.721681 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.502 seconds
[0m19:00:04.727601 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: ROLLBACK
[0m19:00:04.728556 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: Close
[0m19:00:04.729628 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_orders_order_hour ..................................... [[32mPASS[0m in 0.73s]
[0m19:00:04.731810 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m19:00:04.732523 [debug] [Thread-3 (]: Began running node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m19:00:04.733821 [info ] [Thread-3 (]: 7 of 8 START test relationships_stg_order_products_order_id__order_id__ref_stg_orders_  [RUN]
[0m19:00:04.739800 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a, now test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544)
[0m19:00:04.740507 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m19:00:04.758033 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m19:00:04.760625 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m19:00:04.765029 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m19:00:04.766657 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m19:00:04.767666 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: BEGIN
[0m19:00:04.768300 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:04.773627 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.610 seconds
[0m19:00:04.776726 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m19:00:04.778556 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m19:00:04.779624 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.78s]
[0m19:00:04.786228 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m19:00:04.786955 [debug] [Thread-4 (]: Began running node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m19:00:04.788194 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_orders_order_id ................................... [RUN]
[0m19:00:04.797486 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m19:00:04.798171 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m19:00:04.810656 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m19:00:04.813039 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m19:00:04.817735 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m19:00:04.819234 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m19:00:04.819963 [debug] [Thread-4 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m19:00:04.820574 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:00:04.854650 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.635 seconds
[0m19:00:04.857420 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: ROLLBACK
[0m19:00:04.858616 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: Close
[0m19:00:04.860934 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_orders_order_number ................................... [[32mPASS[0m in 0.86s]
[0m19:00:04.869746 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m19:00:04.895775 [debug] [Thread-3 (]: SQL status: BEGIN in 0.127 seconds
[0m19:00:04.896553 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m19:00:04.897222 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "instacart_db"."public"."stg_order_products"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "instacart_db"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m19:00:04.927167 [debug] [Thread-4 (]: SQL status: BEGIN in 0.106 seconds
[0m19:00:04.927946 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m19:00:04.928630 [debug] [Thread-4 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:00:05.084968 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.602 seconds
[0m19:00:05.087511 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: ROLLBACK
[0m19:00:05.088495 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: Close
[0m19:00:05.089989 [info ] [Thread-2 (]: 6 of 8 PASS not_null_stg_orders_user_id ........................................ [[32mPASS[0m in 0.81s]
[0m19:00:05.093937 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m19:00:11.492723 [debug] [Thread-4 (]: SQL status: SELECT 1 in 6.563 seconds
[0m19:00:11.495575 [debug] [Thread-4 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m19:00:11.496642 [debug] [Thread-4 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m19:00:11.497840 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 6.70s]
[0m19:00:11.499555 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m19:00:15.108886 [debug] [Thread-3 (]: SQL status: SELECT 1 in 10.211 seconds
[0m19:00:15.110601 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: ROLLBACK
[0m19:00:15.111290 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: Close
[0m19:00:15.112119 [info ] [Thread-3 (]: 7 of 8 PASS relationships_stg_order_products_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 10.37s]
[0m19:00:15.113254 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m19:00:15.115100 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:15.115614 [debug] [MainThread]: On master: BEGIN
[0m19:00:15.116055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:15.182626 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m19:00:15.183135 [debug] [MainThread]: On master: COMMIT
[0m19:00:15.183479 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:15.183798 [debug] [MainThread]: On master: COMMIT
[0m19:00:15.184261 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:15.184565 [debug] [MainThread]: On master: Close
[0m19:00:15.184990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:15.185328 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m19:00:15.185635 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m19:00:15.185948 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m19:00:15.186198 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0' was properly closed.
[0m19:00:15.186774 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m19:00:15.187659 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209' was properly closed.
[0m19:00:15.188199 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544' was properly closed.
[0m19:00:15.188821 [info ] [MainThread]: 
[0m19:00:15.189397 [info ] [MainThread]: Finished running 7 data tests, 1 view model in 0 hours 0 minutes and 12.04 seconds (12.04s).
[0m19:00:15.191382 [debug] [MainThread]: Command end result
[0m19:00:15.249698 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m19:00:15.255630 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m19:00:15.263737 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m19:00:15.264617 [info ] [MainThread]: 
[0m19:00:15.265831 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:00:15.266674 [info ] [MainThread]: 
[0m19:00:15.267296 [error] [MainThread]: [31mFailure in test not_null_stg_orders_order_day_of_week (models\staging\schema.yml)[0m
[0m19:00:15.267856 [error] [MainThread]:   Database Error in test not_null_stg_orders_order_day_of_week (models\staging\schema.yml)
  column "order_day_of_week" does not exist
  LINE 16: select order_day_of_week
                  ^
  compiled code at target\run\instacart_dbt\models\staging\schema.yml\not_null_stg_orders_order_day_of_week.sql
[0m19:00:15.268595 [info ] [MainThread]: 
[0m19:00:15.269272 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\staging\schema.yml\not_null_stg_orders_order_day_of_week.sql
[0m19:00:15.269771 [info ] [MainThread]: 
[0m19:00:15.270262 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m19:00:15.272945 [debug] [MainThread]: Command `dbt build` failed at 19:00:15.272746 after 13.89 seconds
[0m19:00:15.273480 [debug] [MainThread]: Flushing usage events
[0m19:03:34.904125 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 19:03:35.045328 | 29b00943-98c0-450f-8658-239822abeddc ==============================
[0m19:03:35.045328 [info ] [MainThread]: Running with dbt=1.10.3
[0m19:03:35.046679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select stg_orders', 'send_anonymous_usage_stats': 'True'}
[0m19:03:35.486845 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:03:35.725141 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m19:03:36.067434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:03:36.068656 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\staging\schema.yml
[0m19:03:36.654874 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\staging\schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_utils.accepted_range', {'min_value': 0, 'max_value': 30}), ('config', {'severity': 'warn'})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m19:03:36.656849 [debug] [MainThread]: Command `dbt build` failed at 19:03:36.656684 after 1.82 seconds
[0m19:03:36.657246 [debug] [MainThread]: Flushing usage events
[0m19:05:07.441049 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 19:05:07.571801 | a6134e83-5804-427d-9c67-167d0fd584a8 ==============================
[0m19:05:07.571801 [info ] [MainThread]: Running with dbt=1.10.3
[0m19:05:07.572737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select stg_orders', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:05:08.003844 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:05:08.232656 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m19:05:08.570557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:05:08.572504 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\staging\schema.yml
[0m19:05:08.573041 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\staging\stg_orders.sql
[0m19:05:09.121126 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\staging\schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_utils.accepted_range', {'min_value': 0, 'max_value': 30}), ('config', {'severity': 'warn'})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m19:05:09.122382 [debug] [MainThread]: Command `dbt build` failed at 19:05:09.122231 after 1.77 seconds
[0m19:05:09.122791 [debug] [MainThread]: Flushing usage events
[0m19:06:15.047094 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 19:06:15.149342 | 5b528555-b147-4eec-864d-e5ebfdea2353 ==============================
[0m19:06:15.149342 [info ] [MainThread]: Running with dbt=1.10.3
[0m19:06:15.150319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select stg_orders', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:06:15.643691 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:06:15.885394 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m19:06:16.334235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:06:16.335416 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\staging\schema.yml
[0m19:06:16.335838 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\staging\stg_orders.sql
[0m19:06:17.050504 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m19:06:17.054562 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m19:06:17.143214 [info ] [MainThread]: Found 12 models, 5 seeds, 72 data tests, 5 sources, 547 macros
[0m19:06:17.151089 [info ] [MainThread]: 
[0m19:06:17.152242 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:06:17.152985 [info ] [MainThread]: 
[0m19:06:17.154486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:06:17.156745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m19:06:17.412251 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m19:06:17.412761 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m19:06:17.413121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:17.477838 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.065 seconds
[0m19:06:17.479189 [debug] [ThreadPool]: On list_instacart_db: Close
[0m19:06:17.486072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m19:06:17.492417 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m19:06:17.493012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m19:06:17.493440 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m19:06:17.495497 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m19:06:17.495889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:17.496272 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m19:06:17.496748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:17.551307 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m19:06:17.552050 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m19:06:17.552620 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:06:17.562255 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.009 seconds
[0m19:06:17.564694 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m19:06:17.565510 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m19:06:17.569814 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m19:06:17.570329 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m19:06:17.570751 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:06:17.575803 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:06:17.577057 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m19:06:17.577622 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m19:06:17.584615 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:17.585063 [debug] [MainThread]: On master: BEGIN
[0m19:06:17.585448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:06:17.786084 [debug] [MainThread]: SQL status: BEGIN in 0.200 seconds
[0m19:06:17.787016 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:17.788011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:06:17.809049 [debug] [MainThread]: SQL status: SELECT 5 in 0.020 seconds
[0m19:06:17.812543 [debug] [MainThread]: On master: ROLLBACK
[0m19:06:17.813614 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:17.815061 [debug] [MainThread]: On master: BEGIN
[0m19:06:17.816802 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:06:17.817433 [debug] [MainThread]: On master: COMMIT
[0m19:06:17.817902 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:17.818359 [debug] [MainThread]: On master: COMMIT
[0m19:06:17.819121 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:06:17.819610 [debug] [MainThread]: On master: Close
[0m19:06:17.829809 [debug] [Thread-1 (]: Began running node model.instacart_dbt.stg_orders
[0m19:06:17.831410 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m19:06:17.833363 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.stg_orders'
[0m19:06:17.834463 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.stg_orders
[0m19:06:17.852110 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.stg_orders"
[0m19:06:17.859648 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.stg_orders
[0m19:06:17.917663 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.stg_orders"
[0m19:06:17.919581 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:06:17.920220 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: BEGIN
[0m19:06:17.920763 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:06:17.969403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m19:06:17.970099 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:06:17.970759 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */

  create view "instacart_db"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql

-- Tujuan staging:
-- 1. Menyelaraskan penamaan kolom agar lebih readable
-- 2. Menjaga NULL pada kolom `days_since_prior_order`
-- 3. Mapping hari dari angka ke nama (Sunday–Saturday)
-- 4. Konsistensi struktur dan tipe data untuk model downstream

with source as (

    select *
    from "instacart_db"."public"."orders"

),

renamed as (

    select
        order_id,
        user_id,
        order_number,

        -- Mapping 0-6 menjadi nama hari (Bahasa Inggris)
        case order_day_of_week
            when 0 then 'Sunday'
            when 1 then 'Monday'
            when 2 then 'Tuesday'
            when 3 then 'Wednesday'
            when 4 then 'Thursday'
            when 5 then 'Friday'
            when 6 then 'Saturday'
        end as order_day,
        order_hour_of_day as order_hour,
        days_since_prior_order as days_gap
    from source

)

select * from renamed
  );
[0m19:06:17.986615 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m19:06:17.994053 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:06:17.994534 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
alter table "instacart_db"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m19:06:17.997223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:06:17.999908 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:06:18.000433 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
alter table "instacart_db"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:06:18.001693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:06:18.019861 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: COMMIT
[0m19:06:18.020380 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:06:18.020952 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: COMMIT
[0m19:06:18.022760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:06:18.029119 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."stg_orders__dbt_backup"
[0m19:06:18.034580 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m19:06:18.035080 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
drop view if exists "instacart_db"."public"."stg_orders__dbt_backup" cascade
[0m19:06:18.038085 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:06:18.040985 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: Close
[0m19:06:18.043972 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m19:06:18.045128 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.stg_orders
[0m19:06:18.046138 [debug] [Thread-3 (]: Began running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m19:06:18.046632 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m19:06:18.047187 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m19:06:18.048199 [debug] [Thread-2 (]: Began running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e
[0m19:06:18.047648 [info ] [Thread-3 (]: 3 of 10 START test dbt_utils_accepted_range_stg_orders_order_hour__23__0 ....... [RUN]
[0m19:06:18.049103 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_orders_order_hour .............................. [RUN]
[0m19:06:18.049525 [info ] [Thread-4 (]: 4 of 10 START test not_null_stg_orders_order_day ............................... [RUN]
[0m19:06:18.051014 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9'
[0m19:06:18.051676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.stg_orders, now test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a)
[0m19:06:18.050221 [info ] [Thread-2 (]: 2 of 10 START test dbt_utils_accepted_range_stg_orders_days_gap__30__0 ......... [RUN]
[0m19:06:18.052424 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_stg_orders_order_day.25276152f4'
[0m19:06:18.052926 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m19:06:18.053436 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m19:06:18.054519 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e'
[0m19:06:18.055356 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m19:06:18.078919 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m19:06:18.083280 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m19:06:18.083919 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e
[0m19:06:18.089990 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m19:06:18.096050 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e"
[0m19:06:18.097127 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m19:06:18.097859 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m19:06:18.118889 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m19:06:18.122741 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m19:06:18.123682 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m19:06:18.124252 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e
[0m19:06:18.127006 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m19:06:18.129639 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e"
[0m19:06:18.130620 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m19:06:18.131332 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: BEGIN
[0m19:06:18.131987 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m19:06:18.132437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:18.133110 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: BEGIN
[0m19:06:18.133789 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m19:06:18.134454 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e"
[0m19:06:18.135075 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:06:18.135574 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: BEGIN
[0m19:06:18.136056 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e: BEGIN
[0m19:06:18.136728 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:06:18.138080 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:06:18.229008 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m19:06:18.229942 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m19:06:18.230754 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "instacart_db"."public"."stg_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not order_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not order_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m19:06:18.236967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.104 seconds
[0m19:06:18.238047 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m19:06:18.238940 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_hour
from "instacart_db"."public"."stg_orders"
where order_hour is null



  
  
      
    ) dbt_internal_test
[0m19:06:18.280287 [debug] [Thread-4 (]: SQL status: BEGIN in 0.143 seconds
[0m19:06:18.281198 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m19:06:18.281964 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_day
from "instacart_db"."public"."stg_orders"
where order_day is null



  
  
      
    ) dbt_internal_test
[0m19:06:18.333968 [debug] [Thread-2 (]: SQL status: BEGIN in 0.196 seconds
[0m19:06:18.334861 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e"
[0m19:06:18.335642 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "instacart_db"."public"."stg_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not days_gap >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not days_gap <= 30
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m19:06:19.013647 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.774 seconds
[0m19:06:19.019959 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: ROLLBACK
[0m19:06:19.021195 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: Close
[0m19:06:19.022559 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_orders_order_hour .................................... [[32mPASS[0m in 0.97s]
[0m19:06:19.037812 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m19:06:19.038709 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m19:06:19.039566 [info ] [Thread-1 (]: 6 of 10 START test not_null_stg_orders_order_id ................................ [RUN]
[0m19:06:19.062190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a, now test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m19:06:19.063013 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m19:06:19.070962 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:06:19.072194 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.841 seconds
[0m19:06:19.076516 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: ROLLBACK
[0m19:06:19.077648 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: Close
[0m19:06:19.079728 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m19:06:19.084759 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:06:19.086496 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:06:19.087490 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m19:06:19.088963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:19.078965 [info ] [Thread-3 (]: 3 of 10 PASS dbt_utils_accepted_range_stg_orders_order_hour__23__0 ............. [[32mPASS[0m in 1.03s]
[0m19:06:19.105327 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m19:06:19.106477 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m19:06:19.107741 [info ] [Thread-3 (]: 7 of 10 START test not_null_stg_orders_order_number ............................ [RUN]
[0m19:06:19.114262 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9, now test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0)
[0m19:06:19.115097 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m19:06:19.124164 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m19:06:19.127019 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m19:06:19.131989 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m19:06:19.133667 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m19:06:19.134405 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: BEGIN
[0m19:06:19.135097 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:06:19.250355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.162 seconds
[0m19:06:19.251262 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:06:19.251981 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "instacart_db"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m19:06:19.302095 [debug] [Thread-3 (]: SQL status: BEGIN in 0.167 seconds
[0m19:06:19.302937 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m19:06:19.303656 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_number
from "instacart_db"."public"."stg_orders"
where order_number is null



  
  
      
    ) dbt_internal_test
[0m19:06:19.328908 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.992 seconds
[0m19:06:19.331703 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e: ROLLBACK
[0m19:06:19.332626 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e: Close
[0m19:06:19.333736 [info ] [Thread-2 (]: 2 of 10 PASS dbt_utils_accepted_range_stg_orders_days_gap__30__0 ............... [[32mPASS[0m in 1.28s]
[0m19:06:19.351135 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e
[0m19:06:19.351937 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m19:06:19.352629 [info ] [Thread-2 (]: 8 of 10 START test not_null_stg_orders_user_id ................................. [RUN]
[0m19:06:19.384445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e, now test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209)
[0m19:06:19.385349 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m19:06:19.393365 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m19:06:19.394910 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m19:06:19.399141 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m19:06:19.400777 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m19:06:19.401516 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: BEGIN
[0m19:06:19.402135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:06:19.456483 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.174 seconds
[0m19:06:19.459376 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: ROLLBACK
[0m19:06:19.460357 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: Close
[0m19:06:19.461481 [info ] [Thread-4 (]: 4 of 10 PASS not_null_stg_orders_order_day ..................................... [[32mPASS[0m in 1.41s]
[0m19:06:19.474951 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m19:06:19.475789 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m19:06:19.476611 [info ] [Thread-4 (]: 9 of 10 START test relationships_stg_order_products_order_id__order_id__ref_stg_orders_  [RUN]
[0m19:06:19.503240 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_day.25276152f4, now test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544)
[0m19:06:19.504219 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m19:06:19.520825 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m19:06:19.522763 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m19:06:19.528276 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m19:06:19.530051 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m19:06:19.530852 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: BEGIN
[0m19:06:19.531508 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:06:19.646416 [debug] [Thread-4 (]: SQL status: BEGIN in 0.115 seconds
[0m19:06:19.647327 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m19:06:19.648062 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "instacart_db"."public"."stg_order_products"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "instacart_db"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m19:06:19.648857 [debug] [Thread-2 (]: SQL status: BEGIN in 0.247 seconds
[0m19:06:19.649622 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m19:06:19.650290 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "instacart_db"."public"."stg_orders"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m19:06:19.955483 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.703 seconds
[0m19:06:19.958317 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m19:06:19.959274 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m19:06:19.960431 [info ] [Thread-1 (]: 6 of 10 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.90s]
[0m19:06:19.978621 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m19:06:19.979463 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m19:06:19.980173 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_orders_order_id ................................. [RUN]
[0m19:06:19.998656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m19:06:19.999470 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m19:06:20.013178 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m19:06:20.014801 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m19:06:20.019104 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m19:06:20.021276 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m19:06:20.024252 [debug] [Thread-1 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m19:06:20.025542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:20.045548 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.741 seconds
[0m19:06:20.048403 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: ROLLBACK
[0m19:06:20.049379 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: Close
[0m19:06:20.050583 [info ] [Thread-3 (]: 7 of 10 PASS not_null_stg_orders_order_number .................................. [[32mPASS[0m in 0.94s]
[0m19:06:20.054443 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m19:06:20.149173 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.498 seconds
[0m19:06:20.151984 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: ROLLBACK
[0m19:06:20.153031 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: Close
[0m19:06:20.155861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.130 seconds
[0m19:06:20.156645 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m19:06:20.157407 [debug] [Thread-1 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:06:20.154498 [info ] [Thread-2 (]: 8 of 10 PASS not_null_stg_orders_user_id ....................................... [[32mPASS[0m in 0.77s]
[0m19:06:20.164352 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m19:06:26.860355 [debug] [Thread-1 (]: SQL status: SELECT 1 in 6.702 seconds
[0m19:06:26.863961 [debug] [Thread-1 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m19:06:26.865624 [debug] [Thread-1 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m19:06:26.867048 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 6.87s]
[0m19:06:26.877037 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m19:06:33.066818 [debug] [Thread-4 (]: SQL status: SELECT 1 in 13.417 seconds
[0m19:06:33.068461 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: ROLLBACK
[0m19:06:33.069086 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: Close
[0m19:06:33.069767 [info ] [Thread-4 (]: 9 of 10 PASS relationships_stg_order_products_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 13.57s]
[0m19:06:33.072022 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m19:06:33.074471 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:33.075123 [debug] [MainThread]: On master: BEGIN
[0m19:06:33.075646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:33.144333 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m19:06:33.144798 [debug] [MainThread]: On master: COMMIT
[0m19:06:33.145126 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:33.145418 [debug] [MainThread]: On master: COMMIT
[0m19:06:33.145820 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:06:33.146116 [debug] [MainThread]: On master: Close
[0m19:06:33.146545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:33.146883 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m19:06:33.147204 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m19:06:33.147463 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m19:06:33.147715 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m19:06:33.148042 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0' was properly closed.
[0m19:06:33.148573 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544' was properly closed.
[0m19:06:33.149014 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209' was properly closed.
[0m19:06:33.149568 [info ] [MainThread]: 
[0m19:06:33.150267 [info ] [MainThread]: Finished running 9 data tests, 1 view model in 0 hours 0 minutes and 16.00 seconds (16.00s).
[0m19:06:33.153624 [debug] [MainThread]: Command end result
[0m19:06:33.209563 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m19:06:33.216284 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m19:06:33.225885 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m19:06:33.226552 [info ] [MainThread]: 
[0m19:06:33.227277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:33.228106 [info ] [MainThread]: 
[0m19:06:33.228814 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m19:06:33.230022 [debug] [MainThread]: Command `dbt build` succeeded at 19:06:33.229881 after 18.25 seconds
[0m19:06:33.230423 [debug] [MainThread]: Flushing usage events
[0m21:20:37.767000 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:20:37.915018 | b0cfd909-e66b-4147-9092-584ca08c84a4 ==============================
[0m21:20:37.915018 [info ] [MainThread]: Running with dbt=1.10.3
[0m21:20:37.915998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select dim_user', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:20:38.520337 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:20:38.771764 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m21:20:39.141477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:39.141930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:39.411782 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:20:39.415609 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:20:39.503069 [info ] [MainThread]: Found 12 models, 5 seeds, 72 data tests, 5 sources, 547 macros
[0m21:20:39.507228 [info ] [MainThread]: 
[0m21:20:39.508045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:20:39.508770 [info ] [MainThread]: 
[0m21:20:39.509888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:20:39.512332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:20:39.867210 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:20:39.867889 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:20:39.868384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:39.955965 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.087 seconds
[0m21:20:39.958451 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:20:39.965898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:20:39.975069 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:20:39.975738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:20:39.976162 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:20:39.978986 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:20:39.979497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:39.979970 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:20:39.980664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:40.049961 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m21:20:40.050688 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:20:40.051267 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:20:40.058136 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m21:20:40.058896 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:20:40.059437 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:20:40.063574 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m21:20:40.065949 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:20:40.066734 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.007 seconds
[0m21:20:40.067185 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:20:40.068892 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:20:40.069660 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:20:40.081265 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:40.081755 [debug] [MainThread]: On master: BEGIN
[0m21:20:40.082098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:40.133121 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m21:20:40.133580 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:40.133990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:20:40.147540 [debug] [MainThread]: SQL status: SELECT 5 in 0.013 seconds
[0m21:20:40.150193 [debug] [MainThread]: On master: ROLLBACK
[0m21:20:40.150762 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:40.151145 [debug] [MainThread]: On master: BEGIN
[0m21:20:40.151749 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:20:40.152165 [debug] [MainThread]: On master: COMMIT
[0m21:20:40.152528 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:40.152853 [debug] [MainThread]: On master: COMMIT
[0m21:20:40.153340 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:20:40.153696 [debug] [MainThread]: On master: Close
[0m21:20:40.159996 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_user
[0m21:20:40.160873 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_user ................................... [RUN]
[0m21:20:40.162161 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_user'
[0m21:20:40.162643 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_user
[0m21:20:40.175722 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_user"
[0m21:20:40.179553 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_user
[0m21:20:40.236709 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_user"
[0m21:20:40.238553 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:20:40.239389 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: BEGIN
[0m21:20:40.240069 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:20:40.292309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m21:20:40.293092 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:20:40.293800 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */

  
    

  create  table "instacart_db"."public"."dim_user__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_user.sql

  -- Tujuan:
  -- Model ini membentuk dimensi pengguna berdasarkan data order.
  -- Setiap baris mewakili satu user, disertai agregasi statistik perilaku belanja:
  -- 1. total_orders: jumlah pesanan yang pernah dilakukan user
  -- 2. max_order_number: urutan order terakhir (maksimal)
  -- 3. avg_days_between_orders: rata-rata selisih hari antar order (tidak termasuk NULL)

  with orders as (

      -- Mengambil seluruh data dari model staging orders
      select * 
      from "instacart_db"."public"."stg_orders"

  ),

  aggregated as (

      -- Melakukan agregasi per user
      select
          user_id,

          -- Total pesanan (order_id) yang dilakukan user
          count(order_id) as total_orders,

          -- Order terakhir (urutan ke berapa yang paling akhir)
          max(order_number) as max_order_number,

          -- Rata-rata jeda antar order (hanya dihitung jika tidak NULL)
          avg(days_since_prior_order) as avg_days_between_orders

      from orders
      group by user_id

  )

  -- Final result: satu baris per user
  select * from aggregated
  );
  
[0m21:20:40.299962 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "days_since_prior_order" does not exist
LINE 42:           avg(days_since_prior_order) as avg_days_between_or...
                       ^

[0m21:20:40.300800 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: ROLLBACK
[0m21:20:40.301615 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: Close
[0m21:20:40.314269 [debug] [Thread-1 (]: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  column "days_since_prior_order" does not exist
  LINE 42:           avg(days_since_prior_order) as avg_days_between_or...
                         ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:20:40.317232 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model public.dim_user .......................... [[31mERROR[0m in 0.15s]
[0m21:20:40.318206 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_user
[0m21:20:40.318852 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.dim_user' to be skipped because of status 'error'.  Reason: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  column "days_since_prior_order" does not exist
  LINE 42:           avg(days_since_prior_order) as avg_days_between_or...
                         ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql.
[0m21:20:40.319857 [debug] [Thread-1 (]: Began running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:20:40.320270 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:20:40.320699 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:20:40.321095 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_user_max_order_number.953b045bd2
[0m21:20:40.321551 [info ] [Thread-1 (]: 5 of 6 SKIP test relationships_fact_order_items_user_id__user_id__ref_dim_user_  [[33mSKIP[0m]
[0m21:20:40.323747 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:20:40.324425 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:20:40.325081 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d' to be skipped because of status 'skipped'. 
[0m21:20:40.322076 [info ] [Thread-3 (]: 3 of 6 SKIP test not_null_dim_user_total_orders ................................ [[33mSKIP[0m]
[0m21:20:40.326698 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:20:40.322622 [info ] [Thread-4 (]: 4 of 6 SKIP test not_null_dim_user_user_id ..................................... [[33mSKIP[0m]
[0m21:20:40.328656 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:20:40.329242 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458' to be skipped because of status 'skipped'. 
[0m21:20:40.323215 [info ] [Thread-2 (]: 2 of 6 SKIP test not_null_dim_user_max_order_number ............................ [[33mSKIP[0m]
[0m21:20:40.330364 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3' to be skipped because of status 'skipped'. 
[0m21:20:40.331716 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_user_max_order_number.953b045bd2
[0m21:20:40.326003 [info ] [Thread-1 (]: 6 of 6 SKIP test unique_dim_user_user_id ....................................... [[33mSKIP[0m]
[0m21:20:40.333457 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_max_order_number.953b045bd2' to be skipped because of status 'skipped'. 
[0m21:20:40.334239 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:20:40.335938 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.unique_dim_user_user_id.eff0a2a278' to be skipped because of status 'skipped'. 
[0m21:20:40.340088 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:40.341144 [debug] [MainThread]: On master: BEGIN
[0m21:20:40.341784 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:20:40.407069 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m21:20:40.407793 [debug] [MainThread]: On master: COMMIT
[0m21:20:40.408339 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:40.408776 [debug] [MainThread]: On master: COMMIT
[0m21:20:40.409273 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:20:40.409771 [debug] [MainThread]: On master: Close
[0m21:20:40.410417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:40.411308 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:20:40.412045 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:20:40.412782 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:20:40.414096 [debug] [MainThread]: Connection 'model.instacart_dbt.dim_user' was properly closed.
[0m21:20:40.415289 [info ] [MainThread]: 
[0m21:20:40.416403 [info ] [MainThread]: Finished running 1 table model, 5 data tests in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m21:20:40.417815 [debug] [MainThread]: Command end result
[0m21:20:40.471802 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:20:40.476117 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:20:40.483803 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:20:40.484484 [info ] [MainThread]: 
[0m21:20:40.485326 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:20:40.486052 [info ] [MainThread]: 
[0m21:20:40.486679 [error] [MainThread]: [31mFailure in model dim_user (models\marts\dim\dim_user.sql)[0m
[0m21:20:40.487415 [error] [MainThread]:   Database Error in model dim_user (models\marts\dim\dim_user.sql)
  column "days_since_prior_order" does not exist
  LINE 42:           avg(days_since_prior_order) as avg_days_between_or...
                         ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:20:40.488099 [info ] [MainThread]: 
[0m21:20:40.488823 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:20:40.489397 [info ] [MainThread]: 
[0m21:20:40.489956 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=6
[0m21:20:40.491505 [debug] [MainThread]: Command `dbt build` failed at 21:20:40.491264 after 2.81 seconds
[0m21:20:40.492188 [debug] [MainThread]: Flushing usage events
[0m21:21:57.077877 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:21:57.259068 | d87a40da-955d-4a4c-8d9d-02678234ad8b ==============================
[0m21:21:57.259068 [info ] [MainThread]: Running with dbt=1.10.3
[0m21:21:57.261649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --select dim_user', 'send_anonymous_usage_stats': 'True'}
[0m21:21:58.227298 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:21:58.447129 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m21:21:58.807776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:21:58.808962 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\schema.yml
[0m21:21:59.561228 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:21:59.565253 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:21:59.628626 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:21:59.632957 [info ] [MainThread]: 
[0m21:21:59.633705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:21:59.634440 [info ] [MainThread]: 
[0m21:21:59.635599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:21:59.636877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:22:00.077447 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:22:00.078151 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:22:00.078710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:00.140272 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.061 seconds
[0m21:22:00.143018 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:22:00.150106 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:22:00.156607 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:22:00.157689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:22:00.158284 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:22:00.161173 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:22:00.161560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:00.161913 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:22:00.162397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:00.226694 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m21:22:00.227367 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:22:00.227943 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:22:00.234863 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m21:22:00.235558 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:22:00.236137 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m21:22:00.236690 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:22:00.238951 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:22:00.239667 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:22:00.247818 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.008 seconds
[0m21:22:00.249317 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:22:00.249869 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:22:00.259838 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:00.260496 [debug] [MainThread]: On master: BEGIN
[0m21:22:00.260968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:22:00.310017 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m21:22:00.310528 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:00.310986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:22:00.319466 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m21:22:00.322222 [debug] [MainThread]: On master: ROLLBACK
[0m21:22:00.322795 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:00.323149 [debug] [MainThread]: On master: BEGIN
[0m21:22:00.323827 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:22:00.324318 [debug] [MainThread]: On master: COMMIT
[0m21:22:00.324789 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:00.325245 [debug] [MainThread]: On master: COMMIT
[0m21:22:00.325754 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:22:00.326094 [debug] [MainThread]: On master: Close
[0m21:22:00.331144 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_user
[0m21:22:00.331889 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_user ................................... [RUN]
[0m21:22:00.332704 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_user'
[0m21:22:00.333261 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_user
[0m21:22:00.351242 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_user"
[0m21:22:00.352698 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_user
[0m21:22:00.413172 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_user"
[0m21:22:00.414549 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:22:00.415061 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: BEGIN
[0m21:22:00.415443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:22:00.466268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m21:22:00.466912 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:22:00.467395 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */

  
    

  create  table "instacart_db"."public"."dim_user__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_user.sql

  -- Tujuan:
  -- Model ini membentuk dimensi pengguna berdasarkan data order.
  -- Setiap baris mewakili satu user, disertai agregasi statistik perilaku belanja:
  -- 1. total_orders: jumlah pesanan yang pernah dilakukan user
  -- 2. max_order_number: urutan order terakhir (maksimal)
  -- 3. avg_days_between_orders: rata-rata selisih hari antar order (tidak termasuk NULL)

  with orders as (

      -- Mengambil seluruh data dari model staging orders
      select * 
      from "instacart_db"."public"."stg_orders"

  ),

  aggregated as (

      -- Melakukan agregasi per user
      select
          user_id,

          -- Total pesanan (order_id) yang dilakukan user
          count(order_id) as total_orders,

          -- Order terakhir (urutan ke berapa yang paling akhir)
          max(order_number) as max_order_number,

          -- Rata-rata jeda antar order (hanya dihitung jika tidak NULL)
          avg(days_since_prior_order) as avg_days_between_orders

      from orders
      group by user_id

  )

  -- Final result: satu baris per user
  select * from aggregated
  );
  
[0m21:22:00.468927 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "days_since_prior_order" does not exist
LINE 42:           avg(days_since_prior_order) as avg_days_between_or...
                       ^

[0m21:22:00.469705 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: ROLLBACK
[0m21:22:00.470533 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: Close
[0m21:22:00.482427 [debug] [Thread-1 (]: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  column "days_since_prior_order" does not exist
  LINE 42:           avg(days_since_prior_order) as avg_days_between_or...
                         ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:22:00.486568 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.dim_user .......................... [[31mERROR[0m in 0.15s]
[0m21:22:00.487821 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_user
[0m21:22:00.488651 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.dim_user' to be skipped because of status 'error'.  Reason: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  column "days_since_prior_order" does not exist
  LINE 42:           avg(days_since_prior_order) as avg_days_between_or...
                         ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql.
[0m21:22:00.489840 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:22:00.490841 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:22:00.491492 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:22:00.492684 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:22:00.493417 [info ] [Thread-3 (]: 3 of 5 SKIP test not_null_dim_user_user_id ..................................... [[33mSKIP[0m]
[0m21:22:00.493930 [info ] [Thread-1 (]: 5 of 5 SKIP test unique_dim_user_user_id ....................................... [[33mSKIP[0m]
[0m21:22:00.496039 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:22:00.497006 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:22:00.494712 [info ] [Thread-4 (]: 4 of 5 SKIP test relationships_fact_order_items_user_id__user_id__ref_dim_user_  [[33mSKIP[0m]
[0m21:22:00.498699 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3' to be skipped because of status 'skipped'. 
[0m21:22:00.500136 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:22:00.500841 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.unique_dim_user_user_id.eff0a2a278' to be skipped because of status 'skipped'. 
[0m21:22:00.501753 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d' to be skipped because of status 'skipped'. 
[0m21:22:00.495310 [info ] [Thread-2 (]: 2 of 5 SKIP test not_null_dim_user_total_orders ................................ [[33mSKIP[0m]
[0m21:22:00.505734 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:22:00.507959 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458' to be skipped because of status 'skipped'. 
[0m21:22:00.510203 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:00.510824 [debug] [MainThread]: On master: BEGIN
[0m21:22:00.511304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:22:00.578061 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m21:22:00.578870 [debug] [MainThread]: On master: COMMIT
[0m21:22:00.579427 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:00.579856 [debug] [MainThread]: On master: COMMIT
[0m21:22:00.580458 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:22:00.580878 [debug] [MainThread]: On master: Close
[0m21:22:00.581478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:00.581872 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:22:00.582248 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:22:00.582604 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:22:00.582966 [debug] [MainThread]: Connection 'model.instacart_dbt.dim_user' was properly closed.
[0m21:22:00.583441 [info ] [MainThread]: 
[0m21:22:00.584080 [info ] [MainThread]: Finished running 1 table model, 4 data tests in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m21:22:00.585279 [debug] [MainThread]: Command end result
[0m21:22:00.642324 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:22:00.648326 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:22:00.657345 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:22:00.658158 [info ] [MainThread]: 
[0m21:22:00.659019 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:22:00.659645 [info ] [MainThread]: 
[0m21:22:00.660258 [error] [MainThread]: [31mFailure in model dim_user (models\marts\dim\dim_user.sql)[0m
[0m21:22:00.660741 [error] [MainThread]:   Database Error in model dim_user (models\marts\dim\dim_user.sql)
  column "days_since_prior_order" does not exist
  LINE 42:           avg(days_since_prior_order) as avg_days_between_or...
                         ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:22:00.661164 [info ] [MainThread]: 
[0m21:22:00.661783 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:22:00.662361 [info ] [MainThread]: 
[0m21:22:00.662935 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=5
[0m21:22:00.664180 [debug] [MainThread]: Command `dbt build` failed at 21:22:00.664006 after 3.75 seconds
[0m21:22:00.664878 [debug] [MainThread]: Flushing usage events
[0m21:25:27.177175 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:25:27.331697 | 2a62e32c-24d4-4685-ac2b-e7c46d8b01d1 ==============================
[0m21:25:27.331697 [info ] [MainThread]: Running with dbt=1.10.3
[0m21:25:27.333045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select dim_user', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:25:27.758605 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:25:27.988767 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m21:25:28.343349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:25:28.344266 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\dim_user.sql
[0m21:25:29.187427 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:25:29.192428 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:25:29.262630 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:25:29.268309 [info ] [MainThread]: 
[0m21:25:29.269151 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:25:29.269966 [info ] [MainThread]: 
[0m21:25:29.270867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:25:29.272764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:25:29.486963 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:25:29.487588 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:25:29.488045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:29.556235 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.068 seconds
[0m21:25:29.557677 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:25:29.565349 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:25:29.571643 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:25:29.572241 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:25:29.572615 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:25:29.574712 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:25:29.575129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:29.575556 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:25:29.576143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:29.639196 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m21:25:29.639869 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:25:29.640437 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:25:29.643982 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m21:25:29.644684 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:25:29.645245 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:25:29.647937 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.007 seconds
[0m21:25:29.650562 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:25:29.651497 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:25:29.652116 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m21:25:29.653789 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:25:29.660443 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:25:29.668638 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:29.669296 [debug] [MainThread]: On master: BEGIN
[0m21:25:29.669798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:25:29.733102 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m21:25:29.733780 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:29.734385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:25:29.744264 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m21:25:29.748175 [debug] [MainThread]: On master: ROLLBACK
[0m21:25:29.748932 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:29.749437 [debug] [MainThread]: On master: BEGIN
[0m21:25:29.750014 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:25:29.750528 [debug] [MainThread]: On master: COMMIT
[0m21:25:29.751033 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:29.751525 [debug] [MainThread]: On master: COMMIT
[0m21:25:29.752211 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:25:29.752775 [debug] [MainThread]: On master: Close
[0m21:25:29.758636 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_user
[0m21:25:29.759676 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_user ................................... [RUN]
[0m21:25:29.760898 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_user'
[0m21:25:29.761631 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_user
[0m21:25:29.791080 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_user"
[0m21:25:29.792583 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_user
[0m21:25:29.849926 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_user"
[0m21:25:29.851533 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:25:29.852230 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: BEGIN
[0m21:25:29.852826 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:25:29.898502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m21:25:29.899033 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:25:29.899468 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */

  
    

  create  table "instacart_db"."public"."dim_user__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_user.sql

-- Tujuan:
-- Membangun dimensi user sederhana berbasis aktivitas order.
-- Fokus pada jumlah order, jeda antar order, dan aktivitas terakhir.

with base as (
    select
        user_id,
        order_number,
        days_gap
    from "instacart_db"."public"."stg_orders"
),

agg as (
    select
        user_id,
        count(*) as total_orders,
        avg(days_gap) as avg_days_between_orders,
        max(order_number) as last_order_number,
        max(days_gap) as days_since_last_order
    from base
    group by user_id
)

select * from agg
  );
  
[0m21:25:31.257543 [debug] [Thread-1 (]: SQL status: SELECT 206209 in 1.358 seconds
[0m21:25:31.268859 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:25:31.269349 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */
alter table "instacart_db"."public"."dim_user" rename to "dim_user__dbt_backup"
[0m21:25:31.272121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:25:31.277411 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:25:31.278045 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */
alter table "instacart_db"."public"."dim_user__dbt_tmp" rename to "dim_user"
[0m21:25:31.279267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:25:31.299877 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: COMMIT
[0m21:25:31.300713 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:25:31.301357 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: COMMIT
[0m21:25:31.310603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m21:25:31.319778 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_user__dbt_backup"
[0m21:25:31.324730 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:25:31.325220 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */
drop table if exists "instacart_db"."public"."dim_user__dbt_backup" cascade
[0m21:25:31.334464 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m21:25:31.338521 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: Close
[0m21:25:31.342261 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.dim_user .............................. [[32mSELECT 206209[0m in 1.58s]
[0m21:25:31.350019 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_user
[0m21:25:31.351318 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:25:31.352576 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:25:31.353286 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:25:31.354408 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:25:31.352025 [info ] [Thread-3 (]: 3 of 5 START test not_null_dim_user_user_id .................................... [RUN]
[0m21:25:31.356704 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3'
[0m21:25:31.353899 [info ] [Thread-4 (]: 4 of 5 START test relationships_fact_order_items_user_id__user_id__ref_dim_user_  [RUN]
[0m21:25:31.357591 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:25:31.358439 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d'
[0m21:25:31.366304 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:25:31.355330 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_user_user_id ...................................... [RUN]
[0m21:25:31.388691 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d"
[0m21:25:31.389587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_user, now test.instacart_dbt.unique_dim_user_user_id.eff0a2a278)
[0m21:25:31.403877 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3"
[0m21:25:31.355935 [info ] [Thread-2 (]: 2 of 5 START test not_null_dim_user_total_orders ............................... [RUN]
[0m21:25:31.404932 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:25:31.405974 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458'
[0m21:25:31.412915 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:25:31.422064 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_user_user_id.eff0a2a278"
[0m21:25:31.426119 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_user_total_orders.ba47536458"
[0m21:25:31.427210 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:25:31.427974 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:25:31.459561 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3"
[0m21:25:31.462383 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d"
[0m21:25:31.463457 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:25:31.464686 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:25:31.470298 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_user_total_orders.ba47536458"
[0m21:25:31.473713 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_user_user_id.eff0a2a278"
[0m21:25:31.474927 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3"
[0m21:25:31.475695 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m21:25:31.476257 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:25:31.477537 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d"
[0m21:25:31.478327 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d: BEGIN
[0m21:25:31.479034 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:25:31.479912 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_user_user_id.eff0a2a278"
[0m21:25:31.480636 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_user_total_orders.ba47536458"
[0m21:25:31.483642 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m21:25:31.484408 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_user_total_orders.ba47536458: BEGIN
[0m21:25:31.485005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:31.485605 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:25:31.579015 [debug] [Thread-2 (]: SQL status: BEGIN in 0.093 seconds
[0m21:25:31.579745 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_user_total_orders.ba47536458"
[0m21:25:31.580327 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_user_total_orders.ba47536458: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_user_total_orders.ba47536458"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from "instacart_db"."public"."dim_user"
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m21:25:31.590464 [debug] [Thread-4 (]: SQL status: BEGIN in 0.111 seconds
[0m21:25:31.591196 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d"
[0m21:25:31.591827 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "instacart_db"."public"."dim_user"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:25:31.609602 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.028 seconds
[0m21:25:31.615370 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_user_total_orders.ba47536458: ROLLBACK
[0m21:25:31.616458 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_user_total_orders.ba47536458: Close
[0m21:25:31.617230 [debug] [Thread-3 (]: SQL status: BEGIN in 0.141 seconds
[0m21:25:31.617851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.133 seconds
[0m21:25:31.619362 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3"
[0m21:25:31.619975 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_user_user_id.eff0a2a278"
[0m21:25:31.620630 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "instacart_db"."public"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m21:25:31.621263 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:25:31.642942 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m21:25:31.645718 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m21:25:31.646693 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3: Close
[0m21:25:31.618821 [info ] [Thread-2 (]: 2 of 5 PASS not_null_dim_user_total_orders ..................................... [[32mPASS[0m in 0.21s]
[0m21:25:31.656503 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:25:31.647896 [info ] [Thread-3 (]: 3 of 5 PASS not_null_dim_user_user_id .......................................... [[32mPASS[0m in 0.29s]
[0m21:25:31.668846 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:25:32.155857 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.534 seconds
[0m21:25:32.158593 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m21:25:32.159511 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_user_user_id.eff0a2a278: Close
[0m21:25:32.160583 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_user_user_id ............................................ [[32mPASS[0m in 0.77s]
[0m21:25:32.171783 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:25:47.242706 [debug] [Thread-4 (]: SQL status: SELECT 1 in 15.650 seconds
[0m21:25:47.244980 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d: ROLLBACK
[0m21:25:47.246167 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d: Close
[0m21:25:47.247361 [info ] [Thread-4 (]: 4 of 5 PASS relationships_fact_order_items_user_id__user_id__ref_dim_user_ ..... [[32mPASS[0m in 15.89s]
[0m21:25:47.248993 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:25:47.251611 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:47.253538 [debug] [MainThread]: On master: BEGIN
[0m21:25:47.254114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:25:47.337549 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m21:25:47.338131 [debug] [MainThread]: On master: COMMIT
[0m21:25:47.338562 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:47.338965 [debug] [MainThread]: On master: COMMIT
[0m21:25:47.339515 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:25:47.339961 [debug] [MainThread]: On master: Close
[0m21:25:47.340589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:47.341173 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:25:47.341701 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:25:47.342220 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:25:47.342756 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m21:25:47.343285 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m21:25:47.343817 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d' was properly closed.
[0m21:25:47.344312 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458' was properly closed.
[0m21:25:47.344932 [info ] [MainThread]: 
[0m21:25:47.345739 [info ] [MainThread]: Finished running 1 table model, 4 data tests in 0 hours 0 minutes and 18.07 seconds (18.07s).
[0m21:25:47.348528 [debug] [MainThread]: Command end result
[0m21:25:47.434801 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:25:47.445467 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:25:47.454840 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:25:47.455575 [info ] [MainThread]: 
[0m21:25:47.456828 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:25:47.457562 [info ] [MainThread]: 
[0m21:25:47.458658 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:25:47.461350 [debug] [MainThread]: Command `dbt build` succeeded at 21:25:47.461083 after 20.36 seconds
[0m21:25:47.462115 [debug] [MainThread]: Flushing usage events
[0m21:30:32.514270 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:30:32.823051 | 87d75dab-439c-4582-aa70-d005e8fe206f ==============================
[0m21:30:32.823051 [info ] [MainThread]: Running with dbt=1.10.3
[0m21:30:32.825439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select dim_user', 'send_anonymous_usage_stats': 'True'}
[0m21:30:33.864544 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:30:34.322969 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m21:30:35.033045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:30:35.035724 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\dim_user.sql
[0m21:30:36.574628 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:30:36.579234 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:30:36.656372 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:30:36.660653 [info ] [MainThread]: 
[0m21:30:36.661745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:30:36.663121 [info ] [MainThread]: 
[0m21:30:36.664596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:36.666531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:30:37.025849 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:30:37.026394 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:30:37.026759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:37.082890 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.056 seconds
[0m21:30:37.084468 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:30:37.095473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:30:37.105435 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:30:37.106412 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:30:37.107180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:37.108566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:30:37.112472 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:30:37.113230 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:30:37.113650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:37.162799 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m21:30:37.163445 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:30:37.164012 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:30:37.170291 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m21:30:37.170741 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:30:37.171102 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:30:37.172506 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.008 seconds
[0m21:30:37.174316 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:30:37.174888 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:30:37.179725 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m21:30:37.181162 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:30:37.181943 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:30:37.189762 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:37.190208 [debug] [MainThread]: On master: BEGIN
[0m21:30:37.190520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:37.400085 [debug] [MainThread]: SQL status: BEGIN in 0.209 seconds
[0m21:30:37.402022 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:37.403374 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:37.429082 [debug] [MainThread]: SQL status: SELECT 5 in 0.024 seconds
[0m21:30:37.436232 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:37.437682 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:37.438605 [debug] [MainThread]: On master: BEGIN
[0m21:30:37.440302 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:30:37.441219 [debug] [MainThread]: On master: COMMIT
[0m21:30:37.442104 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:37.442877 [debug] [MainThread]: On master: COMMIT
[0m21:30:37.444074 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:37.445003 [debug] [MainThread]: On master: Close
[0m21:30:37.459006 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_user
[0m21:30:37.460522 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_user ................................... [RUN]
[0m21:30:37.462492 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_user'
[0m21:30:37.463550 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_user
[0m21:30:37.495977 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_user"
[0m21:30:37.499671 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_user
[0m21:30:37.613532 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_user"
[0m21:30:37.616184 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:30:37.618242 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: BEGIN
[0m21:30:37.619423 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:30:37.717681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.098 seconds
[0m21:30:37.718858 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:30:37.720029 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */

  
    

  create  table "instacart_db"."public"."dim_user__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_user.sql

-- Tujuan:
-- Membangun dimensi user sederhana berbasis aktivitas order.
-- Fokus pada jumlah order, jeda antar order, dan aktivitas terakhir.

with base as (
    select
        user_id,
        order_number,
        days_gap
    from "instacart_db"."public"."stg_orders"
),

agg as (
    select
        user_id,
        count(*) as total_orders,
        round(avg(days_gap),1 as ) avg_days_between_orders ,
        max(order_number) as last_order_number,
        max(days_gap) as days_since_last_order
    from base
    group by user_id
)

select * from agg
  );
  
[0m21:30:37.731537 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 30:         round(avg(days_gap),1 as ) avg_days_between_orders ,
                                       ^

[0m21:30:37.732717 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: ROLLBACK
[0m21:30:37.734193 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: Close
[0m21:30:37.767420 [debug] [Thread-1 (]: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  syntax error at or near "as"
  LINE 30:         round(avg(days_gap),1 as ) avg_days_between_orders ,
                                         ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:30:37.773985 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.dim_user .......................... [[31mERROR[0m in 0.31s]
[0m21:30:37.776656 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_user
[0m21:30:37.778407 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.dim_user' to be skipped because of status 'error'.  Reason: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  syntax error at or near "as"
  LINE 30:         round(avg(days_gap),1 as ) avg_days_between_orders ,
                                         ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql.
[0m21:30:37.781257 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:30:37.782463 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:30:37.783845 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:30:37.785384 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:30:37.786690 [info ] [Thread-4 (]: 4 of 5 SKIP test relationships_fact_order_items_user_id__user_id__ref_dim_user_  [[33mSKIP[0m]
[0m21:30:37.794010 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:30:37.788434 [info ] [Thread-2 (]: 2 of 5 SKIP test not_null_dim_user_total_orders ................................ [[33mSKIP[0m]
[0m21:30:37.795597 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d' to be skipped because of status 'skipped'. 
[0m21:30:37.797273 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:30:37.790256 [info ] [Thread-1 (]: 5 of 5 SKIP test unique_dim_user_user_id ....................................... [[33mSKIP[0m]
[0m21:30:37.802287 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:30:37.806166 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458' to be skipped because of status 'skipped'. 
[0m21:30:37.808128 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.unique_dim_user_user_id.eff0a2a278' to be skipped because of status 'skipped'. 
[0m21:30:37.792551 [info ] [Thread-3 (]: 3 of 5 SKIP test not_null_dim_user_user_id ..................................... [[33mSKIP[0m]
[0m21:30:37.810324 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:30:37.811581 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3' to be skipped because of status 'skipped'. 
[0m21:30:37.815333 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:37.816382 [debug] [MainThread]: On master: BEGIN
[0m21:30:37.822864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:37.934984 [debug] [MainThread]: SQL status: BEGIN in 0.113 seconds
[0m21:30:37.935825 [debug] [MainThread]: On master: COMMIT
[0m21:30:37.936491 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:37.937089 [debug] [MainThread]: On master: COMMIT
[0m21:30:37.938071 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:37.938744 [debug] [MainThread]: On master: Close
[0m21:30:37.939547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:37.940195 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:30:37.941019 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:30:37.941863 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:30:37.942701 [debug] [MainThread]: Connection 'model.instacart_dbt.dim_user' was properly closed.
[0m21:30:37.943677 [info ] [MainThread]: 
[0m21:30:37.944913 [info ] [MainThread]: Finished running 1 table model, 4 data tests in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m21:30:37.947151 [debug] [MainThread]: Command end result
[0m21:30:38.039141 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:30:38.045726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:30:38.057795 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:30:38.058376 [info ] [MainThread]: 
[0m21:30:38.059103 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:30:38.059901 [info ] [MainThread]: 
[0m21:30:38.061050 [error] [MainThread]: [31mFailure in model dim_user (models\marts\dim\dim_user.sql)[0m
[0m21:30:38.062253 [error] [MainThread]:   Database Error in model dim_user (models\marts\dim\dim_user.sql)
  syntax error at or near "as"
  LINE 30:         round(avg(days_gap),1 as ) avg_days_between_orders ,
                                         ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:30:38.063196 [info ] [MainThread]: 
[0m21:30:38.064493 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:30:38.065431 [info ] [MainThread]: 
[0m21:30:38.066492 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=5
[0m21:30:38.069129 [debug] [MainThread]: Command `dbt build` failed at 21:30:38.068854 after 5.70 seconds
[0m21:30:38.069889 [debug] [MainThread]: Flushing usage events
[0m21:30:54.232510 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:30:54.309105 | 2cc3f243-80fa-4ddf-8738-4fee48f5a51e ==============================
[0m21:30:54.309105 [info ] [MainThread]: Running with dbt=1.10.3
[0m21:30:54.310328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select dim_user', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:30:54.831432 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:30:55.090368 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m21:30:55.501545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:30:55.502672 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\dim_user.sql
[0m21:30:56.337868 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:30:56.342536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:30:56.394566 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:30:56.398609 [info ] [MainThread]: 
[0m21:30:56.399331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:30:56.400063 [info ] [MainThread]: 
[0m21:30:56.400969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:56.402506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:30:56.778239 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:30:56.779011 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:30:56.779630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:56.831387 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.052 seconds
[0m21:30:56.833461 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:30:56.840303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:30:56.846065 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:30:56.846643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:30:56.847008 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:30:56.849079 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:30:56.849673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:56.850139 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:30:56.850771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:56.906900 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m21:30:56.907359 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:30:56.907705 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:30:56.911019 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m21:30:56.911505 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:30:56.911882 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:30:56.913449 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:30:56.914829 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:30:56.915394 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:30:56.918167 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.006 seconds
[0m21:30:56.919904 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:30:56.920934 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:30:56.931188 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:56.931628 [debug] [MainThread]: On master: BEGIN
[0m21:30:56.931946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:56.973187 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m21:30:56.973637 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:56.974021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:56.981334 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m21:30:56.984045 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:56.984609 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:56.984991 [debug] [MainThread]: On master: BEGIN
[0m21:30:56.985773 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:30:56.986126 [debug] [MainThread]: On master: COMMIT
[0m21:30:56.986439 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:56.986744 [debug] [MainThread]: On master: COMMIT
[0m21:30:56.987266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:56.987599 [debug] [MainThread]: On master: Close
[0m21:30:56.992268 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_user
[0m21:30:56.992876 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_user ................................... [RUN]
[0m21:30:56.993753 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_user'
[0m21:30:56.994145 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_user
[0m21:30:57.004952 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_user"
[0m21:30:57.006168 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_user
[0m21:30:57.053700 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_user"
[0m21:30:57.055038 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:30:57.055551 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: BEGIN
[0m21:30:57.055923 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:30:57.100573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m21:30:57.101122 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:30:57.101525 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */

  
    

  create  table "instacart_db"."public"."dim_user__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_user.sql

-- Tujuan:
-- Membangun dimensi user sederhana berbasis aktivitas order.
-- Fokus pada jumlah order, jeda antar order, dan aktivitas terakhir.

with base as (
    select
        user_id,
        order_number,
        days_gap
    from "instacart_db"."public"."stg_orders"
),

agg as (
    select
        user_id,
        count(*) as total_orders,
        round(avg(days_gap),1 ) as avg_days_between_orders ,
        max(order_number) as last_order_number,
        max(days_gap) as days_since_last_order
    from base
    group by user_id
)

select * from agg
  );
  
[0m21:30:57.108198 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 30:         round(avg(days_gap),1 ) as avg_days_between_orders ,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m21:30:57.109030 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: ROLLBACK
[0m21:30:57.109854 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: Close
[0m21:30:57.120955 [debug] [Thread-1 (]: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 30:         round(avg(days_gap),1 ) as avg_days_between_orders ,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:30:57.124573 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.dim_user .......................... [[31mERROR[0m in 0.13s]
[0m21:30:57.125864 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_user
[0m21:30:57.126815 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.dim_user' to be skipped because of status 'error'.  Reason: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 30:         round(avg(days_gap),1 ) as avg_days_between_orders ,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql.
[0m21:30:57.128142 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:30:57.128789 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:30:57.129294 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:30:57.130360 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:30:57.129905 [info ] [Thread-2 (]: 2 of 5 SKIP test not_null_dim_user_total_orders ................................ [[33mSKIP[0m]
[0m21:30:57.131235 [info ] [Thread-1 (]: 5 of 5 SKIP test unique_dim_user_user_id ....................................... [[33mSKIP[0m]
[0m21:30:57.134346 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:30:57.131944 [info ] [Thread-4 (]: 4 of 5 SKIP test relationships_fact_order_items_user_id__user_id__ref_dim_user_  [[33mSKIP[0m]
[0m21:30:57.135316 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:30:57.133560 [info ] [Thread-3 (]: 3 of 5 SKIP test not_null_dim_user_user_id ..................................... [[33mSKIP[0m]
[0m21:30:57.136223 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458' to be skipped because of status 'skipped'. 
[0m21:30:57.136884 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:30:57.137843 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:30:57.139991 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.unique_dim_user_user_id.eff0a2a278' to be skipped because of status 'skipped'. 
[0m21:30:57.142240 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d' to be skipped because of status 'skipped'. 
[0m21:30:57.143085 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3' to be skipped because of status 'skipped'. 
[0m21:30:57.144806 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:57.145344 [debug] [MainThread]: On master: BEGIN
[0m21:30:57.145688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:57.212554 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m21:30:57.213267 [debug] [MainThread]: On master: COMMIT
[0m21:30:57.213777 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:57.214206 [debug] [MainThread]: On master: COMMIT
[0m21:30:57.214726 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:57.215193 [debug] [MainThread]: On master: Close
[0m21:30:57.215772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:57.216475 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:30:57.216960 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:30:57.217382 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:30:57.217835 [debug] [MainThread]: Connection 'model.instacart_dbt.dim_user' was properly closed.
[0m21:30:57.218376 [info ] [MainThread]: 
[0m21:30:57.219115 [info ] [MainThread]: Finished running 1 table model, 4 data tests in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m21:30:57.220533 [debug] [MainThread]: Command end result
[0m21:30:57.280601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:30:57.285618 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:30:57.291597 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:30:57.292078 [info ] [MainThread]: 
[0m21:30:57.292675 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:30:57.293162 [info ] [MainThread]: 
[0m21:30:57.293728 [error] [MainThread]: [31mFailure in model dim_user (models\marts\dim\dim_user.sql)[0m
[0m21:30:57.294290 [error] [MainThread]:   Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 30:         round(avg(days_gap),1 ) as avg_days_between_orders ,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:30:57.294787 [info ] [MainThread]: 
[0m21:30:57.295276 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:30:57.295717 [info ] [MainThread]: 
[0m21:30:57.296387 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=5
[0m21:30:57.298145 [debug] [MainThread]: Command `dbt build` failed at 21:30:57.297980 after 3.14 seconds
[0m21:30:57.298555 [debug] [MainThread]: Flushing usage events
[0m21:31:58.636441 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:31:58.734528 | 5477ab66-5670-4e60-aa1c-46353ed10be9 ==============================
[0m21:31:58.734528 [info ] [MainThread]: Running with dbt=1.10.3
[0m21:31:58.735684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select dim_user', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:59.124271 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:31:59.366574 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m21:31:59.725552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:31:59.726485 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\dim_user.sql
[0m21:32:00.522348 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:32:00.529355 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:32:00.655358 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:32:00.671485 [info ] [MainThread]: 
[0m21:32:00.673787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:00.675660 [info ] [MainThread]: 
[0m21:32:00.678386 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:00.689616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:32:00.978524 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:32:00.979697 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:32:00.980501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:01.047476 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.067 seconds
[0m21:32:01.048786 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:32:01.059062 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:32:01.068051 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:32:01.068538 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:32:01.068852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:01.069645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:32:01.073320 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:32:01.073923 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:32:01.074781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:01.135601 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m21:32:01.136247 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:32:01.136760 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:32:01.143082 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m21:32:01.143528 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:32:01.143866 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:32:01.144394 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m21:32:01.147014 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:32:01.147732 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:32:01.150940 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.007 seconds
[0m21:32:01.153123 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:32:01.153765 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:32:01.167794 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:01.168248 [debug] [MainThread]: On master: BEGIN
[0m21:32:01.168554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:01.215232 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m21:32:01.215685 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:01.216076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:32:01.223370 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m21:32:01.225654 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:01.226211 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:01.226536 [debug] [MainThread]: On master: BEGIN
[0m21:32:01.227078 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:32:01.227386 [debug] [MainThread]: On master: COMMIT
[0m21:32:01.227692 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:01.227968 [debug] [MainThread]: On master: COMMIT
[0m21:32:01.228424 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:01.228719 [debug] [MainThread]: On master: Close
[0m21:32:01.233897 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_user
[0m21:32:01.234540 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_user ................................... [RUN]
[0m21:32:01.235377 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_user'
[0m21:32:01.235771 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_user
[0m21:32:01.247900 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_user"
[0m21:32:01.249733 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_user
[0m21:32:01.297263 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_user"
[0m21:32:01.298550 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:32:01.299086 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: BEGIN
[0m21:32:01.299443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:32:01.349109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m21:32:01.349601 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:32:01.350038 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */

  
    

  create  table "instacart_db"."public"."dim_user__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_user.sql

-- Tujuan:
-- Membangun dimensi pengguna berdasarkan riwayat pemesanan.
-- Fokus pada total order, rata-rata jeda antar order, dan order terakhir.

with base as (
    select
        user_id,
        order_number,
        days_gap
    from "instacart_db"."public"."stg_orders"
),

agg as (
    select
        user_id,

        -- Total jumlah order yang dilakukan user
        count(*) as total_orders,

        -- Rata-rata hari antar order (dibulatkan 1 angka desimal)
        round(avg(days_gap), 1) as avg_days_between_orders,

        -- Nomor order terakhir yang dilakukan user
        max(order_number) as last_order_number,

        -- Jeda hari dari order terakhir yang tercatat
        max(days_gap) as days_since_last_order
    from base
    group by user_id
)

select * from agg
  );
  
[0m21:32:01.351406 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m21:32:01.351881 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: ROLLBACK
[0m21:32:01.352563 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: Close
[0m21:32:01.362584 [debug] [Thread-1 (]: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:32:01.365575 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.dim_user .......................... [[31mERROR[0m in 0.13s]
[0m21:32:01.366642 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_user
[0m21:32:01.367355 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.dim_user' to be skipped because of status 'error'.  Reason: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql.
[0m21:32:01.368474 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:32:01.368933 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:32:01.369388 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:32:01.369990 [info ] [Thread-3 (]: 3 of 5 SKIP test not_null_dim_user_user_id ..................................... [[33mSKIP[0m]
[0m21:32:01.370501 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:32:01.372796 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:32:01.371226 [info ] [Thread-4 (]: 4 of 5 SKIP test relationships_fact_order_items_user_id__user_id__ref_dim_user_  [[33mSKIP[0m]
[0m21:32:01.372131 [info ] [Thread-1 (]: 5 of 5 SKIP test unique_dim_user_user_id ....................................... [[33mSKIP[0m]
[0m21:32:01.376298 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:32:01.375397 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3' to be skipped because of status 'skipped'. 
[0m21:32:01.377060 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:32:01.374153 [info ] [Thread-2 (]: 2 of 5 SKIP test not_null_dim_user_total_orders ................................ [[33mSKIP[0m]
[0m21:32:01.378021 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d' to be skipped because of status 'skipped'. 
[0m21:32:01.379031 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:32:01.381517 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.unique_dim_user_user_id.eff0a2a278' to be skipped because of status 'skipped'. 
[0m21:32:01.383590 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458' to be skipped because of status 'skipped'. 
[0m21:32:01.386085 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:01.386538 [debug] [MainThread]: On master: BEGIN
[0m21:32:01.386875 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:01.445598 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m21:32:01.446051 [debug] [MainThread]: On master: COMMIT
[0m21:32:01.446707 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:01.448119 [debug] [MainThread]: On master: COMMIT
[0m21:32:01.449306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:01.450016 [debug] [MainThread]: On master: Close
[0m21:32:01.450708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:01.451173 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:32:01.451587 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:32:01.451974 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:32:01.452353 [debug] [MainThread]: Connection 'model.instacart_dbt.dim_user' was properly closed.
[0m21:32:01.452859 [info ] [MainThread]: 
[0m21:32:01.453537 [info ] [MainThread]: Finished running 1 table model, 4 data tests in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m21:32:01.454648 [debug] [MainThread]: Command end result
[0m21:32:01.507245 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:32:01.512306 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:32:01.523092 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:32:01.523748 [info ] [MainThread]: 
[0m21:32:01.524519 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:32:01.525179 [info ] [MainThread]: 
[0m21:32:01.526484 [error] [MainThread]: [31mFailure in model dim_user (models\marts\dim\dim_user.sql)[0m
[0m21:32:01.527398 [error] [MainThread]:   Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:32:01.528047 [info ] [MainThread]: 
[0m21:32:01.528792 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:32:01.530029 [info ] [MainThread]: 
[0m21:32:01.531068 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=5
[0m21:32:01.532852 [debug] [MainThread]: Command `dbt build` failed at 21:32:01.532642 after 3.00 seconds
[0m21:32:01.533531 [debug] [MainThread]: Flushing usage events
[0m21:33:59.192698 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:33:59.280356 | 556d1e47-ffe2-482d-bee8-52523189d4fe ==============================
[0m21:33:59.280356 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:33:59.281405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select dim_user', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:33:59.759361 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:34:00.032595 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:34:00.220446 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:34:02.790483 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:34:02.796958 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:34:02.898189 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:34:02.903027 [info ] [MainThread]: 
[0m21:34:02.903723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:34:02.904158 [info ] [MainThread]: 
[0m21:34:02.904834 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:34:02.906087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:34:03.507001 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:34:03.509336 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:34:03.509774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:03.611386 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.101 seconds
[0m21:34:03.614278 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:34:03.630644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:34:03.644485 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:34:03.644939 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:34:03.645261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:03.646618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:34:03.652578 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:34:03.653729 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:34:03.654714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:03.721248 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m21:34:03.722123 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:34:03.722867 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:34:03.738327 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m21:34:03.739729 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:34:03.740389 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:34:03.851568 [debug] [ThreadPool]: SQL status: BEGIN in 0.206 seconds
[0m21:34:03.852514 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:34:03.853312 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:34:03.869882 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.016 seconds
[0m21:34:03.874560 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:34:03.877074 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:34:03.906059 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:03.906786 [debug] [MainThread]: On master: BEGIN
[0m21:34:03.908730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:04.002648 [debug] [MainThread]: SQL status: BEGIN in 0.095 seconds
[0m21:34:04.003413 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:04.004168 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:34:04.022386 [debug] [MainThread]: SQL status: SELECT 5 in 0.017 seconds
[0m21:34:04.027310 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:04.028304 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:04.028860 [debug] [MainThread]: On master: BEGIN
[0m21:34:04.030143 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:34:04.030793 [debug] [MainThread]: On master: COMMIT
[0m21:34:04.031346 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:04.031871 [debug] [MainThread]: On master: COMMIT
[0m21:34:04.032738 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:34:04.033285 [debug] [MainThread]: On master: Close
[0m21:34:04.043382 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_user
[0m21:34:04.044512 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_user ................................... [RUN]
[0m21:34:04.047268 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_user'
[0m21:34:04.048270 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_user
[0m21:34:04.065657 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_user"
[0m21:34:04.067660 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_user
[0m21:34:04.136092 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_user"
[0m21:34:04.137279 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:34:04.138943 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: BEGIN
[0m21:34:04.139465 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:34:04.212297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.073 seconds
[0m21:34:04.213653 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:34:04.214546 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */

  
    

  create  table "instacart_db"."public"."dim_user__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_user.sql

-- Tujuan:
-- Membangun dimensi pengguna berdasarkan riwayat pemesanan.
-- Fokus pada total order, rata-rata jeda antar order, dan order terakhir.

with base as (
    select
        user_id,
        order_number,
        days_gap
    from "instacart_db"."public"."stg_orders"
),

agg as (
    select
        user_id,

        -- Total jumlah order yang dilakukan user
        count(*) as total_orders,

        -- Rata-rata hari antar order (dibulatkan 1 angka desimal)
        round(avg(days_gap), 1) as avg_days_between_orders,

        -- Nomor order terakhir yang dilakukan user
        max(order_number) as last_order_number,

        -- Jeda hari dari order terakhir yang tercatat
        max(days_gap) as days_since_last_order
    from base
    group by user_id
)

select * from agg
  );
  
[0m21:34:04.216758 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m21:34:04.217358 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: ROLLBACK
[0m21:34:04.218276 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: Close
[0m21:34:04.237975 [debug] [Thread-1 (]: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:34:04.241329 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.dim_user .......................... [[31mERROR[0m in 0.19s]
[0m21:34:04.243326 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_user
[0m21:34:04.244549 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.dim_user' to be skipped because of status 'error'.  Reason: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql.
[0m21:34:04.245874 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:34:04.246737 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:34:04.247540 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:34:04.248221 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:34:04.248775 [info ] [Thread-1 (]: 5 of 5 SKIP test unique_dim_user_user_id ....................................... [[33mSKIP[0m]
[0m21:34:04.249396 [info ] [Thread-3 (]: 3 of 5 SKIP test not_null_dim_user_user_id ..................................... [[33mSKIP[0m]
[0m21:34:04.251767 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:34:04.252370 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:34:04.252899 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.unique_dim_user_user_id.eff0a2a278' to be skipped because of status 'skipped'. 
[0m21:34:04.250137 [info ] [Thread-2 (]: 2 of 5 SKIP test not_null_dim_user_total_orders ................................ [[33mSKIP[0m]
[0m21:34:04.253963 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3' to be skipped because of status 'skipped'. 
[0m21:34:04.250981 [info ] [Thread-4 (]: 4 of 5 SKIP test relationships_fact_order_items_user_id__user_id__ref_dim_user_  [[33mSKIP[0m]
[0m21:34:04.255261 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:34:04.255879 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:34:04.256395 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458' to be skipped because of status 'skipped'. 
[0m21:34:04.257173 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d' to be skipped because of status 'skipped'. 
[0m21:34:04.261160 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:04.261678 [debug] [MainThread]: On master: BEGIN
[0m21:34:04.262127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:04.317781 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m21:34:04.318402 [debug] [MainThread]: On master: COMMIT
[0m21:34:04.318837 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:04.319268 [debug] [MainThread]: On master: COMMIT
[0m21:34:04.319925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:34:04.320242 [debug] [MainThread]: On master: Close
[0m21:34:04.320620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:04.320867 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:34:04.321124 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:34:04.321357 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:34:04.321552 [debug] [MainThread]: Connection 'model.instacart_dbt.dim_user' was properly closed.
[0m21:34:04.321825 [info ] [MainThread]: 
[0m21:34:04.322348 [info ] [MainThread]: Finished running 1 table model, 4 data tests in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m21:34:04.325167 [debug] [MainThread]: Command end result
[0m21:34:04.378803 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:34:04.383682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:34:04.394715 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:34:04.395338 [info ] [MainThread]: 
[0m21:34:04.396279 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:34:04.397791 [info ] [MainThread]: 
[0m21:34:04.398652 [error] [MainThread]: [31mFailure in model dim_user (models\marts\dim\dim_user.sql)[0m
[0m21:34:04.399640 [error] [MainThread]:   Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:34:04.400309 [info ] [MainThread]: 
[0m21:34:04.400925 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:34:04.401490 [info ] [MainThread]: 
[0m21:34:04.402148 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=5
[0m21:34:04.403623 [debug] [MainThread]: Command `dbt build` failed at 21:34:04.403455 after 5.29 seconds
[0m21:34:04.404210 [debug] [MainThread]: Flushing usage events
[0m21:35:06.264070 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:35:06.521188 | ed806f12-2b97-43df-a8a0-108376872dae ==============================
[0m21:35:06.521188 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:35:06.524369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select dim_user', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:07.443337 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:35:08.003141 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:35:08.679786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:08.680731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:08.999249 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:35:09.008452 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:35:09.291733 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:35:09.304142 [info ] [MainThread]: 
[0m21:35:09.307939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:09.309277 [info ] [MainThread]: 
[0m21:35:09.311000 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:09.314314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:35:10.228133 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:35:10.229169 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:35:10.229963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:10.350451 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.120 seconds
[0m21:35:10.352464 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:35:10.363727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:35:10.373757 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:35:10.374337 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:35:10.374790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:10.376945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:35:10.382138 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:35:10.382989 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:35:10.383681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:10.451577 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m21:35:10.452153 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:35:10.452604 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:35:10.461184 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m21:35:10.461603 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:35:10.461999 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:35:10.462462 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.009 seconds
[0m21:35:10.463906 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:35:10.464637 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:35:10.468586 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m21:35:10.469934 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:35:10.470575 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:35:10.479143 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:10.479565 [debug] [MainThread]: On master: BEGIN
[0m21:35:10.479874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:10.529490 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m21:35:10.529878 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:10.530222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:10.540034 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m21:35:10.542267 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:10.543407 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:10.543770 [debug] [MainThread]: On master: BEGIN
[0m21:35:10.544440 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:35:10.544757 [debug] [MainThread]: On master: COMMIT
[0m21:35:10.545044 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:10.545301 [debug] [MainThread]: On master: COMMIT
[0m21:35:10.545804 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:35:10.546120 [debug] [MainThread]: On master: Close
[0m21:35:10.550815 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_user
[0m21:35:10.551428 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_user ................................... [RUN]
[0m21:35:10.552250 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_user'
[0m21:35:10.552655 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_user
[0m21:35:10.564306 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_user"
[0m21:35:10.565750 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_user
[0m21:35:10.614505 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_user"
[0m21:35:10.615730 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:35:10.616415 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: BEGIN
[0m21:35:10.616741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:35:10.665523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m21:35:10.666043 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:35:10.666578 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */

  
    

  create  table "instacart_db"."public"."dim_user__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_user.sql

-- Tujuan:
-- Membangun dimensi pengguna berdasarkan riwayat pemesanan.
-- Fokus pada total order, rata-rata jeda antar order, dan order terakhir.

with base as (
    select
        user_id,
        order_number,
        days_gap
    from "instacart_db"."public"."stg_orders"
),

agg as (
    select
        user_id,

        -- Total jumlah order yang dilakukan user
        count(*) as total_orders,

        -- Rata-rata hari antar order (dibulatkan 1 angka desimal)
        round(avg(days_gap), 1) as avg_days_between_orders,

        -- Nomor order terakhir yang dilakukan user
        max(order_number) as last_order_number,

        -- Jeda hari dari order terakhir yang tercatat
        max(days_gap) as days_since_last_order
    from base
    group by user_id
)

select * from agg
  );
  
[0m21:35:10.667922 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m21:35:10.668324 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: ROLLBACK
[0m21:35:10.669035 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: Close
[0m21:35:10.683929 [debug] [Thread-1 (]: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:35:10.688693 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.dim_user .......................... [[31mERROR[0m in 0.13s]
[0m21:35:10.690112 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_user
[0m21:35:10.690831 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.dim_user' to be skipped because of status 'error'.  Reason: Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql.
[0m21:35:10.692013 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:35:10.692474 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:35:10.693046 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:35:10.694979 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:35:10.693655 [info ] [Thread-1 (]: 5 of 5 SKIP test unique_dim_user_user_id ....................................... [[33mSKIP[0m]
[0m21:35:10.696477 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:35:10.694095 [info ] [Thread-4 (]: 4 of 5 SKIP test relationships_fact_order_items_user_id__user_id__ref_dim_user_  [[33mSKIP[0m]
[0m21:35:10.697161 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.unique_dim_user_user_id.eff0a2a278' to be skipped because of status 'skipped'. 
[0m21:35:10.697639 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:35:10.694604 [info ] [Thread-3 (]: 3 of 5 SKIP test not_null_dim_user_user_id ..................................... [[33mSKIP[0m]
[0m21:35:10.698570 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d' to be skipped because of status 'skipped'. 
[0m21:35:10.695572 [info ] [Thread-2 (]: 2 of 5 SKIP test not_null_dim_user_total_orders ................................ [[33mSKIP[0m]
[0m21:35:10.699239 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:35:10.699835 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:35:10.700282 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3' to be skipped because of status 'skipped'. 
[0m21:35:10.700865 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458' to be skipped because of status 'skipped'. 
[0m21:35:10.702473 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:10.702861 [debug] [MainThread]: On master: BEGIN
[0m21:35:10.703115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:10.756407 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m21:35:10.756860 [debug] [MainThread]: On master: COMMIT
[0m21:35:10.757192 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:10.757473 [debug] [MainThread]: On master: COMMIT
[0m21:35:10.758050 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:35:10.758383 [debug] [MainThread]: On master: Close
[0m21:35:10.758782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:10.759030 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:35:10.759282 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:35:10.759910 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:35:10.760200 [debug] [MainThread]: Connection 'model.instacart_dbt.dim_user' was properly closed.
[0m21:35:10.760635 [info ] [MainThread]: 
[0m21:35:10.761410 [info ] [MainThread]: Finished running 1 table model, 4 data tests in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m21:35:10.762718 [debug] [MainThread]: Command end result
[0m21:35:10.814287 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:35:10.817924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:35:10.825856 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:35:10.826428 [info ] [MainThread]: 
[0m21:35:10.827439 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:35:10.828032 [info ] [MainThread]: 
[0m21:35:10.828987 [error] [MainThread]: [31mFailure in model dim_user (models\marts\dim\dim_user.sql)[0m
[0m21:35:10.829498 [error] [MainThread]:   Database Error in model dim_user (models\marts\dim\dim_user.sql)
  function round(double precision, integer) does not exist
  LINE 34:         round(avg(days_gap), 1) as avg_days_between_orders,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:35:10.829986 [info ] [MainThread]: 
[0m21:35:10.830534 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\dim\dim_user.sql
[0m21:35:10.831015 [info ] [MainThread]: 
[0m21:35:10.831508 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=5
[0m21:35:10.832661 [debug] [MainThread]: Command `dbt build` failed at 21:35:10.832531 after 4.77 seconds
[0m21:35:10.833002 [debug] [MainThread]: Flushing usage events
[0m21:35:29.150531 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:35:29.244548 | a954266e-e122-41c6-9c87-a9c691878901 ==============================
[0m21:35:29.244548 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:35:29.245535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select dim_user', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:29.628862 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:35:29.844769 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:35:30.149351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:35:30.150208 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\dim_user.sql
[0m21:35:30.983656 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:35:30.989089 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:35:31.056496 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:35:31.061672 [info ] [MainThread]: 
[0m21:35:31.062358 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:31.062922 [info ] [MainThread]: 
[0m21:35:31.063626 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:31.064974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:35:31.481119 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:35:31.481648 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:35:31.482017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:31.550815 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.069 seconds
[0m21:35:31.552525 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:35:31.563115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:35:31.572566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:35:31.573505 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:35:31.577160 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:35:31.577800 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:35:31.578250 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:35:31.578649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:31.579080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:31.642293 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m21:35:31.642876 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:35:31.643331 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:35:31.649175 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m21:35:31.649962 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:35:31.650280 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:35:31.650777 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m21:35:31.652019 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:35:31.652538 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:35:31.659366 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.009 seconds
[0m21:35:31.661088 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:35:31.661595 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:35:31.671717 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:31.672240 [debug] [MainThread]: On master: BEGIN
[0m21:35:31.672572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:31.724403 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m21:35:31.724932 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:31.725390 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:31.732749 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m21:35:31.735019 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:31.735557 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:31.735881 [debug] [MainThread]: On master: BEGIN
[0m21:35:31.736436 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:35:31.736935 [debug] [MainThread]: On master: COMMIT
[0m21:35:31.738070 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:31.738640 [debug] [MainThread]: On master: COMMIT
[0m21:35:31.739209 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:35:31.739526 [debug] [MainThread]: On master: Close
[0m21:35:31.745374 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_user
[0m21:35:31.745923 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_user ................................... [RUN]
[0m21:35:31.746691 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_user'
[0m21:35:31.747071 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_user
[0m21:35:31.756933 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_user"
[0m21:35:31.758174 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_user
[0m21:35:31.804487 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_user"
[0m21:35:31.805810 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:35:31.806246 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: BEGIN
[0m21:35:31.806568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:35:31.858339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m21:35:31.858930 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:35:31.859452 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */

  
    

  create  table "instacart_db"."public"."dim_user__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_user.sql

-- Tujuan:
-- Membangun dimensi pengguna berdasarkan riwayat pemesanan.
-- Fokus pada total order, rata-rata jeda antar order, dan order terakhir.

with base as (
    select
        user_id,
        order_number,
        days_gap
    from "instacart_db"."public"."stg_orders"
),

agg as (
    select
        user_id,

        -- Total jumlah order yang dilakukan user
        count(*) as total_orders,

        -- Rata-rata hari antar order (dibulatkan 0 angka desimal)
        round(avg(days_gap)::numeric, 0) as avg_days_between_orders,

        -- Nomor order terakhir yang dilakukan user
        max(order_number) as last_order_number,

        -- Jeda hari dari order terakhir yang tercatat
        max(days_gap) as days_since_last_order
    from base
    group by user_id
)

select * from agg
  );
  
[0m21:35:33.440791 [debug] [Thread-1 (]: SQL status: SELECT 206209 in 1.581 seconds
[0m21:35:33.456642 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:35:33.457180 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */
alter table "instacart_db"."public"."dim_user" rename to "dim_user__dbt_backup"
[0m21:35:33.460042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:35:33.465678 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:35:33.466135 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */
alter table "instacart_db"."public"."dim_user__dbt_tmp" rename to "dim_user"
[0m21:35:33.467166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:35:33.488161 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: COMMIT
[0m21:35:33.488735 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:35:33.489115 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: COMMIT
[0m21:35:33.494045 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m21:35:33.499735 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_user__dbt_backup"
[0m21:35:33.505866 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_user"
[0m21:35:33.506814 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_user"} */
drop table if exists "instacart_db"."public"."dim_user__dbt_backup" cascade
[0m21:35:33.514854 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m21:35:33.517689 [debug] [Thread-1 (]: On model.instacart_dbt.dim_user: Close
[0m21:35:33.522637 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.dim_user .............................. [[32mSELECT 206209[0m in 1.77s]
[0m21:35:33.523930 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_user
[0m21:35:33.525318 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:35:33.526049 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:35:33.526485 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:35:33.526893 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:35:33.527363 [info ] [Thread-2 (]: 2 of 5 START test not_null_dim_user_total_orders ............................... [RUN]
[0m21:35:33.527899 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_user_user_id ...................................... [RUN]
[0m21:35:33.529612 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458'
[0m21:35:33.530150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_user, now test.instacart_dbt.unique_dim_user_user_id.eff0a2a278)
[0m21:35:33.530638 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:35:33.528527 [info ] [Thread-4 (]: 4 of 5 START test relationships_fact_order_items_user_id__user_id__ref_dim_user_  [RUN]
[0m21:35:33.531265 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:35:33.546048 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_user_total_orders.ba47536458"
[0m21:35:33.546749 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d'
[0m21:35:33.529054 [info ] [Thread-3 (]: 3 of 5 START test not_null_dim_user_user_id .................................... [RUN]
[0m21:35:33.556277 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_user_user_id.eff0a2a278"
[0m21:35:33.557128 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:35:33.557810 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3'
[0m21:35:33.566752 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d"
[0m21:35:33.567401 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:35:33.575000 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3"
[0m21:35:33.576022 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:35:33.595547 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_user_total_orders.ba47536458"
[0m21:35:33.596366 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:35:33.599016 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_user_user_id.eff0a2a278"
[0m21:35:33.599671 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:35:33.602661 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3"
[0m21:35:33.604546 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_user_total_orders.ba47536458"
[0m21:35:33.605369 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:35:33.605813 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_user_total_orders.ba47536458: BEGIN
[0m21:35:33.608712 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d"
[0m21:35:33.609500 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:35:33.610013 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_user_user_id.eff0a2a278"
[0m21:35:33.610990 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3"
[0m21:35:33.611478 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_user_user_id.eff0a2a278: BEGIN
[0m21:35:33.612160 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3: BEGIN
[0m21:35:33.612667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:33.613092 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:35:33.613644 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d"
[0m21:35:33.614516 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d: BEGIN
[0m21:35:33.615130 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:35:33.692980 [debug] [Thread-2 (]: SQL status: BEGIN in 0.083 seconds
[0m21:35:33.693717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.081 seconds
[0m21:35:33.694304 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_user_total_orders.ba47536458"
[0m21:35:33.694862 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_user_user_id.eff0a2a278"
[0m21:35:33.695432 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_user_total_orders.ba47536458: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_user_total_orders.ba47536458"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from "instacart_db"."public"."dim_user"
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m21:35:33.696049 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_user_user_id.eff0a2a278: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_user_user_id.eff0a2a278"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_user"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:35:33.710072 [debug] [Thread-3 (]: SQL status: BEGIN in 0.097 seconds
[0m21:35:33.710754 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3"
[0m21:35:33.711301 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "instacart_db"."public"."dim_user"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m21:35:33.727098 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.030 seconds
[0m21:35:33.732007 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_user_total_orders.ba47536458: ROLLBACK
[0m21:35:33.732794 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_user_total_orders.ba47536458: Close
[0m21:35:33.734225 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.022 seconds
[0m21:35:33.736390 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3: ROLLBACK
[0m21:35:33.738152 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3: Close
[0m21:35:33.733719 [info ] [Thread-2 (]: 2 of 5 PASS not_null_dim_user_total_orders ..................................... [[32mPASS[0m in 0.20s]
[0m21:35:33.743981 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_user_total_orders.ba47536458
[0m21:35:33.745551 [debug] [Thread-4 (]: SQL status: BEGIN in 0.130 seconds
[0m21:35:33.746311 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d"
[0m21:35:33.746954 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "instacart_db"."public"."dim_user"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:35:33.739352 [info ] [Thread-3 (]: 3 of 5 PASS not_null_dim_user_user_id .......................................... [[32mPASS[0m in 0.18s]
[0m21:35:33.748044 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3
[0m21:35:33.968031 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.271 seconds
[0m21:35:33.970324 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_user_user_id.eff0a2a278: ROLLBACK
[0m21:35:33.971592 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_user_user_id.eff0a2a278: Close
[0m21:35:33.972899 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_user_user_id ............................................ [[32mPASS[0m in 0.44s]
[0m21:35:33.975760 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_user_user_id.eff0a2a278
[0m21:35:52.185425 [debug] [Thread-4 (]: SQL status: SELECT 1 in 18.438 seconds
[0m21:35:52.188988 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d: ROLLBACK
[0m21:35:52.190360 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d: Close
[0m21:35:52.191823 [info ] [Thread-4 (]: 4 of 5 PASS relationships_fact_order_items_user_id__user_id__ref_dim_user_ ..... [[32mPASS[0m in 18.64s]
[0m21:35:52.193083 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d
[0m21:35:52.195541 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:52.196093 [debug] [MainThread]: On master: BEGIN
[0m21:35:52.196523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:52.275779 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m21:35:52.276469 [debug] [MainThread]: On master: COMMIT
[0m21:35:52.276905 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:52.277280 [debug] [MainThread]: On master: COMMIT
[0m21:35:52.277850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:35:52.278244 [debug] [MainThread]: On master: Close
[0m21:35:52.278839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:52.279255 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:35:52.279615 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:35:52.279951 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:35:52.280301 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_dim_user_user_id.eff0a2a278' was properly closed.
[0m21:35:52.280636 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_user_total_orders.ba47536458' was properly closed.
[0m21:35:52.280972 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_user_id__user_id__ref_dim_user_.e94f369e7d' was properly closed.
[0m21:35:52.281333 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_user_user_id.4b202b08a3' was properly closed.
[0m21:35:52.281810 [info ] [MainThread]: 
[0m21:35:52.282505 [info ] [MainThread]: Finished running 1 table model, 4 data tests in 0 hours 0 minutes and 21.22 seconds (21.22s).
[0m21:35:52.284888 [debug] [MainThread]: Command end result
[0m21:35:52.345868 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:35:52.350888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:35:52.362097 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:35:52.363065 [info ] [MainThread]: 
[0m21:35:52.364450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:35:52.365331 [info ] [MainThread]: 
[0m21:35:52.366164 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:35:52.367817 [debug] [MainThread]: Command `dbt build` succeeded at 21:35:52.367596 after 23.30 seconds
[0m21:35:52.368390 [debug] [MainThread]: Flushing usage events
[0m21:38:43.042956 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:38:43.232852 | 4dc7ec8e-1090-4d4c-979e-eb07a1fe1234 ==============================
[0m21:38:43.232852 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:38:43.233702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select dim_time', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:38:43.672375 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:38:44.110485 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:38:44.337967 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading instacart_dbt: marts\dim\schema.yml - Runtime Error
    Syntax error near line 111
    ------------------------------
    108|           Selisih hari dari order sebelumnya (NULL jika ini order pertama)
    109| 
    110|   - name: dim_time
    111|   description: >
    112|     Dimensi waktu berdasarkan kombinasi hari dalam minggu dan jam order.
    113|     Digunakan untuk analisis perilaku waktu pelanggan dan penghubung waktu dalam model fakta.
    114| 
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 6, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 111, column 3
[0m21:38:44.339409 [debug] [MainThread]: Command `dbt build` failed at 21:38:44.339189 after 1.37 seconds
[0m21:38:44.339943 [debug] [MainThread]: Flushing usage events
[0m21:39:33.278462 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:39:33.372403 | 67ded876-51ad-4f15-8c36-7e8262ba0256 ==============================
[0m21:39:33.372403 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:39:33.373444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select dim_time', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:39:33.733423 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:39:33.982332 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:39:34.180213 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading instacart_dbt: marts\dim\schema.yml - Runtime Error
    Syntax error near line 127
    ------------------------------
    124|       - name: order_hour
    125|         description: "Jam saat order dilakukan (0–23)"
    126|         tests: [not_null]
    127|       description: >
    128|         Dimensi waktu berdasarkan kombinasi hari (dow) dan jam (hour) dari data order.
    129|         Menyediakan informasi nama hari dan waktu terformat, serta time_id sebagai surrogate key.
    130| 
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 116, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 127, column 7
[0m21:39:34.182656 [debug] [MainThread]: Command `dbt build` failed at 21:39:34.182485 after 0.98 seconds
[0m21:39:34.183019 [debug] [MainThread]: Flushing usage events
[0m21:44:20.599461 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:44:20.855955 | 2b256179-fc8b-4925-a321-6d41e6ba8038 ==============================
[0m21:44:20.855955 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:44:20.857579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select dim_time', 'send_anonymous_usage_stats': 'True'}
[0m21:44:21.651243 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:44:22.171064 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:44:22.666936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:44:22.668108 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\schema.yml
[0m21:44:22.668955 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\dim_time.sql
[0m21:44:23.651522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:44:23.655556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:44:23.734113 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:44:23.738972 [info ] [MainThread]: 
[0m21:44:23.739611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:44:23.740116 [info ] [MainThread]: 
[0m21:44:23.740800 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:44:23.742094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:44:24.116304 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:44:24.116723 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:44:24.117020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:24.190431 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.073 seconds
[0m21:44:24.191840 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:44:24.202252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:44:24.215867 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:44:24.216852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:44:24.217517 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:44:24.220741 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:44:24.221245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:24.221707 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:44:24.222311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:24.295954 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m21:44:24.297294 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m21:44:24.297864 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:44:24.298540 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:44:24.299268 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:44:24.299904 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:44:24.309644 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m21:44:24.311645 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:44:24.312231 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.011 seconds
[0m21:44:24.314817 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:44:24.315325 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:44:24.315750 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:44:24.325650 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:24.326575 [debug] [MainThread]: On master: BEGIN
[0m21:44:24.326975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:24.381447 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m21:44:24.381935 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:24.382335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:44:24.395266 [debug] [MainThread]: SQL status: SELECT 5 in 0.012 seconds
[0m21:44:24.398917 [debug] [MainThread]: On master: ROLLBACK
[0m21:44:24.399674 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:24.400051 [debug] [MainThread]: On master: BEGIN
[0m21:44:24.400926 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:44:24.401465 [debug] [MainThread]: On master: COMMIT
[0m21:44:24.401753 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:24.402011 [debug] [MainThread]: On master: COMMIT
[0m21:44:24.402475 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:44:24.402863 [debug] [MainThread]: On master: Close
[0m21:44:24.412250 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_time
[0m21:44:24.414372 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_time ................................... [RUN]
[0m21:44:24.415393 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_time'
[0m21:44:24.415803 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_time
[0m21:44:24.426226 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_time"
[0m21:44:24.427445 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_time
[0m21:44:24.478052 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_time"
[0m21:44:24.481031 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:44:24.481648 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: BEGIN
[0m21:44:24.482047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:44:24.532966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m21:44:24.533919 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:44:24.534858 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */

  
    

  create  table "instacart_db"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_time.sql

-- Tujuan:
-- Membangun dimensi waktu dari kombinasi hari dan jam order,
-- digunakan sebagai dimensi waktu granular (harian dan jam) untuk analisis performa waktu.

with base as (

    -- Ambil kombinasi unik hari dan jam order dari staging
    select distinct
        order_day,
        order_hour
    from "instacart_db"."public"."stg_orders"

),

final as (

    select
        -- Surrogate key untuk kombinasi waktu
        md5(cast(coalesce(cast(order_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_hour as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as time_id,

        -- Rename agar lebih konsisten
        order_day        as day_of_week,
        order_hour       as hour_of_day

    from base

)

select * from final
  );
  
[0m21:44:25.321158 [debug] [Thread-1 (]: SQL status: SELECT 168 in 0.786 seconds
[0m21:44:25.331484 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:44:25.331967 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m21:44:25.333918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:44:25.340210 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:44:25.340645 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m21:44:25.341796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:44:25.360033 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:44:25.360499 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:44:25.360843 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:44:25.363662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:44:25.370595 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_time__dbt_backup"
[0m21:44:25.377138 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:44:25.377912 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
drop table if exists "instacart_db"."public"."dim_time__dbt_backup" cascade
[0m21:44:25.387400 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m21:44:25.389851 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: Close
[0m21:44:25.392959 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_time .............................. [[32mSELECT 168[0m in 0.98s]
[0m21:44:25.394025 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_time
[0m21:44:25.395073 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:44:25.397770 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:44:25.398794 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:44:25.399163 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:44:25.397193 [info ] [Thread-2 (]: 2 of 6 START test not_null_dim_time_day_of_week ................................ [RUN]
[0m21:44:25.401152 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878'
[0m21:44:25.401491 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:44:25.417430 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:44:25.398359 [info ] [Thread-4 (]: 4 of 6 START test not_null_dim_time_time_id .................................... [RUN]
[0m21:44:25.418445 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c'
[0m21:44:25.419103 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:44:25.399887 [info ] [Thread-1 (]: 5 of 6 START test unique_dim_time_time_id ...................................... [RUN]
[0m21:44:25.419814 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:44:25.425699 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:44:25.400445 [info ] [Thread-3 (]: 3 of 6 START test not_null_dim_time_hour_of_day ................................ [RUN]
[0m21:44:25.426519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_time, now test.instacart_dbt.unique_dim_time_time_id.0752c025e8)
[0m21:44:25.447461 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:44:25.448800 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138'
[0m21:44:25.449324 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:44:25.450107 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:44:25.456451 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:44:25.460839 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:44:25.461675 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:44:25.463103 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:44:25.464560 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:44:25.467119 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:44:25.467852 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: BEGIN
[0m21:44:25.471086 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:44:25.471826 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:44:25.472318 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:44:25.475130 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:44:25.476251 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:44:25.476854 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: BEGIN
[0m21:44:25.477356 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:44:25.478459 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:44:25.481144 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:44:25.481866 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: BEGIN
[0m21:44:25.482521 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: BEGIN
[0m21:44:25.483130 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:44:25.483755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:25.547321 [debug] [Thread-2 (]: SQL status: BEGIN in 0.075 seconds
[0m21:44:25.548061 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:44:25.548579 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week
from "instacart_db"."public"."dim_time"
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m21:44:25.551132 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:44:25.556483 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: ROLLBACK
[0m21:44:25.557345 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: Close
[0m21:44:25.558278 [info ] [Thread-2 (]: 2 of 6 PASS not_null_dim_time_day_of_week ...................................... [[32mPASS[0m in 0.16s]
[0m21:44:25.566785 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:44:25.576249 [debug] [Thread-4 (]: SQL status: BEGIN in 0.099 seconds
[0m21:44:25.576949 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:44:25.577546 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select time_id
from "instacart_db"."public"."dim_time"
where time_id is null



  
  
      
    ) dbt_internal_test
[0m21:44:25.582028 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:44:25.584958 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: ROLLBACK
[0m21:44:25.586162 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: Close
[0m21:44:25.588029 [info ] [Thread-4 (]: 4 of 6 PASS not_null_dim_time_time_id .......................................... [[32mPASS[0m in 0.17s]
[0m21:44:25.592816 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:44:25.602090 [debug] [Thread-3 (]: SQL status: BEGIN in 0.119 seconds
[0m21:44:25.603098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m21:44:25.603870 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:44:25.604514 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:44:25.605113 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hour_of_day
from "instacart_db"."public"."dim_time"
where hour_of_day is null



  
  
      
    ) dbt_internal_test
[0m21:44:25.605742 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    time_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_time"
where time_id is not null
group by time_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:44:25.608735 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:44:25.611223 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: ROLLBACK
[0m21:44:25.611929 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:44:25.615612 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: ROLLBACK
[0m21:44:25.616374 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: Close
[0m21:44:25.617931 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: Close
[0m21:44:25.617385 [info ] [Thread-3 (]: 3 of 6 PASS not_null_dim_time_hour_of_day ...................................... [[32mPASS[0m in 0.17s]
[0m21:44:25.621005 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:44:25.618852 [info ] [Thread-1 (]: 5 of 6 PASS unique_dim_time_time_id ............................................ [[32mPASS[0m in 0.19s]
[0m21:44:25.623165 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:44:25.624042 [debug] [Thread-2 (]: Began running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:44:25.624719 [info ] [Thread-2 (]: 6 of 6 START test relationships_fact_order_items_time_id__time_id__ref_dim_time_  [RUN]
[0m21:44:25.625583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_time_day_of_week.296786d878, now test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5)
[0m21:44:25.626018 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:44:25.640564 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:44:25.642049 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:44:25.650171 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:44:25.652185 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:44:25.653196 [debug] [Thread-2 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: BEGIN
[0m21:44:25.653716 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:44:25.713082 [debug] [Thread-2 (]: SQL status: BEGIN in 0.059 seconds
[0m21:44:25.714154 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:44:25.714945 [debug] [Thread-2 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select time_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where time_id is not null
),

parent as (
    select time_id as to_field
    from "instacart_db"."public"."dim_time"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:44:30.939132 [debug] [Thread-2 (]: SQL status: SELECT 1 in 5.224 seconds
[0m21:44:30.940635 [debug] [Thread-2 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: ROLLBACK
[0m21:44:30.941638 [debug] [Thread-2 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: Close
[0m21:44:30.942318 [error] [Thread-2 (]: 6 of 6 FAIL 33819106 relationships_fact_order_items_time_id__time_id__ref_dim_time_  [[31mFAIL 33819106[0m in 5.32s]
[0m21:44:30.943187 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:44:30.943906 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' to be skipped because of status 'fail'.  Reason: Got 33819106 results, configured to fail if != 0.
[0m21:44:30.947588 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:30.948305 [debug] [MainThread]: On master: BEGIN
[0m21:44:30.948637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:44:31.007481 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m21:44:31.007858 [debug] [MainThread]: On master: COMMIT
[0m21:44:31.008116 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:31.008346 [debug] [MainThread]: On master: COMMIT
[0m21:44:31.008815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:44:31.009114 [debug] [MainThread]: On master: Close
[0m21:44:31.009492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:31.009750 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:44:31.010030 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:44:31.010236 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:44:31.010432 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_dim_time_time_id.0752c025e8' was properly closed.
[0m21:44:31.010654 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' was properly closed.
[0m21:44:31.010855 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c' was properly closed.
[0m21:44:31.011112 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138' was properly closed.
[0m21:44:31.011435 [info ] [MainThread]: 
[0m21:44:31.011929 [info ] [MainThread]: Finished running 1 table model, 5 data tests in 0 hours 0 minutes and 7.27 seconds (7.27s).
[0m21:44:31.015713 [debug] [MainThread]: Command end result
[0m21:44:31.061817 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:44:31.068479 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:44:31.074838 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:44:31.075451 [info ] [MainThread]: 
[0m21:44:31.076169 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:44:31.076720 [info ] [MainThread]: 
[0m21:44:31.077340 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)[0m
[0m21:44:31.077956 [error] [MainThread]:   Got 33819106 results, configured to fail if != 0
[0m21:44:31.078451 [info ] [MainThread]: 
[0m21:44:31.081375 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:44:31.082376 [info ] [MainThread]: 
[0m21:44:31.083013 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m21:44:31.084360 [debug] [MainThread]: Command `dbt build` failed at 21:44:31.084201 after 10.66 seconds
[0m21:44:31.084718 [debug] [MainThread]: Flushing usage events
[0m21:46:56.383470 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:46:56.570128 | c12e110e-6df8-4f84-9832-7301018662f8 ==============================
[0m21:46:56.570128 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:46:56.571236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select dim_time', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:46:56.998798 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:46:57.334044 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:46:57.758455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:46:57.759026 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:46:58.047640 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:46:58.051972 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:46:58.199704 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:46:58.203949 [info ] [MainThread]: 
[0m21:46:58.204532 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:46:58.205060 [info ] [MainThread]: 
[0m21:46:58.208007 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:46:58.209498 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:46:58.448895 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:46:58.449635 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:46:58.450156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:58.533502 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.083 seconds
[0m21:46:58.534821 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:46:58.543369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:46:58.549714 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:46:58.550249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:46:58.550604 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:46:58.552552 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:46:58.552995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:58.553362 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:46:58.553804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:58.625399 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m21:46:58.626029 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:46:58.626557 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:46:58.632088 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m21:46:58.632719 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:46:58.633198 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:46:58.637199 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.010 seconds
[0m21:46:58.640469 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:46:58.641253 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m21:46:58.641767 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:46:58.644045 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:46:58.645042 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:46:58.659038 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:58.659488 [debug] [MainThread]: On master: BEGIN
[0m21:46:58.659792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:58.719699 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m21:46:58.720123 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:58.720495 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:46:58.732872 [debug] [MainThread]: SQL status: SELECT 5 in 0.012 seconds
[0m21:46:58.735946 [debug] [MainThread]: On master: ROLLBACK
[0m21:46:58.736413 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:58.736707 [debug] [MainThread]: On master: BEGIN
[0m21:46:58.737144 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:46:58.737435 [debug] [MainThread]: On master: COMMIT
[0m21:46:58.737696 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:58.737948 [debug] [MainThread]: On master: COMMIT
[0m21:46:58.738280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:46:58.738551 [debug] [MainThread]: On master: Close
[0m21:46:58.744794 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_time
[0m21:46:58.745421 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_time ................................... [RUN]
[0m21:46:58.746459 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_time'
[0m21:46:58.747103 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_time
[0m21:46:58.771215 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_time"
[0m21:46:58.774259 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_time
[0m21:46:58.827791 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_time"
[0m21:46:58.829103 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:46:58.829648 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: BEGIN
[0m21:46:58.829978 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:46:58.886359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m21:46:58.887010 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:46:58.887569 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */

  
    

  create  table "instacart_db"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_time.sql

-- Tujuan:
-- Membangun dimensi waktu dari kombinasi hari dan jam order,
-- digunakan sebagai dimensi waktu granular (harian dan jam) untuk analisis performa waktu.

with base as (

    -- Ambil kombinasi unik hari dan jam order dari staging
    select distinct
        order_day,
        order_hour
    from "instacart_db"."public"."stg_orders"

),

final as (

    select
        -- Surrogate key untuk kombinasi waktu
        md5(cast(coalesce(cast(order_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_hour as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as time_id,

        -- Rename agar lebih konsisten
        order_day        as day_of_week,
        order_hour       as hour_of_day

    from base

)

select * from final
  );
  
[0m21:46:59.779994 [debug] [Thread-1 (]: SQL status: SELECT 168 in 0.892 seconds
[0m21:46:59.792572 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:46:59.793079 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m21:46:59.795260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:46:59.799197 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:46:59.799597 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m21:46:59.800392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:46:59.821136 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:46:59.821581 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:46:59.823530 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:46:59.825479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:46:59.832663 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_time__dbt_backup"
[0m21:46:59.837762 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:46:59.838224 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
drop table if exists "instacart_db"."public"."dim_time__dbt_backup" cascade
[0m21:46:59.842853 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:46:59.846576 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: Close
[0m21:46:59.850722 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_time .............................. [[32mSELECT 168[0m in 1.10s]
[0m21:46:59.852608 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_time
[0m21:46:59.854252 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:46:59.854886 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:46:59.856775 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:46:59.857580 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:46:59.858200 [info ] [Thread-3 (]: 3 of 6 START test not_null_dim_time_hour_of_day ................................ [RUN]
[0m21:46:59.858754 [info ] [Thread-4 (]: 4 of 6 START test not_null_dim_time_time_id .................................... [RUN]
[0m21:46:59.861183 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138'
[0m21:46:59.859571 [info ] [Thread-1 (]: 5 of 6 START test unique_dim_time_time_id ...................................... [RUN]
[0m21:46:59.862070 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c'
[0m21:46:59.862657 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:46:59.860337 [info ] [Thread-2 (]: 2 of 6 START test not_null_dim_time_day_of_week ................................ [RUN]
[0m21:46:59.863325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_time, now test.instacart_dbt.unique_dim_time_time_id.0752c025e8)
[0m21:46:59.863850 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:46:59.882754 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:46:59.883568 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878'
[0m21:46:59.884179 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:46:59.892268 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:46:59.893204 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:46:59.904948 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:46:59.911961 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:46:59.912666 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:46:59.933318 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:46:59.933822 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:46:59.934287 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:46:59.943393 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:46:59.946840 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:46:59.947374 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:46:59.950258 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:46:59.950880 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:46:59.951698 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: BEGIN
[0m21:46:59.952197 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:46:59.953144 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:46:59.953684 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: BEGIN
[0m21:46:59.954290 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:46:59.954807 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:46:59.955149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:59.957970 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: BEGIN
[0m21:46:59.959659 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:46:59.958754 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: BEGIN
[0m21:46:59.961962 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:47:00.018209 [debug] [Thread-3 (]: SQL status: BEGIN in 0.066 seconds
[0m21:47:00.018876 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:47:00.019381 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hour_of_day
from "instacart_db"."public"."dim_time"
where hour_of_day is null



  
  
      
    ) dbt_internal_test
[0m21:47:00.021198 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:47:00.026978 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: ROLLBACK
[0m21:47:00.027853 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: Close
[0m21:47:00.028806 [info ] [Thread-3 (]: 3 of 6 PASS not_null_dim_time_hour_of_day ...................................... [[32mPASS[0m in 0.17s]
[0m21:47:00.039465 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:47:00.058177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.103 seconds
[0m21:47:00.058886 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:47:00.059462 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    time_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_time"
where time_id is not null
group by time_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:47:00.063180 [debug] [Thread-2 (]: SQL status: BEGIN in 0.103 seconds
[0m21:47:00.064001 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:47:00.064753 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:47:00.067426 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: ROLLBACK
[0m21:47:00.068204 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week
from "instacart_db"."public"."dim_time"
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m21:47:00.068980 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: Close
[0m21:47:00.070444 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:47:00.073856 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: ROLLBACK
[0m21:47:00.075134 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: Close
[0m21:47:00.069904 [info ] [Thread-1 (]: 5 of 6 PASS unique_dim_time_time_id ............................................ [[32mPASS[0m in 0.21s]
[0m21:47:00.078172 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:47:00.080048 [debug] [Thread-4 (]: SQL status: BEGIN in 0.118 seconds
[0m21:47:00.080720 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:47:00.081297 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select time_id
from "instacart_db"."public"."dim_time"
where time_id is null



  
  
      
    ) dbt_internal_test
[0m21:47:00.083583 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:47:00.076181 [info ] [Thread-2 (]: 2 of 6 PASS not_null_dim_time_day_of_week ...................................... [[32mPASS[0m in 0.19s]
[0m21:47:00.086070 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: ROLLBACK
[0m21:47:00.086996 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:47:00.087855 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: Close
[0m21:47:00.089253 [info ] [Thread-4 (]: 4 of 6 PASS not_null_dim_time_time_id .......................................... [[32mPASS[0m in 0.23s]
[0m21:47:00.095306 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:47:00.096914 [debug] [Thread-3 (]: Began running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:47:00.097623 [info ] [Thread-3 (]: 6 of 6 START test relationships_fact_order_items_time_id__time_id__ref_dim_time_  [RUN]
[0m21:47:00.099606 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138, now test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5)
[0m21:47:00.100231 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:47:00.118766 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:47:00.124616 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:47:00.130195 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:47:00.131705 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:47:00.132299 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: BEGIN
[0m21:47:00.132821 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:47:00.192530 [debug] [Thread-3 (]: SQL status: BEGIN in 0.060 seconds
[0m21:47:00.193387 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:47:00.194390 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select time_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where time_id is not null
),

parent as (
    select time_id as to_field
    from "instacart_db"."public"."dim_time"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:47:00.199972 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.fact_order_items" does not exist
LINE 16:     from "instacart_db"."public"."fact_order_items"
                  ^

[0m21:47:00.200519 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: ROLLBACK
[0m21:47:00.201077 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: Close
[0m21:47:00.217245 [debug] [Thread-3 (]: Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:47:00.217796 [error] [Thread-3 (]: 6 of 6 ERROR relationships_fact_order_items_time_id__time_id__ref_dim_time_ .... [[31mERROR[0m in 0.12s]
[0m21:47:00.218694 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:47:00.219286 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql.
[0m21:47:00.221193 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:00.221554 [debug] [MainThread]: On master: BEGIN
[0m21:47:00.221825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:47:00.278630 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m21:47:00.279179 [debug] [MainThread]: On master: COMMIT
[0m21:47:00.279567 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:00.279913 [debug] [MainThread]: On master: COMMIT
[0m21:47:00.280386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:47:00.280764 [debug] [MainThread]: On master: Close
[0m21:47:00.281355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:47:00.281782 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:47:00.282139 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:47:00.282482 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:47:00.282841 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_dim_time_time_id.0752c025e8' was properly closed.
[0m21:47:00.283202 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' was properly closed.
[0m21:47:00.283560 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c' was properly closed.
[0m21:47:00.283891 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878' was properly closed.
[0m21:47:00.284322 [info ] [MainThread]: 
[0m21:47:00.285461 [info ] [MainThread]: Finished running 1 table model, 5 data tests in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m21:47:00.287840 [debug] [MainThread]: Command end result
[0m21:47:00.349661 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:47:00.353538 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:47:00.364216 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:47:00.364678 [info ] [MainThread]: 
[0m21:47:00.365207 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:47:00.365709 [info ] [MainThread]: 
[0m21:47:00.366176 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)[0m
[0m21:47:00.366774 [error] [MainThread]:   Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:47:00.367154 [info ] [MainThread]: 
[0m21:47:00.367560 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:47:00.367922 [info ] [MainThread]: 
[0m21:47:00.368279 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m21:47:00.369698 [debug] [MainThread]: Command `dbt build` failed at 21:47:00.369517 after 4.06 seconds
[0m21:47:00.370195 [debug] [MainThread]: Flushing usage events
[0m21:49:10.574036 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:49:10.710563 | c1a9c284-7c6c-48dd-9519-6045f95da093 ==============================
[0m21:49:10.710563 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:49:10.711634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select dim_time', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:49:11.057652 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:49:11.276326 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:49:11.563451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:49:11.563869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:49:11.770277 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:49:11.774782 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:49:11.927848 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:49:11.934728 [info ] [MainThread]: 
[0m21:49:11.936168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:49:11.936998 [info ] [MainThread]: 
[0m21:49:11.938261 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:49:11.940609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:49:12.445782 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:49:12.446442 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:49:12.446978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:12.524807 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.078 seconds
[0m21:49:12.526086 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:49:12.533223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:49:12.540291 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:49:12.541030 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:49:12.542078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:49:12.542667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:12.547319 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:49:12.548748 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:49:12.551056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:12.620817 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m21:49:12.621224 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:49:12.621536 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:49:12.622169 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m21:49:12.622647 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:49:12.623100 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:49:12.628015 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.006 seconds
[0m21:49:12.629691 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:49:12.630147 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m21:49:12.631192 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:49:12.631561 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:49:12.632063 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:49:12.642768 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:12.643184 [debug] [MainThread]: On master: BEGIN
[0m21:49:12.643466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:12.691849 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m21:49:12.692221 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:12.692541 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:49:12.702838 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m21:49:12.705407 [debug] [MainThread]: On master: ROLLBACK
[0m21:49:12.706025 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:12.706358 [debug] [MainThread]: On master: BEGIN
[0m21:49:12.707073 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:49:12.707384 [debug] [MainThread]: On master: COMMIT
[0m21:49:12.707655 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:12.707916 [debug] [MainThread]: On master: COMMIT
[0m21:49:12.708249 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:49:12.708518 [debug] [MainThread]: On master: Close
[0m21:49:12.713535 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_time
[0m21:49:12.714469 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_time ................................... [RUN]
[0m21:49:12.715446 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_time'
[0m21:49:12.718416 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_time
[0m21:49:12.741655 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_time"
[0m21:49:12.742885 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_time
[0m21:49:12.796244 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_time"
[0m21:49:12.797549 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:49:12.798101 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: BEGIN
[0m21:49:12.798406 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:49:12.846551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m21:49:12.847019 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:49:12.847367 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */

  
    

  create  table "instacart_db"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_time.sql

-- Tujuan:
-- Membangun dimensi waktu dari kombinasi hari dan jam order,
-- digunakan sebagai dimensi waktu granular (harian dan jam) untuk analisis performa waktu.

with base as (

    -- Ambil kombinasi unik hari dan jam order dari staging
    select distinct
        order_day,
        order_hour
    from "instacart_db"."public"."stg_orders"

),

final as (

    select
        -- Surrogate key untuk kombinasi waktu
        md5(cast(coalesce(cast(order_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_hour as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as time_id,

        -- Rename agar lebih konsisten
        order_day        as day_of_week,
        order_hour       as hour_of_day

    from base

)

select * from final
  );
  
[0m21:49:13.461741 [debug] [Thread-1 (]: SQL status: SELECT 168 in 0.614 seconds
[0m21:49:13.472852 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:49:13.473305 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m21:49:13.474037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:49:13.476857 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:49:13.477196 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m21:49:13.477918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:49:13.496581 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:49:13.497072 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:49:13.497422 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:49:13.498845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:49:13.507553 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_time__dbt_backup"
[0m21:49:13.512615 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:49:13.513046 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
drop table if exists "instacart_db"."public"."dim_time__dbt_backup" cascade
[0m21:49:13.518430 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m21:49:13.520974 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: Close
[0m21:49:13.524488 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_time .............................. [[32mSELECT 168[0m in 0.81s]
[0m21:49:13.525622 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_time
[0m21:49:13.526539 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:49:13.526958 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:49:13.527348 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:49:13.527770 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:49:13.528200 [info ] [Thread-4 (]: 4 of 6 START test not_null_dim_time_time_id .................................... [RUN]
[0m21:49:13.528722 [info ] [Thread-1 (]: 5 of 6 START test unique_dim_time_time_id ...................................... [RUN]
[0m21:49:13.529053 [info ] [Thread-3 (]: 3 of 6 START test not_null_dim_time_hour_of_day ................................ [RUN]
[0m21:49:13.530556 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c'
[0m21:49:13.531096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_time, now test.instacart_dbt.unique_dim_time_time_id.0752c025e8)
[0m21:49:13.529722 [info ] [Thread-2 (]: 2 of 6 START test not_null_dim_time_day_of_week ................................ [RUN]
[0m21:49:13.531799 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138'
[0m21:49:13.532301 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:49:13.534190 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:49:13.535240 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878'
[0m21:49:13.535840 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:49:13.547689 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:49:13.556689 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:49:13.557306 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:49:13.561196 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:49:13.568064 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:49:13.569455 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:49:13.577264 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:49:13.606246 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:49:13.610328 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:49:13.611166 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:49:13.613391 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:49:13.614172 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:49:13.614845 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:49:13.618844 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:49:13.619584 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:49:13.620137 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: BEGIN
[0m21:49:13.620800 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:49:13.621515 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: BEGIN
[0m21:49:13.622039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:13.622706 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: BEGIN
[0m21:49:13.623257 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:49:13.623771 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:49:13.624481 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:49:13.625108 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: BEGIN
[0m21:49:13.625892 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:49:13.692700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m21:49:13.693380 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:49:13.693905 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    time_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_time"
where time_id is not null
group by time_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:49:13.696370 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:49:13.701978 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: ROLLBACK
[0m21:49:13.702895 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: Close
[0m21:49:13.721225 [debug] [Thread-4 (]: SQL status: BEGIN in 0.098 seconds
[0m21:49:13.722215 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:49:13.722851 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select time_id
from "instacart_db"."public"."dim_time"
where time_id is null



  
  
      
    ) dbt_internal_test
[0m21:49:13.703988 [info ] [Thread-1 (]: 5 of 6 PASS unique_dim_time_time_id ............................................ [[32mPASS[0m in 0.17s]
[0m21:49:13.725096 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:49:13.725814 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:49:13.728123 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: ROLLBACK
[0m21:49:13.728937 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: Close
[0m21:49:13.729533 [debug] [Thread-2 (]: SQL status: BEGIN in 0.105 seconds
[0m21:49:13.730986 [debug] [Thread-3 (]: SQL status: BEGIN in 0.105 seconds
[0m21:49:13.731496 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:49:13.732037 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:49:13.732840 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week
from "instacart_db"."public"."dim_time"
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m21:49:13.733573 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hour_of_day
from "instacart_db"."public"."dim_time"
where hour_of_day is null



  
  
      
    ) dbt_internal_test
[0m21:49:13.730445 [info ] [Thread-4 (]: 4 of 6 PASS not_null_dim_time_time_id .......................................... [[32mPASS[0m in 0.20s]
[0m21:49:13.736535 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:49:13.737375 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:49:13.740770 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: ROLLBACK
[0m21:49:13.741542 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m21:49:13.744491 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: ROLLBACK
[0m21:49:13.745292 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: Close
[0m21:49:13.746941 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: Close
[0m21:49:13.746394 [info ] [Thread-2 (]: 2 of 6 PASS not_null_dim_time_day_of_week ...................................... [[32mPASS[0m in 0.21s]
[0m21:49:13.749563 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:49:13.747954 [info ] [Thread-3 (]: 3 of 6 PASS not_null_dim_time_hour_of_day ...................................... [[32mPASS[0m in 0.22s]
[0m21:49:13.754571 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:49:13.755613 [debug] [Thread-1 (]: Began running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:49:13.756247 [info ] [Thread-1 (]: 6 of 6 START test relationships_fact_order_items_time_id__time_id__ref_dim_time_  [RUN]
[0m21:49:13.757112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.unique_dim_time_time_id.0752c025e8, now test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5)
[0m21:49:13.757647 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:49:13.771467 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:49:13.772737 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:49:13.776139 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:49:13.777316 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:49:13.777870 [debug] [Thread-1 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: BEGIN
[0m21:49:13.778217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:13.836039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m21:49:13.836536 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:49:13.836901 [debug] [Thread-1 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select time_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where time_id is not null
),

parent as (
    select time_id as to_field
    from "instacart_db"."public"."dim_time"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:49:13.837842 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_order_items" does not exist
LINE 16:     from "instacart_db"."public"."fact_order_items"
                  ^

[0m21:49:13.838665 [debug] [Thread-1 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: ROLLBACK
[0m21:49:13.839272 [debug] [Thread-1 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: Close
[0m21:49:13.847789 [debug] [Thread-1 (]: Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:49:13.848348 [error] [Thread-1 (]: 6 of 6 ERROR relationships_fact_order_items_time_id__time_id__ref_dim_time_ .... [[31mERROR[0m in 0.09s]
[0m21:49:13.849377 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:49:13.850820 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql.
[0m21:49:13.852929 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:13.853316 [debug] [MainThread]: On master: BEGIN
[0m21:49:13.853570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:13.903700 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m21:49:13.904190 [debug] [MainThread]: On master: COMMIT
[0m21:49:13.904501 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:13.904781 [debug] [MainThread]: On master: COMMIT
[0m21:49:13.905477 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:49:13.905850 [debug] [MainThread]: On master: Close
[0m21:49:13.906708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:13.907215 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:49:13.907803 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:49:13.908296 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:49:13.908704 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' was properly closed.
[0m21:49:13.909215 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c' was properly closed.
[0m21:49:13.909624 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138' was properly closed.
[0m21:49:13.910089 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878' was properly closed.
[0m21:49:13.910552 [info ] [MainThread]: 
[0m21:49:13.911043 [info ] [MainThread]: Finished running 1 table model, 5 data tests in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m21:49:13.912729 [debug] [MainThread]: Command end result
[0m21:49:13.962365 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:49:13.967321 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:49:13.975351 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:49:13.975873 [info ] [MainThread]: 
[0m21:49:13.976488 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:49:13.977104 [info ] [MainThread]: 
[0m21:49:13.977843 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)[0m
[0m21:49:13.978400 [error] [MainThread]:   Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:49:13.978908 [info ] [MainThread]: 
[0m21:49:13.979483 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:49:13.979980 [info ] [MainThread]: 
[0m21:49:13.980507 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m21:49:13.981693 [debug] [MainThread]: Command `dbt build` failed at 21:49:13.981567 after 3.48 seconds
[0m21:49:13.982034 [debug] [MainThread]: Flushing usage events
[0m21:50:11.856115 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:50:11.971283 | b5a5003f-9d50-4bde-8172-ed6bf2d210b0 ==============================
[0m21:50:11.971283 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:50:11.972377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select dim_time', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:50:12.359383 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:50:12.620213 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:50:12.935171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:50:12.935628 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:50:13.177121 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:50:13.184571 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:50:13.337046 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:50:13.341785 [info ] [MainThread]: 
[0m21:50:13.342445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:50:13.342980 [info ] [MainThread]: 
[0m21:50:13.343665 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:50:13.344858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:50:13.704052 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:50:13.704483 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:50:13.704807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:13.768045 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.063 seconds
[0m21:50:13.769684 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:50:13.775576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:50:13.784395 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:50:13.785029 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:50:13.785455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:13.786321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:50:13.789003 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:50:13.789544 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:50:13.790002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:13.853892 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m21:50:13.854474 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:50:13.854917 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:50:13.859875 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m21:50:13.860482 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:50:13.860984 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:50:13.861951 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.007 seconds
[0m21:50:13.865449 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:50:13.866703 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:50:13.874306 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m21:50:13.876210 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:50:13.876801 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:50:13.886810 [debug] [MainThread]: Using postgres connection "master"
[0m21:50:13.887270 [debug] [MainThread]: On master: BEGIN
[0m21:50:13.887562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:50:13.937898 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m21:50:13.938338 [debug] [MainThread]: Using postgres connection "master"
[0m21:50:13.938701 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:50:13.945379 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m21:50:13.949641 [debug] [MainThread]: On master: ROLLBACK
[0m21:50:13.950682 [debug] [MainThread]: Using postgres connection "master"
[0m21:50:13.950999 [debug] [MainThread]: On master: BEGIN
[0m21:50:13.951459 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:50:13.951739 [debug] [MainThread]: On master: COMMIT
[0m21:50:13.952014 [debug] [MainThread]: Using postgres connection "master"
[0m21:50:13.952268 [debug] [MainThread]: On master: COMMIT
[0m21:50:13.952625 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:50:13.952873 [debug] [MainThread]: On master: Close
[0m21:50:13.957121 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_time
[0m21:50:13.957717 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_time ................................... [RUN]
[0m21:50:13.958498 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_time'
[0m21:50:13.958961 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_time
[0m21:50:13.986372 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_time"
[0m21:50:13.988240 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_time
[0m21:50:14.039241 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_time"
[0m21:50:14.040561 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:50:14.041272 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: BEGIN
[0m21:50:14.041765 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:50:14.094430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m21:50:14.094924 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:50:14.095293 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */

  
    

  create  table "instacart_db"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_time.sql

-- Tujuan:
-- Membangun dimensi waktu dari kombinasi hari dan jam order,
-- digunakan sebagai dimensi waktu granular (harian dan jam) untuk analisis performa waktu.

with base as (

    -- Ambil kombinasi unik hari dan jam order dari staging
    select distinct
        order_day,
        order_hour
    from "instacart_db"."public"."stg_orders"

),

final as (

    select
        -- Surrogate key untuk kombinasi waktu
        md5(cast(coalesce(cast(order_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_hour as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as time_id,

        -- Rename agar lebih konsisten
        order_day        as day_of_week,
        order_hour       as hour_of_day

    from base

)

select * from final
  );
  
[0m21:50:14.754646 [debug] [Thread-1 (]: SQL status: SELECT 168 in 0.659 seconds
[0m21:50:14.768035 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:50:14.768542 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m21:50:14.769340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:50:14.772134 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:50:14.772475 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m21:50:14.773201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:50:14.793188 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:50:14.793693 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:50:14.794020 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:50:14.795196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:50:14.804761 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_time__dbt_backup"
[0m21:50:14.809913 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:50:14.810391 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
drop table if exists "instacart_db"."public"."dim_time__dbt_backup" cascade
[0m21:50:14.813706 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:50:14.817437 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: Close
[0m21:50:14.820728 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_time .............................. [[32mSELECT 168[0m in 0.86s]
[0m21:50:14.823026 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_time
[0m21:50:14.824308 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:50:14.824801 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:50:14.825205 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:50:14.825563 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:50:14.825946 [info ] [Thread-3 (]: 3 of 6 START test not_null_dim_time_hour_of_day ................................ [RUN]
[0m21:50:14.826568 [info ] [Thread-1 (]: 5 of 6 START test unique_dim_time_time_id ...................................... [RUN]
[0m21:50:14.828086 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138'
[0m21:50:14.827064 [info ] [Thread-4 (]: 4 of 6 START test not_null_dim_time_time_id .................................... [RUN]
[0m21:50:14.828728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_time, now test.instacart_dbt.unique_dim_time_time_id.0752c025e8)
[0m21:50:14.827460 [info ] [Thread-2 (]: 2 of 6 START test not_null_dim_time_day_of_week ................................ [RUN]
[0m21:50:14.829388 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:50:14.832733 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c'
[0m21:50:14.833507 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:50:14.834356 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878'
[0m21:50:14.848714 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:50:14.849492 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:50:14.857238 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:50:14.857850 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:50:14.861336 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:50:14.869828 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:50:14.870875 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:50:14.890215 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:50:14.890700 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:50:14.899239 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:50:14.901297 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:50:14.901863 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: BEGIN
[0m21:50:14.902583 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:50:14.903106 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:50:14.903606 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:50:14.906134 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:50:14.908226 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:50:14.909244 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:50:14.909963 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: BEGIN
[0m21:50:14.910460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:14.911345 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:50:14.911976 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: BEGIN
[0m21:50:14.916344 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:50:14.912635 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:50:14.918143 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: BEGIN
[0m21:50:14.918846 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:50:14.995337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.085 seconds
[0m21:50:14.996008 [debug] [Thread-3 (]: SQL status: BEGIN in 0.092 seconds
[0m21:50:14.996878 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:50:14.997659 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:50:14.998670 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    time_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_time"
where time_id is not null
group by time_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:50:14.999531 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hour_of_day
from "instacart_db"."public"."dim_time"
where hour_of_day is null



  
  
      
    ) dbt_internal_test
[0m21:50:15.002523 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:50:15.007691 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: ROLLBACK
[0m21:50:15.008371 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m21:50:15.010626 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: ROLLBACK
[0m21:50:15.011216 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: Close
[0m21:50:15.012753 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: Close
[0m21:50:15.012222 [info ] [Thread-3 (]: 3 of 6 PASS not_null_dim_time_hour_of_day ...................................... [[32mPASS[0m in 0.18s]
[0m21:50:15.018077 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:50:15.014250 [info ] [Thread-1 (]: 5 of 6 PASS unique_dim_time_time_id ............................................ [[32mPASS[0m in 0.19s]
[0m21:50:15.020435 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:50:15.021109 [debug] [Thread-4 (]: SQL status: BEGIN in 0.105 seconds
[0m21:50:15.021858 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:50:15.022413 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select time_id
from "instacart_db"."public"."dim_time"
where time_id is null



  
  
      
    ) dbt_internal_test
[0m21:50:15.024545 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:50:15.026920 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: ROLLBACK
[0m21:50:15.027720 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: Close
[0m21:50:15.028753 [info ] [Thread-4 (]: 4 of 6 PASS not_null_dim_time_time_id .......................................... [[32mPASS[0m in 0.20s]
[0m21:50:15.037624 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:50:15.039152 [debug] [Thread-2 (]: SQL status: BEGIN in 0.120 seconds
[0m21:50:15.039958 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:50:15.041824 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week
from "instacart_db"."public"."dim_time"
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m21:50:15.044960 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:50:15.048025 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: ROLLBACK
[0m21:50:15.049914 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: Close
[0m21:50:15.051397 [info ] [Thread-2 (]: 2 of 6 PASS not_null_dim_time_day_of_week ...................................... [[32mPASS[0m in 0.22s]
[0m21:50:15.053099 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:50:15.054148 [debug] [Thread-3 (]: Began running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:50:15.054914 [info ] [Thread-3 (]: 6 of 6 START test relationships_fact_order_items_time_id__time_id__ref_dim_time_  [RUN]
[0m21:50:15.056051 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138, now test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5)
[0m21:50:15.056654 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:50:15.072310 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:50:15.073454 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:50:15.076021 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:50:15.077187 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:50:15.077737 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: BEGIN
[0m21:50:15.078074 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:50:15.129676 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m21:50:15.130906 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:50:15.131808 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select time_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where time_id is not null
),

parent as (
    select time_id as to_field
    from "instacart_db"."public"."dim_time"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:50:15.132939 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.fact_order_items" does not exist
LINE 16:     from "instacart_db"."public"."fact_order_items"
                  ^

[0m21:50:15.133567 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: ROLLBACK
[0m21:50:15.134548 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: Close
[0m21:50:15.144580 [debug] [Thread-3 (]: Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:50:15.145140 [error] [Thread-3 (]: 6 of 6 ERROR relationships_fact_order_items_time_id__time_id__ref_dim_time_ .... [[31mERROR[0m in 0.09s]
[0m21:50:15.146091 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:50:15.148315 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql.
[0m21:50:15.150774 [debug] [MainThread]: Using postgres connection "master"
[0m21:50:15.151136 [debug] [MainThread]: On master: BEGIN
[0m21:50:15.151382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:50:15.199399 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m21:50:15.199858 [debug] [MainThread]: On master: COMMIT
[0m21:50:15.200175 [debug] [MainThread]: Using postgres connection "master"
[0m21:50:15.200471 [debug] [MainThread]: On master: COMMIT
[0m21:50:15.201092 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:50:15.201841 [debug] [MainThread]: On master: Close
[0m21:50:15.202294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:15.202549 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:50:15.202868 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:50:15.203118 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:50:15.203364 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_dim_time_time_id.0752c025e8' was properly closed.
[0m21:50:15.203631 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' was properly closed.
[0m21:50:15.203858 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c' was properly closed.
[0m21:50:15.204151 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878' was properly closed.
[0m21:50:15.204688 [info ] [MainThread]: 
[0m21:50:15.205314 [info ] [MainThread]: Finished running 1 table model, 5 data tests in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m21:50:15.207141 [debug] [MainThread]: Command end result
[0m21:50:15.258594 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:50:15.262397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:50:15.270957 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:50:15.271471 [info ] [MainThread]: 
[0m21:50:15.272032 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:50:15.272587 [info ] [MainThread]: 
[0m21:50:15.273294 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)[0m
[0m21:50:15.274053 [error] [MainThread]:   Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:50:15.274561 [info ] [MainThread]: 
[0m21:50:15.275127 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:50:15.275615 [info ] [MainThread]: 
[0m21:50:15.276146 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m21:50:15.277300 [debug] [MainThread]: Command `dbt build` failed at 21:50:15.277184 after 3.51 seconds
[0m21:50:15.277664 [debug] [MainThread]: Flushing usage events
[0m21:51:34.492582 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:51:34.589103 | 9fef7fc4-f79d-4905-a20a-d073d4e3bf90 ==============================
[0m21:51:34.589103 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:51:34.589972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select dim_time', 'send_anonymous_usage_stats': 'True'}
[0m21:51:34.923133 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:51:35.142392 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:51:35.423762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:35.424166 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:35.627534 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:51:35.632088 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:51:35.767290 [info ] [MainThread]: Found 12 models, 5 seeds, 71 data tests, 5 sources, 547 macros
[0m21:51:35.771559 [info ] [MainThread]: 
[0m21:51:35.772262 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:51:35.772788 [info ] [MainThread]: 
[0m21:51:35.773482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:51:35.774654 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:51:36.180582 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:51:36.180980 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:51:36.181255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:36.241117 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.060 seconds
[0m21:51:36.242514 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:51:36.251899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:51:36.257753 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:51:36.258154 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:51:36.258447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:36.259027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:51:36.263904 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:51:36.264548 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:51:36.265189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:36.323696 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m21:51:36.324136 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:51:36.324462 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:51:36.325960 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m21:51:36.327166 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:51:36.327864 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:51:36.332699 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m21:51:36.334104 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:51:36.334762 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:51:36.335244 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.006 seconds
[0m21:51:36.338501 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:51:36.339359 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:51:36.350067 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:36.350477 [debug] [MainThread]: On master: BEGIN
[0m21:51:36.350757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:36.570440 [debug] [MainThread]: SQL status: BEGIN in 0.219 seconds
[0m21:51:36.571380 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:36.572386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:51:36.598882 [debug] [MainThread]: SQL status: SELECT 5 in 0.025 seconds
[0m21:51:36.605009 [debug] [MainThread]: On master: ROLLBACK
[0m21:51:36.606171 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:36.607020 [debug] [MainThread]: On master: BEGIN
[0m21:51:36.608291 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:51:36.609196 [debug] [MainThread]: On master: COMMIT
[0m21:51:36.610542 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:36.612479 [debug] [MainThread]: On master: COMMIT
[0m21:51:36.614065 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:51:36.615028 [debug] [MainThread]: On master: Close
[0m21:51:36.628943 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_time
[0m21:51:36.630508 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_time ................................... [RUN]
[0m21:51:36.632501 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_time'
[0m21:51:36.633718 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_time
[0m21:51:36.830557 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_time"
[0m21:51:36.835893 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_time
[0m21:51:36.916783 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_time"
[0m21:51:36.917988 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:51:36.918461 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: BEGIN
[0m21:51:36.918788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:51:36.967532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m21:51:36.968011 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:51:36.968376 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */

  
    

  create  table "instacart_db"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_time.sql

-- Tujuan:
-- Membangun dimensi waktu dari kombinasi hari dan jam order,
-- digunakan sebagai dimensi waktu granular (harian dan jam) untuk analisis performa waktu.

with base as (

    -- Ambil kombinasi unik hari dan jam order dari staging
    select distinct
        order_day,
        order_hour
    from "instacart_db"."public"."stg_orders"

),

final as (

    select
        -- Surrogate key untuk kombinasi waktu
        md5(cast(coalesce(cast(order_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_hour as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as time_id,

        -- Rename agar lebih konsisten
        order_day        as day_of_week,
        order_hour       as hour_of_day

    from base

)

select * from final
  );
  
[0m21:51:37.574062 [debug] [Thread-1 (]: SQL status: SELECT 168 in 0.605 seconds
[0m21:51:37.585795 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:51:37.586442 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m21:51:37.587380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:51:37.590262 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:51:37.590602 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m21:51:37.591428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:37.610619 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:51:37.611449 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:51:37.611861 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:51:37.613394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:51:37.621388 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_time__dbt_backup"
[0m21:51:37.627499 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:51:37.628098 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
drop table if exists "instacart_db"."public"."dim_time__dbt_backup" cascade
[0m21:51:37.632446 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:51:37.635223 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: Close
[0m21:51:37.638497 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_time .............................. [[32mSELECT 168[0m in 1.00s]
[0m21:51:37.639669 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_time
[0m21:51:37.641035 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:51:37.641465 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:51:37.641861 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:51:37.644066 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:51:37.642315 [info ] [Thread-3 (]: 3 of 6 START test not_null_dim_time_hour_of_day ................................ [RUN]
[0m21:51:37.644892 [info ] [Thread-4 (]: 4 of 6 START test not_null_dim_time_time_id .................................... [RUN]
[0m21:51:37.645839 [info ] [Thread-2 (]: 2 of 6 START test not_null_dim_time_day_of_week ................................ [RUN]
[0m21:51:37.647370 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138'
[0m21:51:37.646589 [info ] [Thread-1 (]: 5 of 6 START test unique_dim_time_time_id ...................................... [RUN]
[0m21:51:37.648232 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c'
[0m21:51:37.648828 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878'
[0m21:51:37.649487 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:51:37.650331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_time, now test.instacart_dbt.unique_dim_time_time_id.0752c025e8)
[0m21:51:37.650886 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:51:37.651373 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:51:37.664240 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:51:37.665068 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:51:37.670132 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:51:37.673627 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:51:37.683623 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:51:37.684908 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:51:37.704295 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:51:37.705334 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:51:37.705958 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:51:37.706504 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:51:37.715290 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:51:37.717629 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:51:37.719664 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:51:37.720743 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:51:37.721249 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: BEGIN
[0m21:51:37.721767 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:51:37.722699 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:51:37.723474 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: BEGIN
[0m21:51:37.723919 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:51:37.724301 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:51:37.724766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:37.725196 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: BEGIN
[0m21:51:37.725583 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: BEGIN
[0m21:51:37.728509 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:51:37.727743 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:51:37.809852 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m21:51:37.810894 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:51:37.811652 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hour_of_day
from "instacart_db"."public"."dim_time"
where hour_of_day is null



  
  
      
    ) dbt_internal_test
[0m21:51:37.814161 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:51:37.819701 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: ROLLBACK
[0m21:51:37.820578 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: Close
[0m21:51:37.821170 [debug] [Thread-2 (]: SQL status: BEGIN in 0.093 seconds
[0m21:51:37.821777 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:51:37.822397 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week
from "instacart_db"."public"."dim_time"
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m21:51:37.825081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.100 seconds
[0m21:51:37.825715 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:51:37.826683 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    time_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_time"
where time_id is not null
group by time_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:51:37.828284 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:51:37.831088 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: ROLLBACK
[0m21:51:37.823370 [info ] [Thread-3 (]: 3 of 6 PASS not_null_dim_time_hour_of_day ...................................... [[32mPASS[0m in 0.18s]
[0m21:51:37.832265 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:51:37.833606 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:51:37.834541 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: Close
[0m21:51:37.836858 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: ROLLBACK
[0m21:51:37.839008 [debug] [Thread-4 (]: SQL status: BEGIN in 0.111 seconds
[0m21:51:37.839573 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: Close
[0m21:51:37.840102 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:51:37.840736 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select time_id
from "instacart_db"."public"."dim_time"
where time_id is null



  
  
      
    ) dbt_internal_test
[0m21:51:37.838362 [info ] [Thread-2 (]: 2 of 6 PASS not_null_dim_time_day_of_week ...................................... [[32mPASS[0m in 0.19s]
[0m21:51:37.843016 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:51:37.844436 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:51:37.848045 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: ROLLBACK
[0m21:51:37.841604 [info ] [Thread-1 (]: 5 of 6 PASS unique_dim_time_time_id ............................................ [[32mPASS[0m in 0.19s]
[0m21:51:37.849325 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:51:37.850144 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: Close
[0m21:51:37.851386 [info ] [Thread-4 (]: 4 of 6 PASS not_null_dim_time_time_id .......................................... [[32mPASS[0m in 0.20s]
[0m21:51:37.852623 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:51:37.853635 [debug] [Thread-3 (]: Began running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:51:37.854275 [info ] [Thread-3 (]: 6 of 6 START test relationships_fact_order_items_time_id__time_id__ref_dim_time_  [RUN]
[0m21:51:37.855564 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138, now test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5)
[0m21:51:37.856144 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:51:37.869802 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:51:37.872066 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:51:37.875156 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:51:37.878526 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:51:37.879272 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: BEGIN
[0m21:51:37.879779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:51:37.928972 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m21:51:37.929460 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m21:51:37.929828 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select time_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where time_id is not null
),

parent as (
    select time_id as to_field
    from "instacart_db"."public"."dim_time"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:51:37.930762 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.fact_order_items" does not exist
LINE 16:     from "instacart_db"."public"."fact_order_items"
                  ^

[0m21:51:37.931224 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: ROLLBACK
[0m21:51:37.932227 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: Close
[0m21:51:37.942177 [debug] [Thread-3 (]: Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:51:37.943086 [error] [Thread-3 (]: 6 of 6 ERROR relationships_fact_order_items_time_id__time_id__ref_dim_time_ .... [[31mERROR[0m in 0.09s]
[0m21:51:37.944840 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m21:51:37.945695 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql.
[0m21:51:37.947432 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:37.947975 [debug] [MainThread]: On master: BEGIN
[0m21:51:37.948278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:51:37.997767 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m21:51:37.998208 [debug] [MainThread]: On master: COMMIT
[0m21:51:37.998503 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:37.998754 [debug] [MainThread]: On master: COMMIT
[0m21:51:37.999357 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:51:37.999694 [debug] [MainThread]: On master: Close
[0m21:51:38.000126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:38.000579 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:51:38.001191 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:51:38.001577 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:51:38.001909 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_dim_time_time_id.0752c025e8' was properly closed.
[0m21:51:38.002266 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' was properly closed.
[0m21:51:38.002581 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c' was properly closed.
[0m21:51:38.002900 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878' was properly closed.
[0m21:51:38.003364 [info ] [MainThread]: 
[0m21:51:38.003981 [info ] [MainThread]: Finished running 1 table model, 5 data tests in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m21:51:38.005962 [debug] [MainThread]: Command end result
[0m21:51:38.054980 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:51:38.059224 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:51:38.067634 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:51:38.068117 [info ] [MainThread]: 
[0m21:51:38.068683 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:51:38.069240 [info ] [MainThread]: 
[0m21:51:38.069843 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)[0m
[0m21:51:38.070438 [error] [MainThread]:   Database Error in test relationships_fact_order_items_time_id__time_id__ref_dim_time_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:51:38.070934 [info ] [MainThread]: 
[0m21:51:38.071452 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_time_id__time_id__ref_dim_time_.sql
[0m21:51:38.071950 [info ] [MainThread]: 
[0m21:51:38.072438 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m21:51:38.073637 [debug] [MainThread]: Command `dbt build` failed at 21:51:38.073511 after 3.65 seconds
[0m21:51:38.073972 [debug] [MainThread]: Flushing usage events
[0m21:52:43.719860 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 21:52:43.831379 | c5a9dbc3-9506-4b5d-b8bf-24c2c84cd4dd ==============================
[0m21:52:43.831379 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:52:43.832311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select dim_time', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:52:44.256149 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:52:44.542051 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:52:44.868055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:52:44.869081 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\fact\schema.yml
[0m21:52:45.827281 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:52:45.838768 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:52:45.913269 [info ] [MainThread]: Found 12 models, 5 seeds, 70 data tests, 5 sources, 547 macros
[0m21:52:45.917678 [info ] [MainThread]: 
[0m21:52:45.918376 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:52:45.919065 [info ] [MainThread]: 
[0m21:52:45.919953 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:52:45.921402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m21:52:46.226104 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m21:52:46.226675 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m21:52:46.227091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:46.304223 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.077 seconds
[0m21:52:46.306906 [debug] [ThreadPool]: On list_instacart_db: Close
[0m21:52:46.316686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m21:52:46.325386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m21:52:46.326419 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:52:46.330763 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:52:46.331832 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m21:52:46.332260 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m21:52:46.332992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:46.333500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:46.410444 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m21:52:46.411102 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m21:52:46.411659 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:52:46.420080 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.008 seconds
[0m21:52:46.422596 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m21:52:46.423894 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m21:52:46.430201 [debug] [ThreadPool]: SQL status: BEGIN in 0.097 seconds
[0m21:52:46.430661 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m21:52:46.430976 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:52:46.437954 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m21:52:46.439305 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m21:52:46.440519 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m21:52:46.450082 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:46.450878 [debug] [MainThread]: On master: BEGIN
[0m21:52:46.451229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:52:46.605334 [debug] [MainThread]: SQL status: BEGIN in 0.154 seconds
[0m21:52:46.605754 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:46.606104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:52:46.616602 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m21:52:46.618708 [debug] [MainThread]: On master: ROLLBACK
[0m21:52:46.619302 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:46.620085 [debug] [MainThread]: On master: BEGIN
[0m21:52:46.620618 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:52:46.620897 [debug] [MainThread]: On master: COMMIT
[0m21:52:46.621146 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:46.621392 [debug] [MainThread]: On master: COMMIT
[0m21:52:46.621869 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:52:46.622155 [debug] [MainThread]: On master: Close
[0m21:52:46.629577 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_time
[0m21:52:46.630320 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_time ................................... [RUN]
[0m21:52:46.631289 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_time'
[0m21:52:46.631938 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_time
[0m21:52:46.659973 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_time"
[0m21:52:46.662118 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_time
[0m21:52:46.715242 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_time"
[0m21:52:46.717160 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:52:46.717726 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: BEGIN
[0m21:52:46.718087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:52:46.777635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m21:52:46.778548 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:52:46.779122 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */

  
    

  create  table "instacart_db"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_time.sql

-- Tujuan:
-- Membangun dimensi waktu dari kombinasi hari dan jam order,
-- digunakan sebagai dimensi waktu granular (harian dan jam) untuk analisis performa waktu.

with base as (

    -- Ambil kombinasi unik hari dan jam order dari staging
    select distinct
        order_day,
        order_hour
    from "instacart_db"."public"."stg_orders"

),

final as (

    select
        -- Surrogate key untuk kombinasi waktu
        md5(cast(coalesce(cast(order_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_hour as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as time_id,

        -- Rename agar lebih konsisten
        order_day        as day_of_week,
        order_hour       as hour_of_day

    from base

)

select * from final
  );
  
[0m21:52:47.548116 [debug] [Thread-1 (]: SQL status: SELECT 168 in 0.768 seconds
[0m21:52:47.563926 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:52:47.564651 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m21:52:47.566035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:52:47.571796 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:52:47.572317 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
alter table "instacart_db"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m21:52:47.574367 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:52:47.599359 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:52:47.599835 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:52:47.600577 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: COMMIT
[0m21:52:47.602086 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:52:47.616788 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_time__dbt_backup"
[0m21:52:47.622136 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_time"
[0m21:52:47.622599 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_time"} */
drop table if exists "instacart_db"."public"."dim_time__dbt_backup" cascade
[0m21:52:47.627962 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:52:47.631027 [debug] [Thread-1 (]: On model.instacart_dbt.dim_time: Close
[0m21:52:47.633853 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.dim_time .............................. [[32mSELECT 168[0m in 1.00s]
[0m21:52:47.635125 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_time
[0m21:52:47.636171 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:52:47.636654 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:52:47.637047 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:52:47.637408 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:52:47.637838 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_time_time_id ...................................... [RUN]
[0m21:52:47.638240 [info ] [Thread-3 (]: 3 of 5 START test not_null_dim_time_hour_of_day ................................ [RUN]
[0m21:52:47.641656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_time, now test.instacart_dbt.unique_dim_time_time_id.0752c025e8)
[0m21:52:47.642963 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138'
[0m21:52:47.638675 [info ] [Thread-4 (]: 4 of 5 START test not_null_dim_time_time_id .................................... [RUN]
[0m21:52:47.643647 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:52:47.639130 [info ] [Thread-2 (]: 2 of 5 START test not_null_dim_time_day_of_week ................................ [RUN]
[0m21:52:47.644157 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:52:47.644685 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c'
[0m21:52:47.650996 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:52:47.651642 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878'
[0m21:52:47.665082 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:52:47.665715 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:52:47.666407 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:52:47.671677 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:52:47.679035 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:52:47.680035 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:52:47.680609 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:52:47.708997 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:52:47.710704 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:52:47.711626 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:52:47.712595 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:52:47.715615 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:52:47.719155 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:52:47.720426 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:52:47.721121 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:52:47.721691 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: BEGIN
[0m21:52:47.722352 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: BEGIN
[0m21:52:47.724119 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:52:47.725434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:47.726293 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:52:47.726687 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:52:47.727092 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: BEGIN
[0m21:52:47.727657 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: BEGIN
[0m21:52:47.728362 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:52:47.728945 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:52:47.805021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m21:52:47.805696 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"
[0m21:52:47.807515 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_time_time_id.0752c025e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    time_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_time"
where time_id is not null
group by time_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:52:47.810755 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:52:47.816714 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: ROLLBACK
[0m21:52:47.817571 [debug] [Thread-1 (]: On test.instacart_dbt.unique_dim_time_time_id.0752c025e8: Close
[0m21:52:47.818554 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_time_time_id ............................................ [[32mPASS[0m in 0.18s]
[0m21:52:47.826414 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_time_time_id.0752c025e8
[0m21:52:47.834715 [debug] [Thread-3 (]: SQL status: BEGIN in 0.108 seconds
[0m21:52:47.835404 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"
[0m21:52:47.835931 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hour_of_day
from "instacart_db"."public"."dim_time"
where hour_of_day is null



  
  
      
    ) dbt_internal_test
[0m21:52:47.837828 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:52:47.841044 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: ROLLBACK
[0m21:52:47.842735 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138: Close
[0m21:52:47.844123 [info ] [Thread-3 (]: 3 of 5 PASS not_null_dim_time_hour_of_day ...................................... [[32mPASS[0m in 0.20s]
[0m21:52:47.846675 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138
[0m21:52:47.848027 [debug] [Thread-2 (]: SQL status: BEGIN in 0.120 seconds
[0m21:52:47.848822 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"
[0m21:52:47.849410 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_day_of_week.296786d878"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week
from "instacart_db"."public"."dim_time"
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m21:52:47.851569 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:52:47.853991 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: ROLLBACK
[0m21:52:47.854737 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_time_day_of_week.296786d878: Close
[0m21:52:47.855640 [info ] [Thread-2 (]: 2 of 5 PASS not_null_dim_time_day_of_week ...................................... [[32mPASS[0m in 0.20s]
[0m21:52:47.860310 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_time_day_of_week.296786d878
[0m21:52:47.862053 [debug] [Thread-4 (]: SQL status: BEGIN in 0.133 seconds
[0m21:52:47.862863 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"
[0m21:52:47.863548 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select time_id
from "instacart_db"."public"."dim_time"
where time_id is null



  
  
      
    ) dbt_internal_test
[0m21:52:47.866247 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:52:47.868413 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: ROLLBACK
[0m21:52:47.869314 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c: Close
[0m21:52:47.870400 [info ] [Thread-4 (]: 4 of 5 PASS not_null_dim_time_time_id .......................................... [[32mPASS[0m in 0.23s]
[0m21:52:47.871651 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c
[0m21:52:47.876662 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:47.877371 [debug] [MainThread]: On master: BEGIN
[0m21:52:47.877808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:52:47.947386 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m21:52:47.948038 [debug] [MainThread]: On master: COMMIT
[0m21:52:47.948502 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:47.948900 [debug] [MainThread]: On master: COMMIT
[0m21:52:47.949512 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:52:47.949994 [debug] [MainThread]: On master: Close
[0m21:52:47.950606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:47.950984 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m21:52:47.951367 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m21:52:47.951716 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m21:52:47.952066 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_dim_time_time_id.0752c025e8' was properly closed.
[0m21:52:47.952414 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_hour_of_day.6e43b14138' was properly closed.
[0m21:52:47.952744 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_time_id.6bb481dd5c' was properly closed.
[0m21:52:47.953095 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_time_day_of_week.296786d878' was properly closed.
[0m21:52:47.953597 [info ] [MainThread]: 
[0m21:52:47.954190 [info ] [MainThread]: Finished running 1 table model, 4 data tests in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m21:52:47.956231 [debug] [MainThread]: Command end result
[0m21:52:48.014865 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m21:52:48.018773 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m21:52:48.028936 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m21:52:48.029560 [info ] [MainThread]: 
[0m21:52:48.030284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:52:48.030894 [info ] [MainThread]: 
[0m21:52:48.031619 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:52:48.032936 [debug] [MainThread]: Command `dbt build` succeeded at 21:52:48.032806 after 4.40 seconds
[0m21:52:48.033507 [debug] [MainThread]: Flushing usage events
[0m22:05:32.228920 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:05:32.375012 | ad5cba7e-2240-4895-8f32-dc9c5d54c0c7 ==============================
[0m22:05:32.375012 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:05:32.375888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --select dim_order', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:32.872939 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:05:33.181541 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:05:33.508777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:05:33.510073 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\schema.yml
[0m22:05:34.313733 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:05:34.317445 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:05:34.384971 [info ] [MainThread]: Found 12 models, 5 seeds, 70 data tests, 5 sources, 547 macros
[0m22:05:34.391370 [info ] [MainThread]: 
[0m22:05:34.392278 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:34.392777 [info ] [MainThread]: 
[0m22:05:34.393453 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:34.394623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:05:34.882562 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:05:34.883342 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:05:34.884042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:34.969118 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.085 seconds
[0m22:05:34.971850 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:05:34.981307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:05:34.987605 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:05:34.989762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:05:34.990382 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:05:34.994953 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:05:34.995681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:34.996185 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:05:34.997047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:35.055369 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m22:05:35.056451 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:05:35.057096 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:05:35.064033 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.006 seconds
[0m22:05:35.066128 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:05:35.066724 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:05:35.071274 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m22:05:35.072335 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:05:35.073089 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:05:35.080628 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m22:05:35.081959 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:05:35.082587 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:05:35.089903 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:35.090367 [debug] [MainThread]: On master: BEGIN
[0m22:05:35.090678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:35.139004 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m22:05:35.139556 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:35.140041 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:35.150063 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m22:05:35.152194 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:35.152785 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:35.153098 [debug] [MainThread]: On master: BEGIN
[0m22:05:35.153816 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:05:35.154124 [debug] [MainThread]: On master: COMMIT
[0m22:05:35.154390 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:35.154923 [debug] [MainThread]: On master: COMMIT
[0m22:05:35.156236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:35.156718 [debug] [MainThread]: On master: Close
[0m22:05:35.162877 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_order
[0m22:05:35.163478 [info ] [Thread-1 (]: 1 of 8 START sql table model public.dim_order .................................. [RUN]
[0m22:05:35.164314 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_order'
[0m22:05:35.164727 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_order
[0m22:05:35.173897 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_order"
[0m22:05:35.175273 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_order
[0m22:05:35.225480 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_order"
[0m22:05:35.226960 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:05:35.227408 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: BEGIN
[0m22:05:35.227756 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:35.277349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m22:05:35.277903 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:05:35.278282 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */

  
    

  create  table "instacart_db"."public"."dim_order__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_order.sql

-- Tujuan:
-- Membuat dimensi order lengkap dengan informasi waktu dan urutan order.
-- Digunakan sebagai FK di tabel fakta dan berguna untuk analisis behavior per transaksi/order.

with source as (

    -- Ambil dari hasil staging orders
    select * 
    from "instacart_db"."public"."stg_orders"

),

final as (

    select
        order_id,
        user_id,
        order_number,
        order_day_of_week,
        order_hour,
        days_since_prior_order
    from source

)

-- Output akhir: satu baris per order
select * from final
  );
  
[0m22:05:35.281331 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_day_of_week" does not exist
LINE 32:         order_day_of_week,
                 ^

[0m22:05:35.281811 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: ROLLBACK
[0m22:05:35.282495 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: Close
[0m22:05:35.296245 [debug] [Thread-1 (]: Database Error in model dim_order (models\marts\dim\dim_order.sql)
  column "order_day_of_week" does not exist
  LINE 32:         order_day_of_week,
                   ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_order.sql
[0m22:05:35.298836 [error] [Thread-1 (]: 1 of 8 ERROR creating sql table model public.dim_order ......................... [[31mERROR[0m in 0.13s]
[0m22:05:35.299825 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_order
[0m22:05:35.300530 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.dim_order' to be skipped because of status 'error'.  Reason: Database Error in model dim_order (models\marts\dim\dim_order.sql)
  column "order_day_of_week" does not exist
  LINE 32:         order_day_of_week,
                   ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_order.sql.
[0m22:05:35.302061 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:05:35.302493 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:05:35.302849 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:05:35.303540 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:05:35.303219 [info ] [Thread-3 (]: 3 of 8 SKIP test not_null_dim_order_order_hour ................................. [[33mSKIP[0m]
[0m22:05:35.304045 [info ] [Thread-4 (]: 4 of 8 SKIP test not_null_dim_order_order_id ................................... [[33mSKIP[0m]
[0m22:05:35.306405 [info ] [Thread-2 (]: 2 of 8 SKIP test not_null_dim_order_order_day .................................. [[33mSKIP[0m]
[0m22:05:35.308142 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:05:35.307285 [info ] [Thread-1 (]: 5 of 8 SKIP test not_null_dim_order_order_number ............................... [[33mSKIP[0m]
[0m22:05:35.308842 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:05:35.309342 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:05:35.309917 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:05:35.310453 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:05:35.310854 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06' to be skipped because of status 'skipped'. 
[0m22:05:35.311400 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:05:35.311956 [debug] [Thread-2 (]: Began running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:05:35.312485 [info ] [Thread-3 (]: 6 of 8 SKIP test not_null_dim_order_user_id .................................... [[33mSKIP[0m]
[0m22:05:35.313378 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e' to be skipped because of status 'skipped'. 
[0m22:05:35.313905 [info ] [Thread-4 (]: 7 of 8 SKIP test relationships_fact_order_items_order_id__order_id__ref_dim_order_  [[33mSKIP[0m]
[0m22:05:35.315171 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:05:35.315653 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f' to be skipped because of status 'skipped'. 
[0m22:05:35.316176 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:05:35.314656 [info ] [Thread-2 (]: 8 of 8 SKIP test unique_dim_order_order_id ..................................... [[33mSKIP[0m]
[0m22:05:35.316875 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1' to be skipped because of status 'skipped'. 
[0m22:05:35.317473 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:05:35.317953 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_user_id.451d11f593' to be skipped because of status 'skipped'. 
[0m22:05:35.318519 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace' to be skipped because of status 'skipped'. 
[0m22:05:35.318841 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.unique_dim_order_order_id.47b02e7daa' to be skipped because of status 'skipped'. 
[0m22:05:35.320233 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:35.320604 [debug] [MainThread]: On master: BEGIN
[0m22:05:35.320877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:35.372844 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m22:05:35.373381 [debug] [MainThread]: On master: COMMIT
[0m22:05:35.373732 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:35.374000 [debug] [MainThread]: On master: COMMIT
[0m22:05:35.374589 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:35.374925 [debug] [MainThread]: On master: Close
[0m22:05:35.375325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:35.375583 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:05:35.375864 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:05:35.376136 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:05:35.376420 [debug] [MainThread]: Connection 'model.instacart_dbt.dim_order' was properly closed.
[0m22:05:35.376765 [info ] [MainThread]: 
[0m22:05:35.377398 [info ] [MainThread]: Finished running 1 table model, 7 data tests in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m22:05:35.378703 [debug] [MainThread]: Command end result
[0m22:05:35.430516 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:05:35.434448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:05:35.442698 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:05:35.443910 [info ] [MainThread]: 
[0m22:05:35.444663 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:05:35.445309 [info ] [MainThread]: 
[0m22:05:35.445934 [error] [MainThread]: [31mFailure in model dim_order (models\marts\dim\dim_order.sql)[0m
[0m22:05:35.446622 [error] [MainThread]:   Database Error in model dim_order (models\marts\dim\dim_order.sql)
  column "order_day_of_week" does not exist
  LINE 32:         order_day_of_week,
                   ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_order.sql
[0m22:05:35.447079 [info ] [MainThread]: 
[0m22:05:35.447641 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\dim\dim_order.sql
[0m22:05:35.448123 [info ] [MainThread]: 
[0m22:05:35.448610 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=7 NO-OP=0 TOTAL=8
[0m22:05:35.449773 [debug] [MainThread]: Command `dbt build` failed at 22:05:35.449654 after 3.29 seconds
[0m22:05:35.450105 [debug] [MainThread]: Flushing usage events
[0m22:05:51.929326 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:05:52.106635 | ddec7965-0b23-46c2-a267-29d73586888d ==============================
[0m22:05:52.106635 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:05:52.108734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select dim_order', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.007890 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:05:53.565327 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:05:53.927220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:05:53.928629 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\dim_order.sql
[0m22:05:54.741592 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:05:54.747048 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:05:54.815670 [info ] [MainThread]: Found 12 models, 5 seeds, 70 data tests, 5 sources, 547 macros
[0m22:05:54.822091 [info ] [MainThread]: 
[0m22:05:54.822892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:54.823514 [info ] [MainThread]: 
[0m22:05:54.824207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:54.825457 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:05:55.069075 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:05:55.069508 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:05:55.069808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.129633 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.060 seconds
[0m22:05:55.131057 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:05:55.140147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:05:55.146922 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:05:55.147503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:05:55.147867 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:05:55.150072 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:05:55.150499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.150847 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:05:55.151391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.218250 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m22:05:55.218874 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:05:55.219378 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:05:55.228290 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:05:55.230418 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:05:55.231162 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:05:55.231572 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m22:05:55.231960 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:05:55.232628 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:05:55.240868 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.008 seconds
[0m22:05:55.243004 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:05:55.243621 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:05:55.260519 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:55.261064 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.261525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:55.313862 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m22:05:55.314491 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:55.314851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:55.323933 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m22:05:55.326197 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:55.326825 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:55.327194 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.327750 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:05:55.328166 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.328616 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:55.329117 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.329862 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:55.330433 [debug] [MainThread]: On master: Close
[0m22:05:55.335825 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_order
[0m22:05:55.336489 [info ] [Thread-1 (]: 1 of 8 START sql table model public.dim_order .................................. [RUN]
[0m22:05:55.339155 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_order'
[0m22:05:55.339908 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_order
[0m22:05:55.348123 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_order"
[0m22:05:55.349338 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_order
[0m22:05:55.399640 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_order"
[0m22:05:55.400849 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:05:55.401565 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: BEGIN
[0m22:05:55.402101 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:55.456845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m22:05:55.457555 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:05:55.458173 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */

  
    

  create  table "instacart_db"."public"."dim_order__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_order.sql

-- Tujuan:
-- Dimensi order yang menyimpan informasi urutan, waktu, dan jeda antar order.
-- Menggunakan nama kolom hasil dari stg_orders (tanpa rename ulang).

selects
    order_id,
    user_id,
    order_number,
    order_day,
    order_hour,
    days_gap
from "instacart_db"."public"."stg_orders"
  );
  
[0m22:05:55.461512 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "selects"
LINE 18: selects
         ^

[0m22:05:55.462198 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: ROLLBACK
[0m22:05:55.462846 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: Close
[0m22:05:55.476271 [debug] [Thread-1 (]: Database Error in model dim_order (models\marts\dim\dim_order.sql)
  syntax error at or near "selects"
  LINE 18: selects
           ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_order.sql
[0m22:05:55.479202 [error] [Thread-1 (]: 1 of 8 ERROR creating sql table model public.dim_order ......................... [[31mERROR[0m in 0.14s]
[0m22:05:55.480124 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_order
[0m22:05:55.480873 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.dim_order' to be skipped because of status 'error'.  Reason: Database Error in model dim_order (models\marts\dim\dim_order.sql)
  syntax error at or near "selects"
  LINE 18: selects
           ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_order.sql.
[0m22:05:55.482380 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:05:55.482856 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:05:55.483240 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:05:55.483617 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:05:55.484008 [info ] [Thread-1 (]: 5 of 8 SKIP test not_null_dim_order_order_number ............................... [[33mSKIP[0m]
[0m22:05:55.484527 [info ] [Thread-3 (]: 3 of 8 SKIP test not_null_dim_order_order_hour ................................. [[33mSKIP[0m]
[0m22:05:55.485414 [info ] [Thread-4 (]: 4 of 8 SKIP test not_null_dim_order_order_id ................................... [[33mSKIP[0m]
[0m22:05:55.486347 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:05:55.488380 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:05:55.485851 [info ] [Thread-2 (]: 2 of 8 SKIP test not_null_dim_order_order_day .................................. [[33mSKIP[0m]
[0m22:05:55.489546 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:05:55.490387 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:05:55.491022 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1' to be skipped because of status 'skipped'. 
[0m22:05:55.491508 [debug] [Thread-3 (]: Began running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:05:55.491979 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:05:55.492477 [debug] [Thread-4 (]: Began running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:05:55.493457 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06' to be skipped because of status 'skipped'. 
[0m22:05:55.492983 [info ] [Thread-1 (]: 6 of 8 SKIP test not_null_dim_order_user_id .................................... [[33mSKIP[0m]
[0m22:05:55.494397 [info ] [Thread-3 (]: 7 of 8 SKIP test relationships_fact_order_items_order_id__order_id__ref_dim_order_  [[33mSKIP[0m]
[0m22:05:55.495571 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e' to be skipped because of status 'skipped'. 
[0m22:05:55.495166 [info ] [Thread-4 (]: 8 of 8 SKIP test unique_dim_order_order_id ..................................... [[33mSKIP[0m]
[0m22:05:55.496136 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:05:55.496565 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:05:55.496987 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f' to be skipped because of status 'skipped'. 
[0m22:05:55.497415 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:05:55.497980 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_user_id.451d11f593' to be skipped because of status 'skipped'. 
[0m22:05:55.498455 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace' to be skipped because of status 'skipped'. 
[0m22:05:55.498807 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.unique_dim_order_order_id.47b02e7daa' to be skipped because of status 'skipped'. 
[0m22:05:55.500341 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:55.500736 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.501032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:55.559999 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m22:05:55.560420 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.560713 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:55.560971 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.561384 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:55.561692 [debug] [MainThread]: On master: Close
[0m22:05:55.562191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:55.562677 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:05:55.563134 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:05:55.563554 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:05:55.563950 [debug] [MainThread]: Connection 'model.instacart_dbt.dim_order' was properly closed.
[0m22:05:55.564449 [info ] [MainThread]: 
[0m22:05:55.565074 [info ] [MainThread]: Finished running 1 table model, 7 data tests in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m22:05:55.566261 [debug] [MainThread]: Command end result
[0m22:05:55.622033 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:05:55.626122 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:05:55.633284 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:05:55.633708 [info ] [MainThread]: 
[0m22:05:55.634390 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:05:55.635069 [info ] [MainThread]: 
[0m22:05:55.635957 [error] [MainThread]: [31mFailure in model dim_order (models\marts\dim\dim_order.sql)[0m
[0m22:05:55.636590 [error] [MainThread]:   Database Error in model dim_order (models\marts\dim\dim_order.sql)
  syntax error at or near "selects"
  LINE 18: selects
           ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_order.sql
[0m22:05:55.639170 [info ] [MainThread]: 
[0m22:05:55.639995 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\dim\dim_order.sql
[0m22:05:55.640445 [info ] [MainThread]: 
[0m22:05:55.640845 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=7 NO-OP=0 TOTAL=8
[0m22:05:55.641907 [debug] [MainThread]: Command `dbt build` failed at 22:05:55.641766 after 3.85 seconds
[0m22:05:55.642299 [debug] [MainThread]: Flushing usage events
[0m22:06:12.683819 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:06:12.763988 | cc8adaf1-8214-4f0f-9289-fbb1af52b025 ==============================
[0m22:06:12.763988 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:06:12.764934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select dim_order', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:13.114441 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:06:13.326537 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:06:13.626700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:06:13.627773 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\dim_order.sql
[0m22:06:14.383239 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:06:14.389198 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:06:14.456526 [info ] [MainThread]: Found 12 models, 5 seeds, 70 data tests, 5 sources, 547 macros
[0m22:06:14.461379 [info ] [MainThread]: 
[0m22:06:14.462040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:06:14.462557 [info ] [MainThread]: 
[0m22:06:14.463227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:06:14.464375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:06:14.977152 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:06:14.977548 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:06:14.977825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:15.045388 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.067 seconds
[0m22:06:15.046663 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:06:15.057527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:06:15.066498 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:06:15.067306 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:06:15.067806 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:06:15.072646 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:06:15.073434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:15.074258 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:06:15.075052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:15.139085 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m22:06:15.139659 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:06:15.140046 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:06:15.142934 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m22:06:15.143433 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:06:15.143840 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:06:15.146893 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.006 seconds
[0m22:06:15.148549 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:06:15.149006 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m22:06:15.150202 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:06:15.150657 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:06:15.151191 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:06:15.162239 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:15.162661 [debug] [MainThread]: On master: BEGIN
[0m22:06:15.162934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:15.210817 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m22:06:15.211217 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:15.211569 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:06:15.221718 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m22:06:15.223970 [debug] [MainThread]: On master: ROLLBACK
[0m22:06:15.224981 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:15.225342 [debug] [MainThread]: On master: BEGIN
[0m22:06:15.226070 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:06:15.226395 [debug] [MainThread]: On master: COMMIT
[0m22:06:15.226666 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:15.226931 [debug] [MainThread]: On master: COMMIT
[0m22:06:15.227419 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:06:15.227715 [debug] [MainThread]: On master: Close
[0m22:06:15.232258 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_order
[0m22:06:15.232815 [info ] [Thread-1 (]: 1 of 8 START sql table model public.dim_order .................................. [RUN]
[0m22:06:15.233589 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_order'
[0m22:06:15.233988 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_order
[0m22:06:15.243555 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_order"
[0m22:06:15.245369 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_order
[0m22:06:15.291902 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_order"
[0m22:06:15.293115 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:06:15.293585 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: BEGIN
[0m22:06:15.293912 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:15.342836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m22:06:15.343309 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:06:15.343659 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */

  
    

  create  table "instacart_db"."public"."dim_order__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_order.sql

-- Tujuan:
-- Dimensi order yang menyimpan informasi urutan, waktu, dan jeda antar order.
-- Menggunakan nama kolom hasil dari stg_orders (tanpa rename ulang).

select
    order_id,
    user_id,
    order_number,
    order_day,
    order_hour,
    days_gap
from "instacart_db"."public"."stg_orders"
  );
  
[0m22:06:19.981039 [debug] [Thread-1 (]: SQL status: SELECT 3421083 in 4.637 seconds
[0m22:06:19.992346 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:06:19.992835 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */
alter table "instacart_db"."public"."dim_order" rename to "dim_order__dbt_backup"
[0m22:06:19.994842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:06:19.998179 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:06:19.998557 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */
alter table "instacart_db"."public"."dim_order__dbt_tmp" rename to "dim_order"
[0m22:06:19.999632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:06:20.030254 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: COMMIT
[0m22:06:20.030813 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:06:20.031161 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: COMMIT
[0m22:06:20.035466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:06:20.043490 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_order__dbt_backup"
[0m22:06:20.048531 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:06:20.048926 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */
drop table if exists "instacart_db"."public"."dim_order__dbt_backup" cascade
[0m22:06:20.077816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m22:06:20.080626 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: Close
[0m22:06:20.083679 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.dim_order ............................. [[32mSELECT 3421083[0m in 4.85s]
[0m22:06:20.084869 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_order
[0m22:06:20.088316 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:06:20.089145 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:06:20.089720 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:06:20.090252 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:06:20.090881 [info ] [Thread-4 (]: 4 of 8 START test not_null_dim_order_order_id .................................. [RUN]
[0m22:06:20.091979 [info ] [Thread-3 (]: 3 of 8 START test not_null_dim_order_order_hour ................................ [RUN]
[0m22:06:20.092584 [info ] [Thread-1 (]: 5 of 8 START test not_null_dim_order_order_number .............................. [RUN]
[0m22:06:20.093171 [info ] [Thread-2 (]: 2 of 8 START test not_null_dim_order_order_day ................................. [RUN]
[0m22:06:20.093827 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e'
[0m22:06:20.094289 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06'
[0m22:06:20.094663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_order, now test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1)
[0m22:06:20.095077 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f'
[0m22:06:20.095438 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:06:20.095768 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:06:20.096100 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:06:20.096421 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:06:20.115531 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:06:20.117958 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:06:20.130796 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:06:20.135336 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:06:20.139261 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:06:20.141727 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:06:20.163024 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:06:20.163545 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:06:20.167007 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:06:20.167961 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:06:20.172219 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:06:20.175066 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:06:20.176160 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:06:20.176708 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: BEGIN
[0m22:06:20.177377 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:06:20.177851 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:06:20.178516 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:06:20.178961 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: BEGIN
[0m22:06:20.179710 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:06:20.180395 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: BEGIN
[0m22:06:20.180763 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:06:20.181129 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: BEGIN
[0m22:06:20.181482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:20.182082 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:06:20.248696 [debug] [Thread-4 (]: SQL status: BEGIN in 0.068 seconds
[0m22:06:20.249364 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:06:20.249901 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "instacart_db"."public"."dim_order"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:06:20.288667 [debug] [Thread-3 (]: SQL status: BEGIN in 0.111 seconds
[0m22:06:20.289431 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:06:20.289992 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_hour
from "instacart_db"."public"."dim_order"
where order_hour is null



  
  
      
    ) dbt_internal_test
[0m22:06:20.291767 [debug] [Thread-2 (]: SQL status: BEGIN in 0.110 seconds
[0m22:06:20.292390 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:06:20.292959 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_day
from "instacart_db"."public"."dim_order"
where order_day is null



  
  
      
    ) dbt_internal_test
[0m22:06:20.360152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.178 seconds
[0m22:06:20.361063 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:06:20.361990 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_number
from "instacart_db"."public"."dim_order"
where order_number is null



  
  
      
    ) dbt_internal_test
[0m22:06:21.029033 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.735 seconds
[0m22:06:21.034209 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: ROLLBACK
[0m22:06:21.035139 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: Close
[0m22:06:21.036616 [info ] [Thread-2 (]: 2 of 8 PASS not_null_dim_order_order_day ....................................... [[32mPASS[0m in 0.94s]
[0m22:06:21.040893 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:06:21.041861 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.791 seconds
[0m22:06:21.042485 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:06:21.042978 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.752 seconds
[0m22:06:21.045262 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: ROLLBACK
[0m22:06:21.048188 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: ROLLBACK
[0m22:06:21.045923 [info ] [Thread-2 (]: 6 of 8 START test not_null_dim_order_user_id ................................... [RUN]
[0m22:06:21.049195 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f, now test.instacart_dbt.not_null_dim_order_user_id.451d11f593)
[0m22:06:21.049762 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: Close
[0m22:06:21.050240 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: Close
[0m22:06:21.050777 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:06:21.059742 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:06:21.062754 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:06:21.066990 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:06:21.060947 [info ] [Thread-4 (]: 4 of 8 PASS not_null_dim_order_order_id ........................................ [[32mPASS[0m in 0.97s]
[0m22:06:21.068319 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:06:21.069269 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:06:21.061656 [info ] [Thread-3 (]: 3 of 8 PASS not_null_dim_order_order_hour ...................................... [[32mPASS[0m in 0.97s]
[0m22:06:21.072133 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:06:21.072849 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:06:21.071044 [info ] [Thread-4 (]: 7 of 8 START test relationships_fact_order_items_order_id__order_id__ref_dim_order_  [RUN]
[0m22:06:21.073683 [debug] [Thread-3 (]: Began running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:06:21.074440 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: BEGIN
[0m22:06:21.075227 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e, now test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace)
[0m22:06:21.076562 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:21.075866 [info ] [Thread-3 (]: 8 of 8 START test unique_dim_order_order_id .................................... [RUN]
[0m22:06:21.077226 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:06:21.078027 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06, now test.instacart_dbt.unique_dim_order_order_id.47b02e7daa)
[0m22:06:21.091094 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace"
[0m22:06:21.092173 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:06:21.104608 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:06:21.105759 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:06:21.110578 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace"
[0m22:06:21.111608 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:06:21.115353 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:06:21.116437 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace"
[0m22:06:21.117042 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace: BEGIN
[0m22:06:21.117533 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:06:21.118392 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:06:21.120222 [debug] [Thread-3 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: BEGIN
[0m22:06:21.121483 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:06:21.159575 [debug] [Thread-2 (]: SQL status: BEGIN in 0.083 seconds
[0m22:06:21.160289 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:06:21.160906 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "instacart_db"."public"."dim_order"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:06:21.178715 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.816 seconds
[0m22:06:21.181256 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: ROLLBACK
[0m22:06:21.182063 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: Close
[0m22:06:21.182965 [info ] [Thread-1 (]: 5 of 8 PASS not_null_dim_order_order_number .................................... [[32mPASS[0m in 1.09s]
[0m22:06:21.190268 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:06:21.220599 [debug] [Thread-4 (]: SQL status: BEGIN in 0.103 seconds
[0m22:06:21.221395 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace"
[0m22:06:21.222044 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "instacart_db"."public"."dim_order"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:06:21.223285 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.fact_order_items" does not exist
LINE 16:     from "instacart_db"."public"."fact_order_items"
                  ^

[0m22:06:21.223978 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace: ROLLBACK
[0m22:06:21.224882 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace: Close
[0m22:06:21.238776 [debug] [Thread-4 (]: Database Error in test relationships_fact_order_items_order_id__order_id__ref_dim_order_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_b6db70a0a82ac69068072fd96efbfb15.sql
[0m22:06:21.242292 [debug] [Thread-3 (]: SQL status: BEGIN in 0.121 seconds
[0m22:06:21.243095 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:06:21.243651 [debug] [Thread-3 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_order"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:06:21.239831 [error] [Thread-4 (]: 7 of 8 ERROR relationships_fact_order_items_order_id__order_id__ref_dim_order_ . [[31mERROR[0m in 0.16s]
[0m22:06:21.256284 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:06:21.257335 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_order_items_order_id__order_id__ref_dim_order_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_b6db70a0a82ac69068072fd96efbfb15.sql.
[0m22:06:21.565399 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.404 seconds
[0m22:06:21.568024 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: ROLLBACK
[0m22:06:21.568950 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: Close
[0m22:06:21.571036 [info ] [Thread-2 (]: 6 of 8 PASS not_null_dim_order_user_id ......................................... [[32mPASS[0m in 0.52s]
[0m22:06:21.577094 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:06:24.682507 [debug] [Thread-3 (]: SQL status: SELECT 1 in 3.438 seconds
[0m22:06:24.684978 [debug] [Thread-3 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: ROLLBACK
[0m22:06:24.686826 [debug] [Thread-3 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: Close
[0m22:06:24.688705 [info ] [Thread-3 (]: 8 of 8 PASS unique_dim_order_order_id .......................................... [[32mPASS[0m in 3.61s]
[0m22:06:24.690091 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:06:24.692642 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:24.693297 [debug] [MainThread]: On master: BEGIN
[0m22:06:24.694437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:24.773231 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m22:06:24.774325 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.774836 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:24.775282 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.775925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:06:24.776386 [debug] [MainThread]: On master: Close
[0m22:06:24.777053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:24.777440 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:06:24.777834 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:06:24.778396 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:06:24.778778 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1' was properly closed.
[0m22:06:24.779163 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace' was properly closed.
[0m22:06:24.779522 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_dim_order_order_id.47b02e7daa' was properly closed.
[0m22:06:24.779879 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_order_user_id.451d11f593' was properly closed.
[0m22:06:24.780368 [info ] [MainThread]: 
[0m22:06:24.780943 [info ] [MainThread]: Finished running 1 table model, 7 data tests in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m22:06:24.784258 [debug] [MainThread]: Command end result
[0m22:06:24.860315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:06:24.866171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:06:24.879657 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:06:24.880379 [info ] [MainThread]: 
[0m22:06:24.881234 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:06:24.882214 [info ] [MainThread]: 
[0m22:06:24.883315 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_order_id__order_id__ref_dim_order_ (models\marts\fact\schema.yml)[0m
[0m22:06:24.884008 [error] [MainThread]:   Database Error in test relationships_fact_order_items_order_id__order_id__ref_dim_order_ (models\marts\fact\schema.yml)
  relation "public.fact_order_items" does not exist
  LINE 16:     from "instacart_db"."public"."fact_order_items"
                    ^
  compiled code at target\run\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_b6db70a0a82ac69068072fd96efbfb15.sql
[0m22:06:24.884549 [info ] [MainThread]: 
[0m22:06:24.885178 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\fact\schema.yml\relationships_fact_order_items_b6db70a0a82ac69068072fd96efbfb15.sql
[0m22:06:24.888542 [info ] [MainThread]: 
[0m22:06:24.889490 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m22:06:24.891540 [debug] [MainThread]: Command `dbt build` failed at 22:06:24.891259 after 12.28 seconds
[0m22:06:24.892296 [debug] [MainThread]: Flushing usage events
[0m22:06:59.906625 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:06:59.989956 | 3c7cbd23-28c6-4e75-9bca-e50a688331ce ==============================
[0m22:06:59.989956 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:06:59.990940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select dim_order', 'send_anonymous_usage_stats': 'True'}
[0m22:07:00.341200 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:07:00.566029 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:07:00.876259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:07:00.877265 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\fact\schema.yml
[0m22:07:01.669197 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:07:01.674529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:07:01.744177 [info ] [MainThread]: Found 12 models, 5 seeds, 69 data tests, 5 sources, 547 macros
[0m22:07:01.759574 [info ] [MainThread]: 
[0m22:07:01.760289 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:07:01.760832 [info ] [MainThread]: 
[0m22:07:01.761560 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:07:01.762821 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:07:02.186958 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:07:02.187398 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:07:02.187700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:02.266391 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.079 seconds
[0m22:07:02.269575 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:07:02.280291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:07:02.292906 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:07:02.294043 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:07:02.294754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:02.295712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:07:02.298526 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:07:02.299079 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:07:02.299526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:02.363166 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m22:07:02.363869 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:07:02.364510 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:07:02.373665 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m22:07:02.374346 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:07:02.374810 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:07:02.375222 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m22:07:02.376349 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:07:02.376831 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:07:02.381492 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.006 seconds
[0m22:07:02.382945 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:07:02.383508 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:07:02.392719 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:02.393188 [debug] [MainThread]: On master: BEGIN
[0m22:07:02.393480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:02.441142 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m22:07:02.441734 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:02.442112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:07:02.452098 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m22:07:02.454674 [debug] [MainThread]: On master: ROLLBACK
[0m22:07:02.455381 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:02.455742 [debug] [MainThread]: On master: BEGIN
[0m22:07:02.456810 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:07:02.457164 [debug] [MainThread]: On master: COMMIT
[0m22:07:02.457441 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:02.457702 [debug] [MainThread]: On master: COMMIT
[0m22:07:02.458197 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:07:02.458495 [debug] [MainThread]: On master: Close
[0m22:07:02.462990 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_order
[0m22:07:02.463544 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_order .................................. [RUN]
[0m22:07:02.464304 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_order'
[0m22:07:02.464683 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_order
[0m22:07:02.474576 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_order"
[0m22:07:02.476242 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_order
[0m22:07:02.526197 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_order"
[0m22:07:02.527399 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:07:02.527891 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: BEGIN
[0m22:07:02.528219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:07:02.577027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m22:07:02.577481 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:07:02.577831 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */

  
    

  create  table "instacart_db"."public"."dim_order__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_order.sql

-- Tujuan:
-- Dimensi order yang menyimpan informasi urutan, waktu, dan jeda antar order.
-- Menggunakan nama kolom hasil dari stg_orders (tanpa rename ulang).

select
    order_id,
    user_id,
    order_number,
    order_day,
    order_hour,
    days_gap
from "instacart_db"."public"."stg_orders"
  );
  
[0m22:07:06.886206 [debug] [Thread-1 (]: SQL status: SELECT 3421083 in 4.308 seconds
[0m22:07:06.896442 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:07:06.897031 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */
alter table "instacart_db"."public"."dim_order" rename to "dim_order__dbt_backup"
[0m22:07:07.911538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.014 seconds
[0m22:07:07.926904 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:07:07.928501 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */
alter table "instacart_db"."public"."dim_order__dbt_tmp" rename to "dim_order"
[0m22:07:07.930923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:07:07.993643 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: COMMIT
[0m22:07:07.994747 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:07:07.995683 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: COMMIT
[0m22:07:07.998236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:07:08.022227 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_order__dbt_backup"
[0m22:07:08.039107 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:07:08.040681 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */
drop table if exists "instacart_db"."public"."dim_order__dbt_backup" cascade
[0m22:07:08.114208 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.072 seconds
[0m22:07:08.122205 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: Close
[0m22:07:08.128182 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_order ............................. [[32mSELECT 3421083[0m in 5.66s]
[0m22:07:08.130125 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_order
[0m22:07:08.132567 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:07:08.133522 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:07:08.137669 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:07:08.139888 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:07:08.138808 [info ] [Thread-2 (]: 2 of 7 START test not_null_dim_order_order_day ................................. [RUN]
[0m22:07:08.141665 [info ] [Thread-4 (]: 4 of 7 START test not_null_dim_order_order_id .................................. [RUN]
[0m22:07:08.144241 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f'
[0m22:07:08.142573 [info ] [Thread-1 (]: 5 of 7 START test not_null_dim_order_order_number .............................. [RUN]
[0m22:07:08.145145 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e'
[0m22:07:08.145777 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:07:08.143492 [info ] [Thread-3 (]: 3 of 7 START test not_null_dim_order_order_hour ................................ [RUN]
[0m22:07:08.146616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_order, now test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1)
[0m22:07:08.147181 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:07:08.172396 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:07:08.173611 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06'
[0m22:07:08.174477 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:07:08.178775 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:07:08.179568 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:07:08.183956 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:07:08.189963 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:07:08.191249 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:07:08.206387 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:07:08.220288 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:07:08.222105 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:07:08.223930 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:07:08.227762 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:07:08.228676 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:07:08.231189 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:07:08.231994 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:07:08.232506 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: BEGIN
[0m22:07:08.232999 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:07:08.234892 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:07:08.236053 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: BEGIN
[0m22:07:08.238032 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:07:08.238682 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:07:08.239917 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: BEGIN
[0m22:07:08.239240 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:07:08.240379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:08.241236 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: BEGIN
[0m22:07:08.242977 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:07:08.311134 [debug] [Thread-2 (]: SQL status: BEGIN in 0.078 seconds
[0m22:07:08.311776 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:07:08.312350 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_day
from "instacart_db"."public"."dim_order"
where order_day is null



  
  
      
    ) dbt_internal_test
[0m22:07:08.340250 [debug] [Thread-4 (]: SQL status: BEGIN in 0.104 seconds
[0m22:07:08.340963 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:07:08.341511 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "instacart_db"."public"."dim_order"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:07:08.353272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.113 seconds
[0m22:07:08.353936 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:07:08.354449 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_number
from "instacart_db"."public"."dim_order"
where order_number is null



  
  
      
    ) dbt_internal_test
[0m22:07:08.370134 [debug] [Thread-3 (]: SQL status: BEGIN in 0.127 seconds
[0m22:07:08.370858 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:07:08.371449 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_hour
from "instacart_db"."public"."dim_order"
where order_hour is null



  
  
      
    ) dbt_internal_test
[0m22:07:09.132127 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.819 seconds
[0m22:07:09.138595 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: ROLLBACK
[0m22:07:09.139686 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: Close
[0m22:07:09.140657 [info ] [Thread-2 (]: 2 of 7 PASS not_null_dim_order_order_day ....................................... [[32mPASS[0m in 1.00s]
[0m22:07:09.145616 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:07:09.146668 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:07:09.147229 [info ] [Thread-2 (]: 6 of 7 START test not_null_dim_order_user_id ................................... [RUN]
[0m22:07:09.149992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f, now test.instacart_dbt.not_null_dim_order_user_id.451d11f593)
[0m22:07:09.151639 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:07:09.158665 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:07:09.159964 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:07:09.163935 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:07:09.165301 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:07:09.165848 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: BEGIN
[0m22:07:09.166297 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:07:09.172924 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.831 seconds
[0m22:07:09.175612 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: ROLLBACK
[0m22:07:09.176350 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: Close
[0m22:07:09.180280 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.825 seconds
[0m22:07:09.177220 [info ] [Thread-4 (]: 4 of 7 PASS not_null_dim_order_order_id ........................................ [[32mPASS[0m in 1.03s]
[0m22:07:09.183023 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: ROLLBACK
[0m22:07:09.185459 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:07:09.186479 [debug] [Thread-4 (]: Began running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:07:09.187201 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: Close
[0m22:07:09.187969 [info ] [Thread-4 (]: 7 of 7 START test unique_dim_order_order_id .................................... [RUN]
[0m22:07:09.191564 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e, now test.instacart_dbt.unique_dim_order_order_id.47b02e7daa)
[0m22:07:09.192547 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:07:09.204292 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:07:09.189173 [info ] [Thread-1 (]: 5 of 7 PASS not_null_dim_order_order_number .................................... [[32mPASS[0m in 1.04s]
[0m22:07:09.206670 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:07:09.208006 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:07:09.212022 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:07:09.213748 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:07:09.214309 [debug] [Thread-4 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: BEGIN
[0m22:07:09.214790 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:07:09.259134 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.887 seconds
[0m22:07:09.262077 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: ROLLBACK
[0m22:07:09.262937 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: Close
[0m22:07:09.265035 [debug] [Thread-2 (]: SQL status: BEGIN in 0.099 seconds
[0m22:07:09.265641 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:07:09.266166 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "instacart_db"."public"."dim_order"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:07:09.263993 [info ] [Thread-3 (]: 3 of 7 PASS not_null_dim_order_order_hour ...................................... [[32mPASS[0m in 1.09s]
[0m22:07:09.270776 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:07:09.298668 [debug] [Thread-4 (]: SQL status: BEGIN in 0.084 seconds
[0m22:07:09.299380 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:07:09.299935 [debug] [Thread-4 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_order"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:07:09.766374 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.500 seconds
[0m22:07:09.769866 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: ROLLBACK
[0m22:07:09.770943 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: Close
[0m22:07:09.772040 [info ] [Thread-2 (]: 6 of 7 PASS not_null_dim_order_user_id ......................................... [[32mPASS[0m in 0.62s]
[0m22:07:09.779634 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:07:12.840102 [debug] [Thread-4 (]: SQL status: SELECT 1 in 3.539 seconds
[0m22:07:12.842418 [debug] [Thread-4 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: ROLLBACK
[0m22:07:12.843133 [debug] [Thread-4 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: Close
[0m22:07:12.843973 [info ] [Thread-4 (]: 7 of 7 PASS unique_dim_order_order_id .......................................... [[32mPASS[0m in 3.65s]
[0m22:07:12.845042 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:07:12.847874 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:12.848389 [debug] [MainThread]: On master: BEGIN
[0m22:07:12.848788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:12.908347 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m22:07:12.908993 [debug] [MainThread]: On master: COMMIT
[0m22:07:12.909411 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:12.909754 [debug] [MainThread]: On master: COMMIT
[0m22:07:12.910307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:07:12.910631 [debug] [MainThread]: On master: Close
[0m22:07:12.911047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:12.911350 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:07:12.911677 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:07:12.911905 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:07:12.912142 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1' was properly closed.
[0m22:07:12.912363 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_order_user_id.451d11f593' was properly closed.
[0m22:07:12.912662 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_dim_order_order_id.47b02e7daa' was properly closed.
[0m22:07:12.912923 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06' was properly closed.
[0m22:07:12.913237 [info ] [MainThread]: 
[0m22:07:12.913742 [info ] [MainThread]: Finished running 1 table model, 6 data tests in 0 hours 0 minutes and 11.15 seconds (11.15s).
[0m22:07:12.915811 [debug] [MainThread]: Command end result
[0m22:07:12.964268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:07:12.971038 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:07:12.978272 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:07:12.978746 [info ] [MainThread]: 
[0m22:07:12.979329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:12.980308 [info ] [MainThread]: 
[0m22:07:12.981105 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:07:12.982669 [debug] [MainThread]: Command `dbt build` succeeded at 22:07:12.982482 after 13.15 seconds
[0m22:07:12.983141 [debug] [MainThread]: Flushing usage events
[0m22:09:10.021544 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:09:10.172873 | bbacf0a7-25d4-4505-9693-3e85d055eb93 ==============================
[0m22:09:10.172873 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:09:10.173910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select stg_orders', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:09:10.537737 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:09:10.773901 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:09:11.090426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:09:11.091311 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\staging\stg_orders.sql
[0m22:09:11.965443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:09:11.969420 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:09:12.039727 [info ] [MainThread]: Found 12 models, 5 seeds, 69 data tests, 5 sources, 547 macros
[0m22:09:12.046365 [info ] [MainThread]: 
[0m22:09:12.048147 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:09:12.048785 [info ] [MainThread]: 
[0m22:09:12.049776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:09:12.051272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:09:12.302366 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:09:12.302760 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:09:12.303033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:12.380610 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.077 seconds
[0m22:09:12.382189 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:09:12.389634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:09:12.398089 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:09:12.399339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:09:12.399727 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:09:12.402217 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:09:12.402626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:12.403052 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:09:12.403539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:12.472069 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m22:09:12.472669 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:09:12.473127 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:09:12.477872 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m22:09:12.479270 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:09:12.480336 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:09:12.482981 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.009 seconds
[0m22:09:12.486429 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:09:12.487271 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:09:12.491197 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m22:09:12.492426 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:09:12.493136 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:09:12.510992 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:12.514403 [debug] [MainThread]: On master: BEGIN
[0m22:09:12.515701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:09:12.569075 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m22:09:12.569696 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:12.570306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:09:12.579371 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m22:09:12.582686 [debug] [MainThread]: On master: ROLLBACK
[0m22:09:12.583305 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:12.583646 [debug] [MainThread]: On master: BEGIN
[0m22:09:12.584180 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:09:12.584651 [debug] [MainThread]: On master: COMMIT
[0m22:09:12.585089 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:12.585436 [debug] [MainThread]: On master: COMMIT
[0m22:09:12.585898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:09:12.586397 [debug] [MainThread]: On master: Close
[0m22:09:12.591885 [debug] [Thread-1 (]: Began running node model.instacart_dbt.stg_orders
[0m22:09:12.592534 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m22:09:12.593411 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.stg_orders'
[0m22:09:12.593858 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.stg_orders
[0m22:09:12.603910 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.stg_orders"
[0m22:09:12.606408 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.stg_orders
[0m22:09:12.654615 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.stg_orders"
[0m22:09:12.656399 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:12.656881 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: BEGIN
[0m22:09:12.657182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:09:12.710483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m22:09:12.710942 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:12.711844 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */

  create view "instacart_db"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql

-- Tujuan staging:
-- 1. Menyelaraskan penamaan kolom agar lebih readable
-- 2. Menjaga NULL pada kolom `days_since_prior_order`
-- 3. Mapping hari dari angka ke nama (Sunday–Saturday)
-- 4. Konsistensi struktur dan tipe data untuk model downstream

with source as (

    select *
    from "instacart_db"."public"."orders"

),

renamed as (

    select
        order_id,
        user_id,
        order_number,

        -- Mapping 0-6 menjadi nama hari (Bahasa Inggris)
        case order_day_of_week
            when 0 then 'Sunday'
            when 1 then 'Monday'
            when 2 then 'Tuesday'
            when 3 then 'Wednesday'
            when 4 then 'Thursday'
            when 5 then 'Friday'
            when 6 then 'Saturday'
        end as order_day,
        order_hour_of_day as order_hour,
        days_since_prior_order as order_days_gap
    from source

)

select * from renamed
  );
[0m22:09:12.721605 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:09:12.729551 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:12.730381 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
alter table "instacart_db"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:09:12.731642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:09:12.735910 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:12.736408 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
alter table "instacart_db"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:09:12.737752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:09:12.758042 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: COMMIT
[0m22:09:12.758535 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:12.758892 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: COMMIT
[0m22:09:12.760291 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:09:12.769754 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."stg_orders__dbt_backup"
[0m22:09:12.775134 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:12.775595 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
drop view if exists "instacart_db"."public"."stg_orders__dbt_backup" cascade
[0m22:09:12.777383 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:09:12.781960 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: Close
[0m22:09:12.785812 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.19s]
[0m22:09:12.787266 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.stg_orders
[0m22:09:12.788653 [debug] [Thread-2 (]: Began running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e
[0m22:09:12.789402 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m22:09:12.790424 [debug] [Thread-3 (]: Began running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m22:09:12.789957 [info ] [Thread-2 (]: 2 of 10 START test dbt_utils_accepted_range_stg_orders_days_gap__30__0 ......... [RUN]
[0m22:09:12.791383 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_orders_order_hour .............................. [RUN]
[0m22:09:12.792145 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m22:09:12.793326 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e'
[0m22:09:12.792580 [info ] [Thread-3 (]: 3 of 10 START test dbt_utils_accepted_range_stg_orders_order_hour__23__0 ....... [RUN]
[0m22:09:12.794112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.stg_orders, now test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a)
[0m22:09:12.796951 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e
[0m22:09:12.796082 [info ] [Thread-4 (]: 4 of 10 START test not_null_stg_orders_order_day ............................... [RUN]
[0m22:09:12.798142 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9'
[0m22:09:12.799690 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m22:09:12.805396 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e"
[0m22:09:12.806111 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_stg_orders_order_day.25276152f4'
[0m22:09:12.806644 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m22:09:12.817365 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m22:09:12.818559 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m22:09:12.823115 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m22:09:12.827090 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m22:09:12.829866 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m22:09:12.860290 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e
[0m22:09:12.868016 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e"
[0m22:09:12.871168 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m22:09:12.871780 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m22:09:12.872515 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m22:09:12.875263 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m22:09:12.879881 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m22:09:12.880858 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m22:09:12.881555 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e"
[0m22:09:12.882234 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: BEGIN
[0m22:09:12.882748 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e: BEGIN
[0m22:09:12.883254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:12.883812 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m22:09:12.884235 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m22:09:12.884626 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:09:12.885194 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: BEGIN
[0m22:09:12.885759 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: BEGIN
[0m22:09:12.886543 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:09:12.887078 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:09:12.980074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.097 seconds
[0m22:09:12.980875 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m22:09:12.981512 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_hour
from "instacart_db"."public"."stg_orders"
where order_hour is null



  
  
      
    ) dbt_internal_test
[0m22:09:12.987167 [debug] [Thread-2 (]: SQL status: BEGIN in 0.102 seconds
[0m22:09:12.987900 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e"
[0m22:09:12.988608 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "instacart_db"."public"."stg_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not days_gap >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not days_gap <= 30
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:09:12.990222 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "days_gap" does not exist
LINE 24:     or not days_gap >= 0
                    ^

[0m22:09:12.990843 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e: ROLLBACK
[0m22:09:12.991610 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e: Close
[0m22:09:12.997549 [debug] [Thread-3 (]: SQL status: BEGIN in 0.111 seconds
[0m22:09:12.998558 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m22:09:12.999782 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "instacart_db"."public"."stg_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not order_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not order_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:09:13.009398 [debug] [Thread-2 (]: Database Error in test dbt_utils_accepted_range_stg_orders_days_gap__30__0 (models\staging\schema.yml)
  column "days_gap" does not exist
  LINE 24:     or not days_gap >= 0
                      ^
  compiled code at target\run\instacart_dbt\models\staging\schema.yml\dbt_utils_accepted_range_stg_orders_days_gap__30__0.sql
[0m22:09:13.026079 [debug] [Thread-4 (]: SQL status: BEGIN in 0.139 seconds
[0m22:09:13.026761 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m22:09:13.027322 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_day
from "instacart_db"."public"."stg_orders"
where order_day is null



  
  
      
    ) dbt_internal_test
[0m22:09:13.010295 [error] [Thread-2 (]: 2 of 10 ERROR dbt_utils_accepted_range_stg_orders_days_gap__30__0 .............. [[31mERROR[0m in 0.22s]
[0m22:09:13.047436 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e
[0m22:09:13.068126 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_accepted_range_stg_orders_days_gap__30__0 (models\staging\schema.yml)
  column "days_gap" does not exist
  LINE 24:     or not days_gap >= 0
                      ^
  compiled code at target\run\instacart_dbt\models\staging\schema.yml\dbt_utils_accepted_range_stg_orders_days_gap__30__0.sql.
[0m22:09:13.048119 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m22:09:13.069783 [info ] [Thread-2 (]: 6 of 10 START test not_null_stg_orders_order_id ................................ [RUN]
[0m22:09:13.088927 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.dbt_utils_accepted_range_stg_orders_days_gap__30__0.a92386f11e, now test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m22:09:13.089715 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m22:09:13.148749 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:09:13.154491 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m22:09:13.186760 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:09:13.206254 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:09:13.207427 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m22:09:13.208311 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:09:13.335323 [debug] [Thread-2 (]: SQL status: BEGIN in 0.127 seconds
[0m22:09:13.335995 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:09:13.336556 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "instacart_db"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:09:13.853065 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.852 seconds
[0m22:09:13.860336 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: ROLLBACK
[0m22:09:13.861531 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: Close
[0m22:09:13.864644 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.882 seconds
[0m22:09:13.865521 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.838 seconds
[0m22:09:13.868503 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: ROLLBACK
[0m22:09:13.863095 [info ] [Thread-3 (]: 3 of 10 PASS dbt_utils_accepted_range_stg_orders_order_hour__23__0 ............. [[32mPASS[0m in 1.07s]
[0m22:09:13.871363 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: ROLLBACK
[0m22:09:13.872408 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m22:09:13.872957 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: Close
[0m22:09:13.873589 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m22:09:13.874062 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: Close
[0m22:09:13.874718 [info ] [Thread-3 (]: 7 of 10 START test not_null_stg_orders_order_number ............................ [RUN]
[0m22:09:13.877093 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9, now test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0)
[0m22:09:13.877647 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m22:09:13.885987 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m22:09:13.875476 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_orders_order_hour .................................... [[32mPASS[0m in 1.08s]
[0m22:09:13.887298 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m22:09:13.887922 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m22:09:13.889208 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m22:09:13.892579 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m22:09:13.876321 [info ] [Thread-4 (]: 4 of 10 PASS not_null_stg_orders_order_day ..................................... [[32mPASS[0m in 1.07s]
[0m22:09:13.893828 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m22:09:13.894375 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m22:09:13.897373 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m22:09:13.898357 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: BEGIN
[0m22:09:13.898822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:09:13.888542 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_orders_user_id ................................. [RUN]
[0m22:09:13.903729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a, now test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209)
[0m22:09:13.904382 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m22:09:13.911044 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m22:09:13.895387 [info ] [Thread-4 (]: 9 of 10 START test relationships_stg_order_products_order_id__order_id__ref_stg_orders_  [RUN]
[0m22:09:13.913410 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_day.25276152f4, now test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544)
[0m22:09:13.914339 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m22:09:13.928055 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m22:09:13.929964 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m22:09:13.935136 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m22:09:13.935948 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m22:09:13.939332 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m22:09:13.940351 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m22:09:13.940909 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: BEGIN
[0m22:09:13.941434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:13.942201 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m22:09:13.942763 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: BEGIN
[0m22:09:13.943280 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:09:13.980983 [debug] [Thread-3 (]: SQL status: BEGIN in 0.082 seconds
[0m22:09:13.982444 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m22:09:13.983104 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_number
from "instacart_db"."public"."stg_orders"
where order_number is null



  
  
      
    ) dbt_internal_test
[0m22:09:14.031883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.090 seconds
[0m22:09:14.033230 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m22:09:14.034354 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "instacart_db"."public"."stg_orders"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:09:14.090688 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.753 seconds
[0m22:09:14.093139 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m22:09:14.093915 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m22:09:14.095371 [info ] [Thread-2 (]: 6 of 10 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 1.01s]
[0m22:09:14.112901 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m22:09:14.113832 [debug] [Thread-2 (]: Began running node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m22:09:14.114502 [info ] [Thread-2 (]: 10 of 10 START test unique_stg_orders_order_id ................................. [RUN]
[0m22:09:14.126265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m22:09:14.126921 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m22:09:14.138811 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m22:09:14.140142 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m22:09:14.143701 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m22:09:14.145715 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m22:09:14.146547 [debug] [Thread-2 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m22:09:14.147134 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:09:14.154953 [debug] [Thread-4 (]: SQL status: BEGIN in 0.212 seconds
[0m22:09:14.155718 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m22:09:14.156306 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "instacart_db"."public"."stg_order_products"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "instacart_db"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:09:14.276330 [debug] [Thread-2 (]: SQL status: BEGIN in 0.129 seconds
[0m22:09:14.276991 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m22:09:14.277535 [debug] [Thread-2 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:09:14.803031 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.768 seconds
[0m22:09:14.805460 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: ROLLBACK
[0m22:09:14.806226 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: Close
[0m22:09:14.807215 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_orders_user_id ....................................... [[32mPASS[0m in 0.90s]
[0m22:09:14.815008 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m22:09:14.821098 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.837 seconds
[0m22:09:14.825537 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: ROLLBACK
[0m22:09:14.826426 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: Close
[0m22:09:14.827501 [info ] [Thread-3 (]: 7 of 10 PASS not_null_stg_orders_order_number .................................. [[32mPASS[0m in 0.95s]
[0m22:09:14.838997 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m22:09:21.946254 [debug] [Thread-2 (]: SQL status: SELECT 1 in 7.668 seconds
[0m22:09:21.950499 [debug] [Thread-2 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m22:09:21.951590 [debug] [Thread-2 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m22:09:21.952823 [info ] [Thread-2 (]: 10 of 10 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 7.83s]
[0m22:09:21.970028 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m22:09:31.225677 [debug] [Thread-4 (]: SQL status: SELECT 1 in 17.068 seconds
[0m22:09:31.229121 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: ROLLBACK
[0m22:09:31.230161 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: Close
[0m22:09:31.231353 [info ] [Thread-4 (]: 9 of 10 PASS relationships_stg_order_products_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 17.32s]
[0m22:09:31.233031 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m22:09:31.235811 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:31.236383 [debug] [MainThread]: On master: BEGIN
[0m22:09:31.236818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:09:31.323332 [debug] [MainThread]: SQL status: BEGIN in 0.086 seconds
[0m22:09:31.324080 [debug] [MainThread]: On master: COMMIT
[0m22:09:31.324610 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:31.325079 [debug] [MainThread]: On master: COMMIT
[0m22:09:31.325735 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:09:31.326292 [debug] [MainThread]: On master: Close
[0m22:09:31.327048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:31.327574 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:09:31.328103 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:09:31.328614 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:09:31.329107 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209' was properly closed.
[0m22:09:31.329603 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m22:09:31.330047 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0' was properly closed.
[0m22:09:31.330478 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544' was properly closed.
[0m22:09:31.331111 [info ] [MainThread]: 
[0m22:09:31.331846 [info ] [MainThread]: Finished running 9 data tests, 1 view model in 0 hours 0 minutes and 19.28 seconds (19.28s).
[0m22:09:31.336649 [debug] [MainThread]: Command end result
[0m22:09:31.441289 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:09:31.449486 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:09:31.464813 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:09:31.465713 [info ] [MainThread]: 
[0m22:09:31.466722 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:09:31.467649 [info ] [MainThread]: 
[0m22:09:31.468718 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_orders_days_gap__30__0 (models\staging\schema.yml)[0m
[0m22:09:31.469593 [error] [MainThread]:   Database Error in test dbt_utils_accepted_range_stg_orders_days_gap__30__0 (models\staging\schema.yml)
  column "days_gap" does not exist
  LINE 24:     or not days_gap >= 0
                      ^
  compiled code at target\run\instacart_dbt\models\staging\schema.yml\dbt_utils_accepted_range_stg_orders_days_gap__30__0.sql
[0m22:09:31.470289 [info ] [MainThread]: 
[0m22:09:31.471108 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\staging\schema.yml\dbt_utils_accepted_range_stg_orders_days_gap__30__0.sql
[0m22:09:31.471824 [info ] [MainThread]: 
[0m22:09:31.472547 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m22:09:31.474692 [debug] [MainThread]: Command `dbt build` failed at 22:09:31.474451 after 21.54 seconds
[0m22:09:31.475427 [debug] [MainThread]: Flushing usage events
[0m22:09:42.251960 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:09:42.341869 | 827d49fb-8c9f-4960-ac0c-962265d3ab03 ==============================
[0m22:09:42.341869 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:09:42.342989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select stg_orders', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:09:42.842521 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:09:43.172618 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:09:43.573739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:09:43.574993 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\staging\schema.yml
[0m22:09:44.669206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:09:44.673631 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:09:44.770631 [info ] [MainThread]: Found 12 models, 5 seeds, 69 data tests, 5 sources, 547 macros
[0m22:09:44.780431 [info ] [MainThread]: 
[0m22:09:44.781357 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:09:44.782182 [info ] [MainThread]: 
[0m22:09:44.783205 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:09:44.785128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:09:45.133294 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:09:45.133960 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:09:45.134420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:45.224679 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.090 seconds
[0m22:09:45.226832 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:09:45.236756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:09:45.246104 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:09:45.246850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:09:45.247390 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:09:45.251288 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:09:45.252091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:45.252658 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:09:45.253247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:45.320384 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m22:09:45.321143 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:09:45.321731 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:09:45.334300 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m22:09:45.334821 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:09:45.335233 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:09:45.657416 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.335 seconds
[0m22:09:45.663362 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:09:45.665129 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.329 seconds
[0m22:09:45.670037 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:09:45.671047 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:09:45.672464 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:09:45.702691 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:45.703308 [debug] [MainThread]: On master: BEGIN
[0m22:09:45.703794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:09:45.797796 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m22:09:45.798495 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:45.799207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:09:45.814093 [debug] [MainThread]: SQL status: SELECT 5 in 0.014 seconds
[0m22:09:45.817824 [debug] [MainThread]: On master: ROLLBACK
[0m22:09:45.818531 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:45.818992 [debug] [MainThread]: On master: BEGIN
[0m22:09:45.819679 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:09:45.820077 [debug] [MainThread]: On master: COMMIT
[0m22:09:45.820441 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:45.820771 [debug] [MainThread]: On master: COMMIT
[0m22:09:45.821214 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:09:45.821631 [debug] [MainThread]: On master: Close
[0m22:09:45.833682 [debug] [Thread-1 (]: Began running node model.instacart_dbt.stg_orders
[0m22:09:45.834590 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m22:09:45.836139 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.stg_orders'
[0m22:09:45.836963 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.stg_orders
[0m22:09:45.853314 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.stg_orders"
[0m22:09:45.854928 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.stg_orders
[0m22:09:45.932531 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.stg_orders"
[0m22:09:45.936101 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:45.936839 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: BEGIN
[0m22:09:45.937466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:09:45.998997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m22:09:45.999508 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:45.999943 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */

  create view "instacart_db"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql

-- Tujuan staging:
-- 1. Menyelaraskan penamaan kolom agar lebih readable
-- 2. Menjaga NULL pada kolom `days_since_prior_order`
-- 3. Mapping hari dari angka ke nama (Sunday–Saturday)
-- 4. Konsistensi struktur dan tipe data untuk model downstream

with source as (

    select *
    from "instacart_db"."public"."orders"

),

renamed as (

    select
        order_id,
        user_id,
        order_number,

        -- Mapping 0-6 menjadi nama hari (Bahasa Inggris)
        case order_day_of_week
            when 0 then 'Sunday'
            when 1 then 'Monday'
            when 2 then 'Tuesday'
            when 3 then 'Wednesday'
            when 4 then 'Thursday'
            when 5 then 'Friday'
            when 6 then 'Saturday'
        end as order_day,
        order_hour_of_day as order_hour,
        days_since_prior_order as order_days_gap
    from source

)

select * from renamed
  );
[0m22:09:46.011778 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m22:09:46.020527 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:46.021309 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
alter table "instacart_db"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:09:46.023783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:09:46.029666 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:46.030427 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
alter table "instacart_db"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:09:46.032707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:09:46.070598 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: COMMIT
[0m22:09:46.071120 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:46.071507 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: COMMIT
[0m22:09:46.072909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:09:46.083515 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."stg_orders__dbt_backup"
[0m22:09:46.089456 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.stg_orders"
[0m22:09:46.089952 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.stg_orders"} */
drop view if exists "instacart_db"."public"."stg_orders__dbt_backup" cascade
[0m22:09:46.092291 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:09:46.098055 [debug] [Thread-1 (]: On model.instacart_dbt.stg_orders: Close
[0m22:09:46.102262 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.26s]
[0m22:09:46.103481 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.stg_orders
[0m22:09:46.104914 [debug] [Thread-2 (]: Began running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2
[0m22:09:46.105572 [debug] [Thread-3 (]: Began running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m22:09:46.106006 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m22:09:46.106438 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m22:09:46.106889 [info ] [Thread-2 (]: 2 of 10 START test dbt_utils_accepted_range_stg_orders_order_days_gap__30__0 ... [RUN]
[0m22:09:46.107508 [info ] [Thread-3 (]: 3 of 10 START test dbt_utils_accepted_range_stg_orders_order_hour__23__0 ....... [RUN]
[0m22:09:46.108346 [info ] [Thread-4 (]: 4 of 10 START test not_null_stg_orders_order_day ............................... [RUN]
[0m22:09:46.111238 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2'
[0m22:09:46.112483 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9'
[0m22:09:46.109007 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_orders_order_hour .............................. [RUN]
[0m22:09:46.113487 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_stg_orders_order_day.25276152f4'
[0m22:09:46.114055 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2
[0m22:09:46.114625 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m22:09:46.115192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.stg_orders, now test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a)
[0m22:09:46.115636 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m22:09:46.121464 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2"
[0m22:09:46.128294 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m22:09:46.128974 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m22:09:46.141802 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m22:09:46.148725 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m22:09:46.150188 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2
[0m22:09:46.150922 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m22:09:46.182501 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2"
[0m22:09:46.185294 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m22:09:46.186354 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m22:09:46.189350 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m22:09:46.189848 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m22:09:46.195113 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m22:09:46.196469 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m22:09:46.197338 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: BEGIN
[0m22:09:46.198754 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m22:09:46.199576 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2"
[0m22:09:46.200023 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:09:46.200577 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: BEGIN
[0m22:09:46.201075 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2: BEGIN
[0m22:09:46.201699 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m22:09:46.202356 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:09:46.202992 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:09:46.203696 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: BEGIN
[0m22:09:46.205229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:46.321237 [debug] [Thread-2 (]: SQL status: BEGIN in 0.118 seconds
[0m22:09:46.322121 [debug] [Thread-3 (]: SQL status: BEGIN in 0.122 seconds
[0m22:09:46.322877 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2"
[0m22:09:46.323610 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"
[0m22:09:46.324383 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "instacart_db"."public"."stg_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not order_days_gap >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not order_days_gap <= 30
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:09:46.325193 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "instacart_db"."public"."stg_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not order_hour >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not order_hour <= 23
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:09:46.336633 [debug] [Thread-4 (]: SQL status: BEGIN in 0.134 seconds
[0m22:09:46.337465 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"
[0m22:09:46.338146 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_day.25276152f4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_day
from "instacart_db"."public"."stg_orders"
where order_day is null



  
  
      
    ) dbt_internal_test
[0m22:09:46.419153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.214 seconds
[0m22:09:46.420002 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"
[0m22:09:46.420785 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_hour
from "instacart_db"."public"."stg_orders"
where order_hour is null



  
  
      
    ) dbt_internal_test
[0m22:09:47.467462 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.046 seconds
[0m22:09:47.473752 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: ROLLBACK
[0m22:09:47.475745 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a: Close
[0m22:09:47.477774 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_orders_order_hour .................................... [[32mPASS[0m in 1.36s]
[0m22:09:47.506677 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a
[0m22:09:47.523351 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m22:09:47.525089 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.199 seconds
[0m22:09:47.529207 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2: ROLLBACK
[0m22:09:47.530307 [debug] [Thread-2 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2: Close
[0m22:09:47.524453 [info ] [Thread-1 (]: 6 of 10 START test not_null_stg_orders_order_id ................................ [RUN]
[0m22:09:47.547974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_hour.bfdbf6a56a, now test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m22:09:47.548950 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m22:09:47.531503 [info ] [Thread-2 (]: 2 of 10 PASS dbt_utils_accepted_range_stg_orders_order_days_gap__30__0 ......... [[32mPASS[0m in 1.42s]
[0m22:09:47.580607 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:09:47.583980 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2
[0m22:09:47.584800 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.259 seconds
[0m22:09:47.585697 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.247 seconds
[0m22:09:47.586504 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m22:09:47.589398 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: ROLLBACK
[0m22:09:47.592492 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: ROLLBACK
[0m22:09:47.595082 [debug] [Thread-3 (]: On test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9: Close
[0m22:09:47.597621 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_stg_orders_order_day.25276152f4: Close
[0m22:09:47.595959 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m22:09:47.593964 [info ] [Thread-2 (]: 7 of 10 START test not_null_stg_orders_order_number ............................ [RUN]
[0m22:09:47.615483 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:09:47.599425 [info ] [Thread-3 (]: 3 of 10 PASS dbt_utils_accepted_range_stg_orders_order_hour__23__0 ............. [[32mPASS[0m in 1.49s]
[0m22:09:47.617482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_days_gap__30__0.7e25dd43d2, now test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0)
[0m22:09:47.618869 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9
[0m22:09:47.600706 [info ] [Thread-4 (]: 4 of 10 PASS not_null_stg_orders_order_day ..................................... [[32mPASS[0m in 1.49s]
[0m22:09:47.619790 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m22:09:47.620546 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m22:09:47.621634 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_day.25276152f4
[0m22:09:47.630787 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m22:09:47.632808 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:09:47.636229 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m22:09:47.631795 [info ] [Thread-3 (]: 8 of 10 START test not_null_stg_orders_user_id ................................. [RUN]
[0m22:09:47.638106 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m22:09:47.638847 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m22:09:47.640364 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.dbt_utils_accepted_range_stg_orders_order_hour__23__0.da539048c9, now test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209)
[0m22:09:47.645551 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m22:09:47.639608 [info ] [Thread-4 (]: 9 of 10 START test relationships_stg_order_products_order_id__order_id__ref_stg_orders_  [RUN]
[0m22:09:47.646644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:47.647392 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m22:09:47.648678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_day.25276152f4, now test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544)
[0m22:09:47.658351 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m22:09:47.659333 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m22:09:47.661867 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m22:09:47.679386 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m22:09:47.680527 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: BEGIN
[0m22:09:47.682245 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m22:09:47.683428 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:09:47.688517 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m22:09:47.690025 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m22:09:47.699530 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m22:09:47.700910 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m22:09:47.701738 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: BEGIN
[0m22:09:47.702486 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:09:47.707517 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m22:09:47.708366 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: BEGIN
[0m22:09:47.711370 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:09:47.773883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.127 seconds
[0m22:09:47.774933 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:09:47.775861 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "instacart_db"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:09:47.853738 [debug] [Thread-3 (]: SQL status: BEGIN in 0.151 seconds
[0m22:09:47.854651 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"
[0m22:09:47.855560 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "instacart_db"."public"."stg_orders"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:09:47.866101 [debug] [Thread-2 (]: SQL status: BEGIN in 0.183 seconds
[0m22:09:47.867032 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"
[0m22:09:47.867890 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_number
from "instacart_db"."public"."stg_orders"
where order_number is null



  
  
      
    ) dbt_internal_test
[0m22:09:47.871343 [debug] [Thread-4 (]: SQL status: BEGIN in 0.160 seconds
[0m22:09:47.872257 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"
[0m22:09:47.873096 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "instacart_db"."public"."stg_order_products"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "instacart_db"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:09:48.622114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.845 seconds
[0m22:09:48.626035 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m22:09:48.628253 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m22:09:48.630418 [info ] [Thread-1 (]: 6 of 10 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 1.08s]
[0m22:09:48.639247 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m22:09:48.640060 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m22:09:48.640859 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_orders_order_id ................................. [RUN]
[0m22:09:48.654850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m22:09:48.655577 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m22:09:48.670773 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m22:09:48.672396 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m22:09:48.679333 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m22:09:48.681927 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m22:09:48.683086 [debug] [Thread-1 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m22:09:48.695405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:48.902596 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.034 seconds
[0m22:09:48.906243 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: ROLLBACK
[0m22:09:48.907267 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0: Close
[0m22:09:48.908379 [info ] [Thread-2 (]: 7 of 10 PASS not_null_stg_orders_order_number .................................. [[32mPASS[0m in 1.29s]
[0m22:09:48.922066 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0
[0m22:09:48.954331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.270 seconds
[0m22:09:48.955193 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m22:09:48.955871 [debug] [Thread-1 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:09:48.963601 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.107 seconds
[0m22:09:48.967424 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: ROLLBACK
[0m22:09:48.968557 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209: Close
[0m22:09:48.969690 [info ] [Thread-3 (]: 8 of 10 PASS not_null_stg_orders_user_id ....................................... [[32mPASS[0m in 1.33s]
[0m22:09:48.989949 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209
[0m22:09:55.828096 [debug] [Thread-1 (]: SQL status: SELECT 1 in 6.871 seconds
[0m22:09:55.832161 [debug] [Thread-1 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m22:09:55.833359 [debug] [Thread-1 (]: On test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m22:09:55.834656 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 7.18s]
[0m22:09:55.838163 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a
[0m22:10:08.822471 [debug] [Thread-4 (]: SQL status: SELECT 1 in 20.948 seconds
[0m22:10:08.825744 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: ROLLBACK
[0m22:10:08.827286 [debug] [Thread-4 (]: On test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544: Close
[0m22:10:08.828561 [info ] [Thread-4 (]: 9 of 10 PASS relationships_stg_order_products_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 21.18s]
[0m22:10:08.831226 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544
[0m22:10:08.833789 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:08.834437 [debug] [MainThread]: On master: BEGIN
[0m22:10:08.834962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:08.939581 [debug] [MainThread]: SQL status: BEGIN in 0.105 seconds
[0m22:10:08.940284 [debug] [MainThread]: On master: COMMIT
[0m22:10:08.940762 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:08.941186 [debug] [MainThread]: On master: COMMIT
[0m22:10:08.941713 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:10:08.942764 [debug] [MainThread]: On master: Close
[0m22:10:08.944084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:08.944741 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:10:08.945260 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:10:08.945776 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:10:08.946268 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m22:10:08.946730 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_stg_orders_order_number.e3102fc8d0' was properly closed.
[0m22:10:08.947290 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_stg_orders_user_id.7d129d0209' was properly closed.
[0m22:10:08.947753 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_stg_order_products_order_id__order_id__ref_stg_orders_.87d3c00544' was properly closed.
[0m22:10:08.948292 [info ] [MainThread]: 
[0m22:10:08.948944 [info ] [MainThread]: Finished running 9 data tests, 1 view model in 0 hours 0 minutes and 24.17 seconds (24.17s).
[0m22:10:08.952781 [debug] [MainThread]: Command end result
[0m22:10:09.035425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:10:09.040978 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:10:09.056501 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:10:09.058055 [info ] [MainThread]: 
[0m22:10:09.061457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:09.062626 [info ] [MainThread]: 
[0m22:10:09.065087 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m22:10:09.068294 [debug] [MainThread]: Command `dbt build` succeeded at 22:10:09.067968 after 26.90 seconds
[0m22:10:09.069642 [debug] [MainThread]: Flushing usage events
[0m22:10:51.520661 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:10:51.632663 | 7c004698-5510-49ab-9212-dbf2597b268c ==============================
[0m22:10:51.632663 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:10:51.633698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select dim_order', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:52.069033 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:10:52.339028 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:10:52.706451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:10:52.709237 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\schema.yml
[0m22:10:53.672284 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:10:53.681350 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:10:53.785111 [info ] [MainThread]: Found 12 models, 5 seeds, 69 data tests, 5 sources, 547 macros
[0m22:10:53.792438 [info ] [MainThread]: 
[0m22:10:53.793549 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:10:53.794044 [info ] [MainThread]: 
[0m22:10:53.794900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:10:53.796575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:10:54.081079 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:10:54.081490 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:10:54.081778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:54.163979 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.082 seconds
[0m22:10:54.165942 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:10:54.176859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:10:54.187022 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:10:54.187750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:10:54.188756 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:10:54.194020 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:10:54.194776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:54.196133 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:10:54.196870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:54.280745 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m22:10:54.281356 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:10:54.281962 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:10:54.286410 [debug] [ThreadPool]: SQL status: BEGIN in 0.089 seconds
[0m22:10:54.287010 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:10:54.287531 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:10:54.294482 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m22:10:54.297128 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:10:54.297787 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.010 seconds
[0m22:10:54.300093 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:10:54.300669 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:10:54.301412 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:10:54.313700 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:54.314149 [debug] [MainThread]: On master: BEGIN
[0m22:10:54.314444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:54.370321 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m22:10:54.370959 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:54.371602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:10:54.384299 [debug] [MainThread]: SQL status: SELECT 5 in 0.012 seconds
[0m22:10:54.387719 [debug] [MainThread]: On master: ROLLBACK
[0m22:10:54.388307 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:54.388638 [debug] [MainThread]: On master: BEGIN
[0m22:10:54.389134 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:10:54.389447 [debug] [MainThread]: On master: COMMIT
[0m22:10:54.389723 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:54.390531 [debug] [MainThread]: On master: COMMIT
[0m22:10:54.391479 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:10:54.392080 [debug] [MainThread]: On master: Close
[0m22:10:54.398597 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_order
[0m22:10:54.399265 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_order .................................. [RUN]
[0m22:10:54.400225 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_order'
[0m22:10:54.400873 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_order
[0m22:10:54.412466 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_order"
[0m22:10:54.414571 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_order
[0m22:10:54.469968 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_order"
[0m22:10:54.471331 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:10:54.471823 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: BEGIN
[0m22:10:54.472177 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:10:54.532230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m22:10:54.532946 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:10:54.533497 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */

  
    

  create  table "instacart_db"."public"."dim_order__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_order.sql

-- Tujuan:
-- Dimensi order yang menyimpan informasi urutan, waktu, dan jeda antar order.
-- Menggunakan nama kolom hasil dari stg_orders (tanpa rename ulang).

select
    order_id,
    user_id,
    order_number,
    order_day,
    order_hour,
    days_gap
from "instacart_db"."public"."stg_orders"
  );
  
[0m22:10:54.540086 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "days_gap" does not exist
LINE 24:     days_gap
             ^

[0m22:10:54.541420 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: ROLLBACK
[0m22:10:54.542386 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: Close
[0m22:10:54.560203 [debug] [Thread-1 (]: Database Error in model dim_order (models\marts\dim\dim_order.sql)
  column "days_gap" does not exist
  LINE 24:     days_gap
               ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_order.sql
[0m22:10:54.563200 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model public.dim_order ......................... [[31mERROR[0m in 0.16s]
[0m22:10:54.564087 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_order
[0m22:10:54.564738 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.dim_order' to be skipped because of status 'error'.  Reason: Database Error in model dim_order (models\marts\dim\dim_order.sql)
  column "days_gap" does not exist
  LINE 24:     days_gap
               ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_order.sql.
[0m22:10:54.566145 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:10:54.566562 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:10:54.566990 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:10:54.567461 [info ] [Thread-2 (]: 2 of 7 SKIP test not_null_dim_order_order_day .................................. [[33mSKIP[0m]
[0m22:10:54.567966 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:10:54.568409 [info ] [Thread-1 (]: 5 of 7 SKIP test not_null_dim_order_order_number ............................... [[33mSKIP[0m]
[0m22:10:54.569272 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:10:54.568749 [info ] [Thread-3 (]: 3 of 7 SKIP test not_null_dim_order_order_hour ................................. [[33mSKIP[0m]
[0m22:10:54.569902 [info ] [Thread-4 (]: 4 of 7 SKIP test not_null_dim_order_order_id ................................... [[33mSKIP[0m]
[0m22:10:54.570411 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:10:54.570828 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:10:54.571193 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f' to be skipped because of status 'skipped'. 
[0m22:10:54.571563 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:10:54.572042 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:10:54.572536 [debug] [Thread-1 (]: Began running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:10:54.572921 [info ] [Thread-2 (]: 6 of 7 SKIP test not_null_dim_order_user_id .................................... [[33mSKIP[0m]
[0m22:10:54.575026 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1' to be skipped because of status 'skipped'. 
[0m22:10:54.576846 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:10:54.576202 [info ] [Thread-1 (]: 7 of 7 SKIP test unique_dim_order_order_id ..................................... [[33mSKIP[0m]
[0m22:10:54.577557 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06' to be skipped because of status 'skipped'. 
[0m22:10:54.578123 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:10:54.578752 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e' to be skipped because of status 'skipped'. 
[0m22:10:54.579932 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_dim_order_user_id.451d11f593' to be skipped because of status 'skipped'. 
[0m22:10:54.580736 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.unique_dim_order_order_id.47b02e7daa' to be skipped because of status 'skipped'. 
[0m22:10:54.582275 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:54.582666 [debug] [MainThread]: On master: BEGIN
[0m22:10:54.582960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:54.647926 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m22:10:54.648589 [debug] [MainThread]: On master: COMMIT
[0m22:10:54.649068 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:54.649469 [debug] [MainThread]: On master: COMMIT
[0m22:10:54.649936 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:10:54.650242 [debug] [MainThread]: On master: Close
[0m22:10:54.650737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:54.651173 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:10:54.651541 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:10:54.651892 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:10:54.652230 [debug] [MainThread]: Connection 'model.instacart_dbt.dim_order' was properly closed.
[0m22:10:54.652696 [info ] [MainThread]: 
[0m22:10:54.653334 [info ] [MainThread]: Finished running 1 table model, 6 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m22:10:54.655306 [debug] [MainThread]: Command end result
[0m22:10:54.728600 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:10:54.733982 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:10:54.747773 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:10:54.748419 [info ] [MainThread]: 
[0m22:10:54.749128 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:10:54.749807 [info ] [MainThread]: 
[0m22:10:54.752424 [error] [MainThread]: [31mFailure in model dim_order (models\marts\dim\dim_order.sql)[0m
[0m22:10:54.753235 [error] [MainThread]:   Database Error in model dim_order (models\marts\dim\dim_order.sql)
  column "days_gap" does not exist
  LINE 24:     days_gap
               ^
  compiled code at target\run\instacart_dbt\models\marts\dim\dim_order.sql
[0m22:10:54.753836 [info ] [MainThread]: 
[0m22:10:54.754463 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\dim\dim_order.sql
[0m22:10:54.754977 [info ] [MainThread]: 
[0m22:10:54.755509 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=7
[0m22:10:54.759558 [debug] [MainThread]: Command `dbt build` failed at 22:10:54.759085 after 3.33 seconds
[0m22:10:54.760385 [debug] [MainThread]: Flushing usage events
[0m22:11:47.999682 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:11:48.086473 | bf695647-a67b-4c74-95a3-98593b782631 ==============================
[0m22:11:48.086473 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:11:48.087402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select dim_order', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:11:48.465197 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:11:48.705798 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:11:49.045848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:49.046742 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\dim\dim_order.sql
[0m22:11:49.884721 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:11:49.890075 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:11:49.956580 [info ] [MainThread]: Found 12 models, 5 seeds, 69 data tests, 5 sources, 547 macros
[0m22:11:49.962957 [info ] [MainThread]: 
[0m22:11:49.963673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:11:49.964068 [info ] [MainThread]: 
[0m22:11:49.964589 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:11:49.965705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:11:50.247297 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:11:50.247685 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:11:50.247954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:50.316937 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.069 seconds
[0m22:11:50.318364 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:11:50.330273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:11:50.336402 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:11:50.337044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:11:50.339122 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:11:50.343380 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:11:50.343892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:50.344244 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:11:50.344754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:50.412550 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m22:11:50.413156 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:11:50.413629 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:11:50.421092 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m22:11:50.423944 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:11:50.424857 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:11:50.430100 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m22:11:50.430745 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:11:50.431234 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:11:50.441605 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.010 seconds
[0m22:11:50.444608 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:11:50.445398 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:11:50.461464 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:50.461887 [debug] [MainThread]: On master: BEGIN
[0m22:11:50.462184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:50.520252 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m22:11:50.521148 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:50.522260 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:11:50.532317 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m22:11:50.534721 [debug] [MainThread]: On master: ROLLBACK
[0m22:11:50.535357 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:50.535790 [debug] [MainThread]: On master: BEGIN
[0m22:11:50.536318 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:11:50.536624 [debug] [MainThread]: On master: COMMIT
[0m22:11:50.536898 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:50.537163 [debug] [MainThread]: On master: COMMIT
[0m22:11:50.538161 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:11:50.539199 [debug] [MainThread]: On master: Close
[0m22:11:50.544753 [debug] [Thread-1 (]: Began running node model.instacart_dbt.dim_order
[0m22:11:50.545761 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_order .................................. [RUN]
[0m22:11:50.546934 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.dim_order'
[0m22:11:50.547604 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.dim_order
[0m22:11:50.558349 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.dim_order"
[0m22:11:50.559514 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.dim_order
[0m22:11:50.610434 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.dim_order"
[0m22:11:50.611745 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:11:50.612178 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: BEGIN
[0m22:11:50.612528 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:11:50.670296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m22:11:50.671434 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:11:50.672472 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */

  
    

  create  table "instacart_db"."public"."dim_order__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim/dim_order.sql

-- Tujuan:
-- Dimensi order yang menyimpan informasi urutan, waktu, dan jeda antar order.
-- Menggunakan nama kolom hasil dari stg_orders (tanpa rename ulang).

select
    order_id,
    user_id,
    order_number,
    order_day,
    order_hour,
    order_days_gap
from "instacart_db"."public"."stg_orders"
  );
  
[0m22:11:56.376227 [debug] [Thread-1 (]: SQL status: SELECT 3421083 in 5.703 seconds
[0m22:11:56.392216 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:11:56.393424 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */
alter table "instacart_db"."public"."dim_order" rename to "dim_order__dbt_backup"
[0m22:11:56.395748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:11:56.400977 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:11:56.401768 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */
alter table "instacart_db"."public"."dim_order__dbt_tmp" rename to "dim_order"
[0m22:11:56.403305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:56.432385 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: COMMIT
[0m22:11:56.432975 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:11:56.433399 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: COMMIT
[0m22:11:56.440932 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m22:11:56.449469 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."dim_order__dbt_backup"
[0m22:11:56.460047 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.dim_order"
[0m22:11:56.460984 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.dim_order"} */
drop table if exists "instacart_db"."public"."dim_order__dbt_backup" cascade
[0m22:11:56.472649 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m22:11:56.476566 [debug] [Thread-1 (]: On model.instacart_dbt.dim_order: Close
[0m22:11:56.480199 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_order ............................. [[32mSELECT 3421083[0m in 5.93s]
[0m22:11:56.482064 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.dim_order
[0m22:11:56.483945 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:11:56.484756 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:11:56.485429 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:11:56.486232 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:11:56.486896 [info ] [Thread-3 (]: 3 of 7 START test not_null_dim_order_order_hour ................................ [RUN]
[0m22:11:56.493074 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06'
[0m22:11:56.490436 [info ] [Thread-1 (]: 5 of 7 START test not_null_dim_order_order_number .............................. [RUN]
[0m22:11:56.493875 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:11:56.494949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.dim_order, now test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1)
[0m22:11:56.491322 [info ] [Thread-4 (]: 4 of 7 START test not_null_dim_order_order_id .................................. [RUN]
[0m22:11:56.514457 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:11:56.515470 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:11:56.492292 [info ] [Thread-2 (]: 2 of 7 START test not_null_dim_order_order_day ................................. [RUN]
[0m22:11:56.516352 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e'
[0m22:11:56.523519 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:11:56.524545 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f'
[0m22:11:56.525578 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:11:56.526972 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:11:56.527927 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:11:56.534222 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:11:56.542910 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:11:56.576261 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:11:56.576970 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:11:56.578490 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:11:56.579333 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:11:56.580009 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:11:56.583130 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:11:56.586341 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:11:56.586918 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: BEGIN
[0m22:11:56.591744 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:11:56.593254 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:11:56.594802 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:11:56.595552 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: BEGIN
[0m22:11:56.596435 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:11:56.597453 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:11:56.598278 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:11:56.599016 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: BEGIN
[0m22:11:56.600682 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:11:56.599991 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: BEGIN
[0m22:11:56.601751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:56.694960 [debug] [Thread-2 (]: SQL status: BEGIN in 0.097 seconds
[0m22:11:56.695787 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"
[0m22:11:56.696451 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_day
from "instacart_db"."public"."dim_order"
where order_day is null



  
  
      
    ) dbt_internal_test
[0m22:11:56.750739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m22:11:56.751560 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"
[0m22:11:56.752264 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_number
from "instacart_db"."public"."dim_order"
where order_number is null



  
  
      
    ) dbt_internal_test
[0m22:11:56.752984 [debug] [Thread-3 (]: SQL status: BEGIN in 0.160 seconds
[0m22:11:56.754138 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"
[0m22:11:56.755257 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_hour
from "instacart_db"."public"."dim_order"
where order_hour is null



  
  
      
    ) dbt_internal_test
[0m22:11:56.833805 [debug] [Thread-4 (]: SQL status: BEGIN in 0.233 seconds
[0m22:11:56.834643 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"
[0m22:11:56.835325 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "instacart_db"."public"."dim_order"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:11:57.792230 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.095 seconds
[0m22:11:57.799364 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: ROLLBACK
[0m22:11:57.800403 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f: Close
[0m22:11:57.801651 [info ] [Thread-2 (]: 2 of 7 PASS not_null_dim_order_order_day ....................................... [[32mPASS[0m in 1.28s]
[0m22:11:57.810550 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f
[0m22:11:57.811727 [debug] [Thread-2 (]: Began running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:11:57.812710 [info ] [Thread-2 (]: 6 of 7 START test not_null_dim_order_user_id ................................... [RUN]
[0m22:11:57.815924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_order_order_day.43f8cce57f, now test.instacart_dbt.not_null_dim_order_user_id.451d11f593)
[0m22:11:57.816680 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:11:57.826190 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:11:57.828566 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:11:57.833887 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:11:57.835535 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:11:57.844393 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: BEGIN
[0m22:11:57.860529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:57.873613 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.117 seconds
[0m22:11:57.877112 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: ROLLBACK
[0m22:11:57.878279 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06: Close
[0m22:11:57.879588 [info ] [Thread-3 (]: 3 of 7 PASS not_null_dim_order_order_hour ...................................... [[32mPASS[0m in 1.39s]
[0m22:11:57.886536 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06
[0m22:11:57.888077 [debug] [Thread-3 (]: Began running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:11:57.889281 [info ] [Thread-3 (]: 7 of 7 START test unique_dim_order_order_id .................................... [RUN]
[0m22:11:57.895587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_dim_order_order_hour.831ea6aa06, now test.instacart_dbt.unique_dim_order_order_id.47b02e7daa)
[0m22:11:57.896438 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:11:57.910655 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:11:57.912127 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.159 seconds
[0m22:11:57.915281 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: ROLLBACK
[0m22:11:57.916494 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:11:57.917297 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1: Close
[0m22:11:57.925908 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:11:57.931897 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:11:57.929669 [info ] [Thread-1 (]: 5 of 7 PASS not_null_dim_order_order_number .................................... [[32mPASS[0m in 1.43s]
[0m22:11:57.941171 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1
[0m22:11:57.939607 [debug] [Thread-3 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: BEGIN
[0m22:11:57.942723 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:11:57.998155 [debug] [Thread-2 (]: SQL status: BEGIN in 0.152 seconds
[0m22:11:57.999065 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"
[0m22:11:57.999866 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_dim_order_user_id.451d11f593"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "instacart_db"."public"."dim_order"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:11:58.097809 [debug] [Thread-3 (]: SQL status: BEGIN in 0.155 seconds
[0m22:11:58.098859 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"
[0m22:11:58.099789 [debug] [Thread-3 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.unique_dim_order_order_id.47b02e7daa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "instacart_db"."public"."dim_order"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:11:58.158763 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.323 seconds
[0m22:11:58.162206 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: ROLLBACK
[0m22:11:58.163334 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e: Close
[0m22:11:58.164689 [info ] [Thread-4 (]: 4 of 7 PASS not_null_dim_order_order_id ........................................ [[32mPASS[0m in 1.65s]
[0m22:11:58.172244 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e
[0m22:11:58.696197 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.695 seconds
[0m22:11:58.699314 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: ROLLBACK
[0m22:11:58.700401 [debug] [Thread-2 (]: On test.instacart_dbt.not_null_dim_order_user_id.451d11f593: Close
[0m22:11:58.701654 [info ] [Thread-2 (]: 6 of 7 PASS not_null_dim_order_user_id ......................................... [[32mPASS[0m in 0.89s]
[0m22:11:58.709793 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.not_null_dim_order_user_id.451d11f593
[0m22:12:03.186332 [debug] [Thread-3 (]: SQL status: SELECT 1 in 5.086 seconds
[0m22:12:03.190000 [debug] [Thread-3 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: ROLLBACK
[0m22:12:03.191158 [debug] [Thread-3 (]: On test.instacart_dbt.unique_dim_order_order_id.47b02e7daa: Close
[0m22:12:03.192609 [info ] [Thread-3 (]: 7 of 7 PASS unique_dim_order_order_id .......................................... [[32mPASS[0m in 5.30s]
[0m22:12:03.194684 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.unique_dim_order_order_id.47b02e7daa
[0m22:12:03.197134 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:03.197800 [debug] [MainThread]: On master: BEGIN
[0m22:12:03.198327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:12:03.288473 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m22:12:03.289273 [debug] [MainThread]: On master: COMMIT
[0m22:12:03.289850 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:03.290372 [debug] [MainThread]: On master: COMMIT
[0m22:12:03.291152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:12:03.291845 [debug] [MainThread]: On master: Close
[0m22:12:03.293020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:12:03.293545 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:12:03.294001 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:12:03.294440 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:12:03.294909 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_order_order_number.fc8dc419a1' was properly closed.
[0m22:12:03.295363 [debug] [MainThread]: Connection 'test.instacart_dbt.unique_dim_order_order_id.47b02e7daa' was properly closed.
[0m22:12:03.295824 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_order_order_id.cb50913e3e' was properly closed.
[0m22:12:03.296251 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_dim_order_user_id.451d11f593' was properly closed.
[0m22:12:03.296839 [info ] [MainThread]: 
[0m22:12:03.297579 [info ] [MainThread]: Finished running 1 table model, 6 data tests in 0 hours 0 minutes and 13.33 seconds (13.33s).
[0m22:12:03.300841 [debug] [MainThread]: Command end result
[0m22:12:03.391526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:12:03.398995 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:12:03.416258 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:12:03.416998 [info ] [MainThread]: 
[0m22:12:03.417969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:12:03.418745 [info ] [MainThread]: 
[0m22:12:03.419549 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:12:03.423311 [debug] [MainThread]: Command `dbt build` succeeded at 22:12:03.423004 after 15.50 seconds
[0m22:12:03.424096 [debug] [MainThread]: Flushing usage events
[0m22:19:08.229796 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:19:08.370199 | 366bdbeb-d2d7-41dd-b013-d6a9c1b611db ==============================
[0m22:19:08.370199 [info ] [MainThread]: Running with dbt=1.10.3
[0m22:19:08.371170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select fact_order_items', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:19:08.963599 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:19:09.332252 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m22:19:09.557993 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:19:09.578593 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading instacart_dbt: marts\fact\schema.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |     - name: order_id
    14 |       description: "ID unik order, FK ke dim_order"
    15 |       tests: [not_null, relationships:
    16 |         to: ref('dim_order')
    17 |         field: order_id ]
    18 | 
    19 |     - name: product_id
    
    Raw Error:
    ------------------------------
    while parsing a flow sequence
      in "<unicode string>", line 15, column 14
    did not find expected ',' or ']'
      in "<unicode string>", line 16, column 11
[0m22:19:09.580893 [debug] [MainThread]: Command `dbt build` failed at 22:19:09.580687 after 1.42 seconds
[0m22:19:09.581337 [debug] [MainThread]: Flushing usage events
[0m22:20:05.842938 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:20:05.961616 | e17110a2-2c16-4f3d-bb76-64932f00cced ==============================
[0m22:20:05.961616 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:20:05.962965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --select fact_order_items', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:20:06.577507 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:20:06.990654 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:20:07.268086 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading instacart_dbt: marts\fact\schema.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |     - name: order_id
    14 |       description: "ID unik order, FK ke dim_order"
    15 |       tests: [not_null, relationships:
    16 |         to: ref('dim_order')
    17 |         field: order_id ]
    18 | 
    19 |     - name: product_id
    
    Raw Error:
    ------------------------------
    while parsing a flow sequence
      in "<unicode string>", line 15, column 14
    did not find expected ',' or ']'
      in "<unicode string>", line 16, column 11
[0m22:20:07.270201 [debug] [MainThread]: Command `dbt build` failed at 22:20:07.269891 after 1.55 seconds
[0m22:20:07.270937 [debug] [MainThread]: Flushing usage events
[0m22:21:00.091863 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:21:00.218695 | b866718e-3e13-466b-8ee1-a12361a69ede ==============================
[0m22:21:00.218695 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:21:00.220215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select fact_order_items', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:21:00.773792 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:21:01.198048 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:21:01.665137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:21:01.667275 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\fact\schema.yml
[0m22:21:01.668434 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\fact\fact_order_items.sql
[0m22:21:02.874708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:21:02.882286 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:21:02.966783 [info ] [MainThread]: Found 12 models, 5 seeds, 67 data tests, 5 sources, 547 macros
[0m22:21:02.971123 [info ] [MainThread]: 
[0m22:21:02.971788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:02.972316 [info ] [MainThread]: 
[0m22:21:02.973075 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:21:02.974321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:21:03.409797 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:21:03.410205 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:21:03.411029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:03.516890 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.106 seconds
[0m22:21:03.518755 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:21:03.530815 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:21:03.538602 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:21:03.540086 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:21:03.540989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:21:03.541979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:03.547750 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:21:03.548979 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:21:03.549748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:03.609955 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m22:21:03.610654 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:21:03.611045 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:21:03.620464 [debug] [ThreadPool]: SQL status: BEGIN in 0.071 seconds
[0m22:21:03.620916 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:21:03.621243 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:21:03.621651 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m22:21:03.623484 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:21:03.624152 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:21:03.628521 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.006 seconds
[0m22:21:03.632235 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:21:03.632963 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:21:03.641788 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:03.642189 [debug] [MainThread]: On master: BEGIN
[0m22:21:03.642468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:03.694420 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m22:21:03.694864 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:03.695234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:21:03.708174 [debug] [MainThread]: SQL status: SELECT 5 in 0.012 seconds
[0m22:21:03.710269 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:03.710846 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:03.711170 [debug] [MainThread]: On master: BEGIN
[0m22:21:03.711909 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:21:03.713866 [debug] [MainThread]: On master: COMMIT
[0m22:21:03.714326 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:03.714670 [debug] [MainThread]: On master: COMMIT
[0m22:21:03.715305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:21:03.715617 [debug] [MainThread]: On master: Close
[0m22:21:03.722355 [debug] [Thread-1 (]: Began running node model.instacart_dbt.fact_order_items
[0m22:21:03.722976 [info ] [Thread-1 (]: 1 of 9 START sql table model public.fact_order_items ........................... [RUN]
[0m22:21:03.724078 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.fact_order_items'
[0m22:21:03.724486 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.fact_order_items
[0m22:21:03.735301 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.fact_order_items"
[0m22:21:03.737386 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.fact_order_items
[0m22:21:03.789445 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.fact_order_items"
[0m22:21:03.790829 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.fact_order_items"
[0m22:21:03.791285 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: BEGIN
[0m22:21:03.791597 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:21:03.842161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m22:21:03.842621 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.fact_order_items"
[0m22:21:03.843012 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.fact_order_items"} */

  
    

  create  table "instacart_db"."public"."fact_order_items__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fact/fact_order_items.sql

-- Tujuan:
-- Fakta granular per item produk dalam order.
-- Dibentuk dari dimensi yang sudah dibersihkan: dim_order, dim_product, dim_time.

with order_products as (

    -- Masih dari stg karena belum ada dim_order_products
    select
        order_id,
        product_id,
        add_to_cart_order,
        reordered
    from "instacart_db"."public"."stg_order_products"

),

dim_order as (
    select
        order_id,
        user_id,
        order_number,
        order_day,
        order_hour,
        days_gap
    from "instacart_db"."public"."dim_order"
),

dim_product as (
    select
        product_id
    from "instacart_db"."public"."dim_product"
),

dim_time as (
    select
        time_id,
        day_of_week,
        hour_of_day
    from "instacart_db"."public"."dim_time"
),

joined as (

    select
        -- FK ke dim_user (via dim_order)
        o.user_id,

        -- FK ke dim_order
        o.order_id,
        o.order_number,
        o.days_gap,

        -- FK ke dim_product
        op.product_id,
        op.add_to_cart_order,
        op.reordered,

        -- FK ke dim_time
        t.time_id

    from order_products op
    inner join dim_order o
        on o.order_id = op.order_id

    inner join dim_product p
        on p.product_id = op.product_id

    left join dim_time t
        on o.order_day = t.day_of_week
       and o.order_hour = t.hour_of_day
)

select
    user_id,               -- FK ke dim_user
    order_id,              -- FK ke dim_order
    product_id,            -- FK ke dim_product
    time_id,               -- FK ke dim_time
    order_number,
    days_gap,
    add_to_cart_order,
    reordered
from joined
  );
  
[0m22:21:03.850138 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "days_gap" does not exist
LINE 37:         days_gap
                 ^

[0m22:21:03.851363 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: ROLLBACK
[0m22:21:03.852979 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: Close
[0m22:21:03.874049 [debug] [Thread-1 (]: Database Error in model fact_order_items (models\marts\fact\fact_order_items.sql)
  column "days_gap" does not exist
  LINE 37:         days_gap
                   ^
  compiled code at target\run\instacart_dbt\models\marts\fact\fact_order_items.sql
[0m22:21:03.876614 [error] [Thread-1 (]: 1 of 9 ERROR creating sql table model public.fact_order_items .................. [[31mERROR[0m in 0.15s]
[0m22:21:03.877564 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.fact_order_items
[0m22:21:03.878327 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.fact_order_items' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_items (models\marts\fact\fact_order_items.sql)
  column "days_gap" does not exist
  LINE 37:         days_gap
                   ^
  compiled code at target\run\instacart_dbt\models\marts\fact\fact_order_items.sql.
[0m22:21:03.881589 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45
[0m22:21:03.882117 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9
[0m22:21:03.882626 [debug] [Thread-2 (]: Began running node test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7
[0m22:21:03.883163 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e
[0m22:21:03.883751 [info ] [Thread-4 (]: 4 of 9 SKIP test not_null_fact_order_items_order_number ........................ [[33mSKIP[0m]
[0m22:21:03.886761 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45
[0m22:21:03.887179 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23
[0m22:21:03.885240 [info ] [Thread-1 (]: 5 of 9 SKIP test not_null_fact_order_items_product_id .......................... [[33mSKIP[0m]
[0m22:21:03.888035 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45' to be skipped because of status 'skipped'. 
[0m22:21:03.888680 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9
[0m22:21:03.885773 [info ] [Thread-2 (]: 2 of 9 SKIP test accepted_values_fact_order_items_reordered__0__1 .............. [[33mSKIP[0m]
[0m22:21:03.889608 [debug] [Thread-1 (]: Began running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:21:03.890083 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9' to be skipped because of status 'skipped'. 
[0m22:21:03.890585 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7
[0m22:21:03.886279 [info ] [Thread-3 (]: 3 of 9 SKIP test not_null_fact_order_items_order_id ............................ [[33mSKIP[0m]
[0m22:21:03.891986 [debug] [Thread-2 (]: Began running node test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m22:21:03.887655 [info ] [Thread-4 (]: 6 of 9 SKIP test not_null_fact_order_items_user_id ............................. [[33mSKIP[0m]
[0m22:21:03.892673 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e
[0m22:21:03.893096 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7' to be skipped because of status 'skipped'. 
[0m22:21:03.894196 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23
[0m22:21:03.891367 [info ] [Thread-1 (]: 7 of 9 SKIP test relationships_fact_order_items_order_id__order_id__ref_dim_order_  [[33mSKIP[0m]
[0m22:21:03.894904 [debug] [Thread-3 (]: Began running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m22:21:03.895427 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e' to be skipped because of status 'skipped'. 
[0m22:21:03.898848 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:21:03.893702 [info ] [Thread-2 (]: 8 of 9 SKIP test relationships_fact_order_items_product_id__product_id__ref_dim_product_  [[33mSKIP[0m]
[0m22:21:03.900039 [info ] [Thread-3 (]: 9 of 9 SKIP test relationships_fact_order_items_time_id__time_id__ref_dim_time_  [[33mSKIP[0m]
[0m22:21:03.900869 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23' to be skipped because of status 'skipped'. 
[0m22:21:03.901590 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m22:21:03.902088 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m22:21:03.902587 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace' to be skipped because of status 'skipped'. 
[0m22:21:03.903427 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428' to be skipped because of status 'skipped'. 
[0m22:21:03.903876 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' to be skipped because of status 'skipped'. 
[0m22:21:03.905818 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:03.906147 [debug] [MainThread]: On master: BEGIN
[0m22:21:03.906413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:21:03.959644 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m22:21:03.960050 [debug] [MainThread]: On master: COMMIT
[0m22:21:03.960375 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:03.960625 [debug] [MainThread]: On master: COMMIT
[0m22:21:03.961221 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:21:03.961533 [debug] [MainThread]: On master: Close
[0m22:21:03.961927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:03.963978 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:21:03.964475 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:21:03.964765 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:21:03.965235 [debug] [MainThread]: Connection 'model.instacart_dbt.fact_order_items' was properly closed.
[0m22:21:03.965824 [info ] [MainThread]: 
[0m22:21:03.966444 [info ] [MainThread]: Finished running 1 table model, 8 data tests in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m22:21:03.968519 [debug] [MainThread]: Command end result
[0m22:21:04.024281 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:21:04.028057 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:21:04.038314 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:21:04.038822 [info ] [MainThread]: 
[0m22:21:04.039415 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:21:04.039967 [info ] [MainThread]: 
[0m22:21:04.040548 [error] [MainThread]: [31mFailure in model fact_order_items (models\marts\fact\fact_order_items.sql)[0m
[0m22:21:04.041191 [error] [MainThread]:   Database Error in model fact_order_items (models\marts\fact\fact_order_items.sql)
  column "days_gap" does not exist
  LINE 37:         days_gap
                   ^
  compiled code at target\run\instacart_dbt\models\marts\fact\fact_order_items.sql
[0m22:21:04.041692 [info ] [MainThread]: 
[0m22:21:04.042747 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\fact\fact_order_items.sql
[0m22:21:04.043120 [info ] [MainThread]: 
[0m22:21:04.043568 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=8 NO-OP=0 TOTAL=9
[0m22:21:04.044712 [debug] [MainThread]: Command `dbt build` failed at 22:21:04.044596 after 4.07 seconds
[0m22:21:04.045051 [debug] [MainThread]: Flushing usage events
[0m22:22:17.591162 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:22:17.696859 | ecaddc2d-ddf7-4572-9b14-fdc3cfc58276 ==============================
[0m22:22:17.696859 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:22:17.698137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select fact_order_items', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:22:18.070687 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:22:18.461680 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:22:19.188301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:22:19.190023 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\fact\fact_order_items.sql
[0m22:22:20.482301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:22:20.486530 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:22:20.562362 [info ] [MainThread]: Found 12 models, 5 seeds, 67 data tests, 5 sources, 547 macros
[0m22:22:20.567734 [info ] [MainThread]: 
[0m22:22:20.568456 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:22:20.568989 [info ] [MainThread]: 
[0m22:22:20.569650 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:22:20.570825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:22:20.985856 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:22:20.986271 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:22:20.986566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:21.046615 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.060 seconds
[0m22:22:21.047887 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:22:21.053960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:22:21.061200 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:22:21.061646 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:22:21.061929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:21.062448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:22:21.065659 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:22:21.066133 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:22:21.066440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:21.118617 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m22:22:21.119254 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:22:21.119758 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:22:21.128418 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:22:21.130180 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:22:21.131300 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:22:21.131837 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m22:22:21.132483 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:22:21.132913 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:22:21.140717 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.007 seconds
[0m22:22:21.143090 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:22:21.144103 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:22:21.153683 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:21.154119 [debug] [MainThread]: On master: BEGIN
[0m22:22:21.154408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:21.201491 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m22:22:21.202197 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:21.202595 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:22:21.213180 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m22:22:21.215992 [debug] [MainThread]: On master: ROLLBACK
[0m22:22:21.216752 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:21.217247 [debug] [MainThread]: On master: BEGIN
[0m22:22:21.218122 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:22:21.218531 [debug] [MainThread]: On master: COMMIT
[0m22:22:21.218865 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:21.219139 [debug] [MainThread]: On master: COMMIT
[0m22:22:21.219680 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:22:21.219996 [debug] [MainThread]: On master: Close
[0m22:22:21.228433 [debug] [Thread-1 (]: Began running node model.instacart_dbt.fact_order_items
[0m22:22:21.229097 [info ] [Thread-1 (]: 1 of 9 START sql table model public.fact_order_items ........................... [RUN]
[0m22:22:21.230036 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.fact_order_items'
[0m22:22:21.231068 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.fact_order_items
[0m22:22:21.239929 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.fact_order_items"
[0m22:22:21.241154 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.fact_order_items
[0m22:22:21.288684 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.fact_order_items"
[0m22:22:21.289878 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.fact_order_items"
[0m22:22:21.290370 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: BEGIN
[0m22:22:21.290712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:21.339521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m22:22:21.339980 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.fact_order_items"
[0m22:22:21.340390 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.fact_order_items"} */

  
    

  create  table "instacart_db"."public"."fact_order_items__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fact/fact_order_items.sql

-- Tujuan:
-- Fakta granular per item produk dalam order.
-- Dibentuk dari dimensi yang sudah dibersihkan: dim_order, dim_product, dim_time.

with order_products as (

    -- Masih dari stg karena belum ada dim_order_products
    select
        order_id,
        product_id,
        add_to_cart_order,
        reordered
    from "instacart_db"."public"."stg_order_products"

),

dim_order as (
    select
        order_id,
        user_id,
        order_number,
        order_day,
        order_hour,
        order_days_gap
    from "instacart_db"."public"."dim_order"
),

dim_product as (
    select
        product_id
    from "instacart_db"."public"."dim_product"
),

dim_time as (
    select
        time_id,
        day_of_week,
        hour_of_day
    from "instacart_db"."public"."dim_time"
),

joined as (

    select
        -- FK ke dim_user (via dim_order)
        o.user_id,

        -- FK ke dim_order
        o.order_id,
        o.order_number,
        o.days_gap,

        -- FK ke dim_product
        op.product_id,
        op.add_to_cart_order,
        op.reordered,

        -- FK ke dim_time
        t.time_id

    from order_products op
    inner join dim_order o
        on o.order_id = op.order_id

    inner join dim_product p
        on p.product_id = op.product_id

    left join dim_time t
        on o.order_day = t.day_of_week
       and o.order_hour = t.hour_of_day
)

select
    user_id,               -- FK ke dim_user
    order_id,              -- FK ke dim_order
    product_id,            -- FK ke dim_product
    time_id,               -- FK ke dim_time
    order_number,
    order_days_gap,
    add_to_cart_order,
    reordered
from joined
  );
  
[0m22:22:21.345104 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column o.days_gap does not exist
LINE 64:         o.days_gap,
                 ^

[0m22:22:21.345577 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: ROLLBACK
[0m22:22:21.346323 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: Close
[0m22:22:21.357512 [debug] [Thread-1 (]: Database Error in model fact_order_items (models\marts\fact\fact_order_items.sql)
  column o.days_gap does not exist
  LINE 64:         o.days_gap,
                   ^
  compiled code at target\run\instacart_dbt\models\marts\fact\fact_order_items.sql
[0m22:22:21.361797 [error] [Thread-1 (]: 1 of 9 ERROR creating sql table model public.fact_order_items .................. [[31mERROR[0m in 0.13s]
[0m22:22:21.362676 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.fact_order_items
[0m22:22:21.363394 [debug] [Thread-7 (]: Marking all children of 'model.instacart_dbt.fact_order_items' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_items (models\marts\fact\fact_order_items.sql)
  column o.days_gap does not exist
  LINE 64:         o.days_gap,
                   ^
  compiled code at target\run\instacart_dbt\models\marts\fact\fact_order_items.sql.
[0m22:22:21.364831 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e
[0m22:22:21.365285 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45
[0m22:22:21.365850 [debug] [Thread-2 (]: Began running node test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7
[0m22:22:21.366476 [info ] [Thread-3 (]: 3 of 9 SKIP test not_null_fact_order_items_order_id ............................ [[33mSKIP[0m]
[0m22:22:21.367559 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9
[0m22:22:21.368588 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e
[0m22:22:21.366945 [info ] [Thread-4 (]: 4 of 9 SKIP test not_null_fact_order_items_order_number ........................ [[33mSKIP[0m]
[0m22:22:21.369836 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23
[0m22:22:21.370324 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e' to be skipped because of status 'skipped'. 
[0m22:22:21.368032 [info ] [Thread-2 (]: 2 of 9 SKIP test accepted_values_fact_order_items_reordered__0__1 .............. [[33mSKIP[0m]
[0m22:22:21.371260 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45
[0m22:22:21.369130 [info ] [Thread-1 (]: 5 of 9 SKIP test not_null_fact_order_items_product_id .......................... [[33mSKIP[0m]
[0m22:22:21.372001 [info ] [Thread-3 (]: 6 of 9 SKIP test not_null_fact_order_items_user_id ............................. [[33mSKIP[0m]
[0m22:22:21.373094 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7
[0m22:22:21.373673 [debug] [Thread-4 (]: Began running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:22:21.374081 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45' to be skipped because of status 'skipped'. 
[0m22:22:21.374606 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9
[0m22:22:21.375105 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23
[0m22:22:21.376986 [debug] [Thread-2 (]: Began running node test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m22:22:21.378426 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7' to be skipped because of status 'skipped'. 
[0m22:22:21.379025 [debug] [Thread-1 (]: Began running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m22:22:21.377743 [info ] [Thread-4 (]: 7 of 9 SKIP test relationships_fact_order_items_order_id__order_id__ref_dim_order_  [[33mSKIP[0m]
[0m22:22:21.379881 [info ] [Thread-2 (]: 8 of 9 SKIP test relationships_fact_order_items_product_id__product_id__ref_dim_product_  [[33mSKIP[0m]
[0m22:22:21.380512 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9' to be skipped because of status 'skipped'. 
[0m22:22:21.381056 [info ] [Thread-1 (]: 9 of 9 SKIP test relationships_fact_order_items_time_id__time_id__ref_dim_time_  [[33mSKIP[0m]
[0m22:22:21.381704 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:22:21.382215 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m22:22:21.382706 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23' to be skipped because of status 'skipped'. 
[0m22:22:21.383206 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m22:22:21.383943 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace' to be skipped because of status 'skipped'. 
[0m22:22:21.384507 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428' to be skipped because of status 'skipped'. 
[0m22:22:21.384833 [debug] [Thread-7 (]: Marking all children of 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' to be skipped because of status 'skipped'. 
[0m22:22:21.386135 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:21.386468 [debug] [MainThread]: On master: BEGIN
[0m22:22:21.386740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:22:21.436704 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m22:22:21.437111 [debug] [MainThread]: On master: COMMIT
[0m22:22:21.437410 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:21.437660 [debug] [MainThread]: On master: COMMIT
[0m22:22:21.438198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:22:21.438532 [debug] [MainThread]: On master: Close
[0m22:22:21.438914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:21.439177 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:22:21.439463 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:22:21.439685 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:22:21.439902 [debug] [MainThread]: Connection 'model.instacart_dbt.fact_order_items' was properly closed.
[0m22:22:21.440180 [info ] [MainThread]: 
[0m22:22:21.440718 [info ] [MainThread]: Finished running 1 table model, 8 data tests in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m22:22:21.442605 [debug] [MainThread]: Command end result
[0m22:22:21.496139 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:22:21.500999 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:22:21.507635 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:22:21.508173 [info ] [MainThread]: 
[0m22:22:21.510268 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:22:21.511006 [info ] [MainThread]: 
[0m22:22:21.511665 [error] [MainThread]: [31mFailure in model fact_order_items (models\marts\fact\fact_order_items.sql)[0m
[0m22:22:21.512264 [error] [MainThread]:   Database Error in model fact_order_items (models\marts\fact\fact_order_items.sql)
  column o.days_gap does not exist
  LINE 64:         o.days_gap,
                   ^
  compiled code at target\run\instacart_dbt\models\marts\fact\fact_order_items.sql
[0m22:22:21.512733 [info ] [MainThread]: 
[0m22:22:21.513301 [info ] [MainThread]:   compiled code at target\compiled\instacart_dbt\models\marts\fact\fact_order_items.sql
[0m22:22:21.513817 [info ] [MainThread]: 
[0m22:22:21.514359 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=8 NO-OP=0 TOTAL=9
[0m22:22:21.515749 [debug] [MainThread]: Command `dbt build` failed at 22:22:21.515606 after 4.00 seconds
[0m22:22:21.516127 [debug] [MainThread]: Flushing usage events
[0m22:22:42.401396 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 22:22:42.490701 | ff844298-819a-4618-b3b2-9ead9abac311 ==============================
[0m22:22:42.490701 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:22:42.493374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\instacart_dbt\\instacart_dbt\\logs', 'profiles_dir': 'C:\\Users\\ACER\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select fact_order_items', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:22:42.830846 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:22:43.104509 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m22:22:43.417015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:22:43.417869 [debug] [MainThread]: Partial parsing: updated file: instacart_dbt://models\marts\fact\fact_order_items.sql
[0m22:22:44.233104 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:22:44.237092 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:22:44.306424 [info ] [MainThread]: Found 12 models, 5 seeds, 67 data tests, 5 sources, 547 macros
[0m22:22:44.312736 [info ] [MainThread]: 
[0m22:22:44.313394 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:22:44.314070 [info ] [MainThread]: 
[0m22:22:44.315022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:22:44.316778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db'
[0m22:22:44.652923 [debug] [ThreadPool]: Using postgres connection "list_instacart_db"
[0m22:22:44.653351 [debug] [ThreadPool]: On list_instacart_db: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db"} */

    select distinct nspname from pg_namespace
  
[0m22:22:44.653653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:44.713994 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.060 seconds
[0m22:22:44.715412 [debug] [ThreadPool]: On list_instacart_db: Close
[0m22:22:44.721932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public'
[0m22:22:44.729122 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:22:44.730104 [debug] [ThreadPool]: On list_instacart_db_public: BEGIN
[0m22:22:44.730742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:44.731418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instacart_db_public_staging'
[0m22:22:44.735037 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:22:44.735720 [debug] [ThreadPool]: On list_instacart_db_public_staging: BEGIN
[0m22:22:44.736133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:44.798607 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m22:22:44.799401 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public"
[0m22:22:44.799990 [debug] [ThreadPool]: On list_instacart_db_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:22:44.805317 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m22:22:44.806011 [debug] [ThreadPool]: Using postgres connection "list_instacart_db_public_staging"
[0m22:22:44.806554 [debug] [ThreadPool]: On list_instacart_db_public_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "list_instacart_db_public_staging"} */
select
      'instacart_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'instacart_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:22:44.810916 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.010 seconds
[0m22:22:44.812544 [debug] [ThreadPool]: On list_instacart_db_public: ROLLBACK
[0m22:22:44.813095 [debug] [ThreadPool]: On list_instacart_db_public: Close
[0m22:22:44.817588 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m22:22:44.818854 [debug] [ThreadPool]: On list_instacart_db_public_staging: ROLLBACK
[0m22:22:44.819434 [debug] [ThreadPool]: On list_instacart_db_public_staging: Close
[0m22:22:44.827354 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:44.827772 [debug] [MainThread]: On master: BEGIN
[0m22:22:44.828072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:45.051719 [debug] [MainThread]: SQL status: BEGIN in 0.223 seconds
[0m22:22:45.052692 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:45.053658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:22:45.080869 [debug] [MainThread]: SQL status: SELECT 5 in 0.026 seconds
[0m22:22:45.088517 [debug] [MainThread]: On master: ROLLBACK
[0m22:22:45.089909 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:45.091487 [debug] [MainThread]: On master: BEGIN
[0m22:22:45.094653 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:22:45.096087 [debug] [MainThread]: On master: COMMIT
[0m22:22:45.097744 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:45.098848 [debug] [MainThread]: On master: COMMIT
[0m22:22:45.100579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:22:45.101658 [debug] [MainThread]: On master: Close
[0m22:22:45.120628 [debug] [Thread-1 (]: Began running node model.instacart_dbt.fact_order_items
[0m22:22:45.122435 [info ] [Thread-1 (]: 1 of 9 START sql table model public.fact_order_items ........................... [RUN]
[0m22:22:45.132660 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instacart_dbt.fact_order_items'
[0m22:22:45.134501 [debug] [Thread-1 (]: Began compiling node model.instacart_dbt.fact_order_items
[0m22:22:45.170059 [debug] [Thread-1 (]: Writing injected SQL for node "model.instacart_dbt.fact_order_items"
[0m22:22:45.176922 [debug] [Thread-1 (]: Began executing node model.instacart_dbt.fact_order_items
[0m22:22:45.344468 [debug] [Thread-1 (]: Writing runtime sql for node "model.instacart_dbt.fact_order_items"
[0m22:22:45.349959 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.fact_order_items"
[0m22:22:45.351369 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: BEGIN
[0m22:22:45.352305 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:45.451288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.099 seconds
[0m22:22:45.451878 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.fact_order_items"
[0m22:22:45.452439 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.fact_order_items"} */

  
    

  create  table "instacart_db"."public"."fact_order_items__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fact/fact_order_items.sql

-- Tujuan:
-- Fakta granular per item produk dalam order.
-- Dibentuk dari dimensi yang sudah dibersihkan: dim_order, dim_product, dim_time.

with order_products as (

    -- Masih dari stg karena belum ada dim_order_products
    select
        order_id,
        product_id,
        add_to_cart_order,
        reordered
    from "instacart_db"."public"."stg_order_products"

),

dim_order as (
    select
        order_id,
        user_id,
        order_number,
        order_day,
        order_hour,
        order_days_gap
    from "instacart_db"."public"."dim_order"
),

dim_product as (
    select
        product_id
    from "instacart_db"."public"."dim_product"
),

dim_time as (
    select
        time_id,
        day_of_week,
        hour_of_day
    from "instacart_db"."public"."dim_time"
),

joined as (

    select
        -- FK ke dim_user (via dim_order)
        o.user_id,

        -- FK ke dim_order
        o.order_id,
        o.order_number,
        o.order_days_gap,

        -- FK ke dim_product
        op.product_id,
        op.add_to_cart_order,
        op.reordered,

        -- FK ke dim_time
        t.time_id

    from order_products op
    inner join dim_order o
        on o.order_id = op.order_id

    inner join dim_product p
        on p.product_id = op.product_id

    left join dim_time t
        on o.order_day = t.day_of_week
       and o.order_hour = t.hour_of_day
)

select
    user_id,               -- FK ke dim_user
    order_id,              -- FK ke dim_order
    product_id,            -- FK ke dim_product
    time_id,               -- FK ke dim_time
    order_number,
    order_days_gap,
    add_to_cart_order,
    reordered
from joined
  );
  
[0m22:25:20.649120 [debug] [Thread-1 (]: SQL status: SELECT 33819106 in 155.196 seconds
[0m22:25:20.663923 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.fact_order_items"
[0m22:25:20.664393 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.fact_order_items"} */
alter table "instacart_db"."public"."fact_order_items__dbt_tmp" rename to "fact_order_items"
[0m22:25:20.733517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m22:25:20.793381 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: COMMIT
[0m22:25:20.795102 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.fact_order_items"
[0m22:25:20.796578 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: COMMIT
[0m22:25:20.811855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m22:25:20.839013 [debug] [Thread-1 (]: Applying DROP to: "instacart_db"."public"."fact_order_items__dbt_backup"
[0m22:25:20.849841 [debug] [Thread-1 (]: Using postgres connection "model.instacart_dbt.fact_order_items"
[0m22:25:20.851548 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "model.instacart_dbt.fact_order_items"} */
drop table if exists "instacart_db"."public"."fact_order_items__dbt_backup" cascade
[0m22:25:20.853618 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:25:20.856934 [debug] [Thread-1 (]: On model.instacart_dbt.fact_order_items: Close
[0m22:25:20.861341 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.fact_order_items ...................... [[32mSELECT 33819106[0m in 155.73s]
[0m22:25:20.862877 [debug] [Thread-1 (]: Finished running node model.instacart_dbt.fact_order_items
[0m22:25:20.864520 [debug] [Thread-3 (]: Began running node test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e
[0m22:25:20.865215 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45
[0m22:25:20.865876 [debug] [Thread-1 (]: Began running node test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9
[0m22:25:20.867037 [debug] [Thread-2 (]: Began running node test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7
[0m22:25:20.866538 [info ] [Thread-3 (]: 3 of 9 START test not_null_fact_order_items_order_id ........................... [RUN]
[0m22:25:20.872861 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e'
[0m22:25:20.870360 [info ] [Thread-4 (]: 4 of 9 START test not_null_fact_order_items_order_number ....................... [RUN]
[0m22:25:20.873948 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e
[0m22:25:20.875081 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45'
[0m22:25:20.871233 [info ] [Thread-1 (]: 5 of 9 START test not_null_fact_order_items_product_id ......................... [RUN]
[0m22:25:20.893724 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m22:25:20.871944 [info ] [Thread-2 (]: 2 of 9 START test accepted_values_fact_order_items_reordered__0__1 ............. [RUN]
[0m22:25:20.894371 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45
[0m22:25:20.894854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instacart_dbt.fact_order_items, now test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9)
[0m22:25:20.895499 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7'
[0m22:25:20.899913 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45"
[0m22:25:20.902208 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9
[0m22:25:20.903051 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7
[0m22:25:20.909585 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9"
[0m22:25:20.920327 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e
[0m22:25:20.924652 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7"
[0m22:25:20.948273 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m22:25:20.949229 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9
[0m22:25:20.949837 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45
[0m22:25:20.952307 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7
[0m22:25:20.956576 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9"
[0m22:25:20.959196 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45"
[0m22:25:20.961904 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7"
[0m22:25:20.962702 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m22:25:20.963689 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e: BEGIN
[0m22:25:20.964661 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:25:20.965742 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9"
[0m22:25:20.969422 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45"
[0m22:25:20.970305 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7"
[0m22:25:20.971160 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9: BEGIN
[0m22:25:20.973841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:20.972485 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45: BEGIN
[0m22:25:20.973244 [debug] [Thread-2 (]: On test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7: BEGIN
[0m22:25:20.974962 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:25:20.975634 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:25:21.118494 [debug] [Thread-4 (]: SQL status: BEGIN in 0.143 seconds
[0m22:25:21.119388 [debug] [Thread-2 (]: SQL status: BEGIN in 0.144 seconds
[0m22:25:21.120125 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45"
[0m22:25:21.120955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m22:25:21.121802 [debug] [Thread-3 (]: SQL status: BEGIN in 0.157 seconds
[0m22:25:21.123005 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7"
[0m22:25:21.123934 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_number
from "instacart_db"."public"."fact_order_items"
where order_number is null



  
  
      
    ) dbt_internal_test
[0m22:25:21.124631 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9"
[0m22:25:21.125479 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m22:25:21.126192 [debug] [Thread-2 (]: On test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        reordered as value_field,
        count(*) as n_records

    from "instacart_db"."public"."fact_order_items"
    group by reordered

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m22:25:21.127013 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "instacart_db"."public"."fact_order_items"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m22:25:21.127699 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "instacart_db"."public"."fact_order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m22:25:59.871270 [debug] [Thread-1 (]: SQL status: SELECT 1 in 38.743 seconds
[0m22:25:59.872232 [debug] [Thread-4 (]: SQL status: SELECT 1 in 38.745 seconds
[0m22:25:59.878558 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9: ROLLBACK
[0m22:25:59.881277 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45: ROLLBACK
[0m22:25:59.887157 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45: Close
[0m22:25:59.888319 [debug] [Thread-1 (]: On test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9: Close
[0m22:25:59.889844 [info ] [Thread-4 (]: 4 of 9 PASS not_null_fact_order_items_order_number ............................. [[32mPASS[0m in 39.01s]
[0m22:25:59.895084 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45
[0m22:25:59.895803 [debug] [Thread-4 (]: Began running node test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23
[0m22:25:59.902514 [debug] [Thread-3 (]: SQL status: SELECT 1 in 38.774 seconds
[0m22:25:59.890746 [info ] [Thread-1 (]: 5 of 9 PASS not_null_fact_order_items_product_id ............................... [[32mPASS[0m in 39.00s]
[0m22:25:59.906156 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e: ROLLBACK
[0m22:25:59.896505 [info ] [Thread-4 (]: 6 of 9 START test not_null_fact_order_items_user_id ............................ [RUN]
[0m22:25:59.907615 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9
[0m22:25:59.908530 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_fact_order_items_order_number.796bc7ed45, now test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23)
[0m22:25:59.909218 [debug] [Thread-3 (]: On test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e: Close
[0m22:25:59.909926 [debug] [Thread-1 (]: Began running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:25:59.910698 [debug] [Thread-4 (]: Began compiling node test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23
[0m22:25:59.921104 [debug] [Thread-4 (]: Writing injected SQL for node "test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23"
[0m22:25:59.911439 [info ] [Thread-1 (]: 7 of 9 START test relationships_fact_order_items_order_id__order_id__ref_dim_order_  [RUN]
[0m22:25:59.923043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_fact_order_items_product_id.54f1977fe9, now test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace)
[0m22:25:59.923805 [debug] [Thread-1 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:25:59.933835 [debug] [Thread-1 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace"
[0m22:25:59.912292 [info ] [Thread-3 (]: 3 of 9 PASS not_null_fact_order_items_order_id ................................. [[32mPASS[0m in 39.04s]
[0m22:25:59.935631 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e
[0m22:25:59.936484 [debug] [Thread-4 (]: Began executing node test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23
[0m22:25:59.937462 [debug] [Thread-3 (]: Began running node test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m22:25:59.944447 [debug] [Thread-4 (]: Writing runtime sql for node "test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23"
[0m22:25:59.945252 [debug] [Thread-1 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:25:59.950542 [debug] [Thread-1 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace"
[0m22:25:59.943880 [info ] [Thread-3 (]: 8 of 9 START test relationships_fact_order_items_product_id__product_id__ref_dim_product_  [RUN]
[0m22:25:59.952014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.not_null_fact_order_items_order_id.ce02dc1e7e, now test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428)
[0m22:25:59.952996 [debug] [Thread-3 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m22:25:59.954118 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23"
[0m22:25:59.965015 [debug] [Thread-3 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m22:25:59.966835 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23: BEGIN
[0m22:25:59.967934 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:25:59.970451 [debug] [Thread-3 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m22:25:59.975396 [debug] [Thread-3 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m22:25:59.976315 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace"
[0m22:25:59.977189 [debug] [Thread-1 (]: On test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace: BEGIN
[0m22:25:59.977829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:59.978920 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m22:25:59.979573 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428: BEGIN
[0m22:25:59.980181 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:26:00.005773 [debug] [Thread-2 (]: SQL status: SELECT 1 in 38.877 seconds
[0m22:26:00.009127 [debug] [Thread-2 (]: On test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7: ROLLBACK
[0m22:26:00.010148 [debug] [Thread-2 (]: On test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7: Close
[0m22:26:00.011283 [info ] [Thread-2 (]: 2 of 9 PASS accepted_values_fact_order_items_reordered__0__1 ................... [[32mPASS[0m in 39.12s]
[0m22:26:00.019680 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7
[0m22:26:00.020725 [debug] [Thread-2 (]: Began running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m22:26:00.021543 [info ] [Thread-2 (]: 9 of 9 START test relationships_fact_order_items_time_id__time_id__ref_dim_time_  [RUN]
[0m22:26:00.028253 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.instacart_dbt.accepted_values_fact_order_items_reordered__0__1.7a102685f7, now test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5)
[0m22:26:00.028959 [debug] [Thread-2 (]: Began compiling node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m22:26:00.040346 [debug] [Thread-2 (]: Writing injected SQL for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m22:26:00.041864 [debug] [Thread-2 (]: Began executing node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m22:26:00.045669 [debug] [Thread-2 (]: Writing runtime sql for node "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m22:26:00.047319 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m22:26:00.048038 [debug] [Thread-2 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: BEGIN
[0m22:26:00.049054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:26:00.106206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.128 seconds
[0m22:26:00.107011 [debug] [Thread-1 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace"
[0m22:26:00.108251 [debug] [Thread-1 (]: On test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "instacart_db"."public"."dim_order"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:26:00.139579 [debug] [Thread-3 (]: SQL status: BEGIN in 0.159 seconds
[0m22:26:00.140503 [debug] [Thread-3 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m22:26:00.141241 [debug] [Thread-4 (]: SQL status: BEGIN in 0.173 seconds
[0m22:26:00.141958 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "instacart_db"."public"."dim_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:26:00.142655 [debug] [Thread-4 (]: Using postgres connection "test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23"
[0m22:26:00.143503 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "instacart_db"."public"."fact_order_items"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m22:26:00.208160 [debug] [Thread-2 (]: SQL status: BEGIN in 0.159 seconds
[0m22:26:00.209001 [debug] [Thread-2 (]: Using postgres connection "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"
[0m22:26:00.209669 [debug] [Thread-2 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "instacart_dbt", "target_name": "dev", "node_id": "test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select time_id as from_field
    from "instacart_db"."public"."fact_order_items"
    where time_id is not null
),

parent as (
    select time_id as to_field
    from "instacart_db"."public"."dim_time"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:26:12.895227 [debug] [Thread-4 (]: SQL status: SELECT 1 in 12.751 seconds
[0m22:26:12.898389 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23: ROLLBACK
[0m22:26:12.900351 [debug] [Thread-4 (]: On test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23: Close
[0m22:26:12.901761 [info ] [Thread-4 (]: 6 of 9 PASS not_null_fact_order_items_user_id .................................. [[32mPASS[0m in 12.99s]
[0m22:26:12.933753 [debug] [Thread-4 (]: Finished running node test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23
[0m22:26:25.626717 [debug] [Thread-3 (]: SQL status: SELECT 1 in 25.483 seconds
[0m22:26:25.629769 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428: ROLLBACK
[0m22:26:25.630989 [debug] [Thread-3 (]: On test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428: Close
[0m22:26:25.632834 [info ] [Thread-3 (]: 8 of 9 PASS relationships_fact_order_items_product_id__product_id__ref_dim_product_  [[32mPASS[0m in 25.68s]
[0m22:26:25.648682 [debug] [Thread-3 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m22:26:26.695417 [debug] [Thread-2 (]: SQL status: SELECT 1 in 26.485 seconds
[0m22:26:26.698435 [debug] [Thread-2 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: ROLLBACK
[0m22:26:26.699701 [debug] [Thread-2 (]: On test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5: Close
[0m22:26:26.700846 [info ] [Thread-2 (]: 9 of 9 PASS relationships_fact_order_items_time_id__time_id__ref_dim_time_ ..... [[32mPASS[0m in 26.67s]
[0m22:26:26.704317 [debug] [Thread-2 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5
[0m22:26:28.720695 [debug] [Thread-1 (]: SQL status: SELECT 1 in 28.612 seconds
[0m22:26:28.723738 [debug] [Thread-1 (]: On test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace: ROLLBACK
[0m22:26:28.724897 [debug] [Thread-1 (]: On test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace: Close
[0m22:26:28.726056 [info ] [Thread-1 (]: 7 of 9 PASS relationships_fact_order_items_order_id__order_id__ref_dim_order_ .. [[32mPASS[0m in 28.80s]
[0m22:26:28.728406 [debug] [Thread-1 (]: Finished running node test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace
[0m22:26:28.733257 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:28.734051 [debug] [MainThread]: On master: BEGIN
[0m22:26:28.735611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:26:28.824078 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m22:26:28.824815 [debug] [MainThread]: On master: COMMIT
[0m22:26:28.825378 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:28.825891 [debug] [MainThread]: On master: COMMIT
[0m22:26:28.826602 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:26:28.827123 [debug] [MainThread]: On master: Close
[0m22:26:28.827910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:28.828406 [debug] [MainThread]: Connection 'list_instacart_db' was properly closed.
[0m22:26:28.828834 [debug] [MainThread]: Connection 'list_instacart_db_public' was properly closed.
[0m22:26:28.829282 [debug] [MainThread]: Connection 'list_instacart_db_public_staging' was properly closed.
[0m22:26:28.829774 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_order_id__order_id__ref_dim_order_.c4583b9ace' was properly closed.
[0m22:26:28.830269 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428' was properly closed.
[0m22:26:28.831021 [debug] [MainThread]: Connection 'test.instacart_dbt.not_null_fact_order_items_user_id.87f0a16e23' was properly closed.
[0m22:26:28.832203 [debug] [MainThread]: Connection 'test.instacart_dbt.relationships_fact_order_items_time_id__time_id__ref_dim_time_.2c3ddc7ef5' was properly closed.
[0m22:26:28.832987 [info ] [MainThread]: 
[0m22:26:28.834686 [info ] [MainThread]: Finished running 1 table model, 8 data tests in 0 hours 3 minutes and 44.52 seconds (224.52s).
[0m22:26:28.841949 [debug] [MainThread]: Command end result
[0m22:26:28.941606 [debug] [MainThread]: Wrote artifact WritableManifest to C:\instacart_dbt\instacart_dbt\target\manifest.json
[0m22:26:28.949737 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\instacart_dbt\instacart_dbt\target\semantic_manifest.json
[0m22:26:28.963038 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\instacart_dbt\instacart_dbt\target\run_results.json
[0m22:26:28.963728 [info ] [MainThread]: 
[0m22:26:28.966063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:26:28.966885 [info ] [MainThread]: 
[0m22:26:28.967704 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m22:26:28.970504 [debug] [MainThread]: Command `dbt build` succeeded at 22:26:28.970150 after 226.65 seconds
[0m22:26:28.971415 [debug] [MainThread]: Flushing usage events
